use libblas::level3::complex;
use num_complex::Complex;
mod fixtures;
mod utils;

#[test]
fn gemm() {
    let a = fixtures::complex::matrix_mxn(8, 8);
    let b = fixtures::complex::matrix_mxn(8, 8);
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.538_546_083_267_966, 5.069_015_258_659_708),
            Complex::new(-2.666_815_656_687_356, -0.953_278_753_819_595_5),
            Complex::new(1.0864434009347868, 1.0136790833257363),
            Complex::new(0.21529965576385168, 1.0362530742021119),
            Complex::new(-0.444_278_755_580_861_5, 3.889_375_728_166_084),
            Complex::new(-1.3168380465089167, 1.691_288_948_561_298E-2),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-0.220_299_817_385_556_2, -3.660_227_042_458_339),
            Complex::new(-0.47069741916643004, -0.581_587_539_955_668_5),
            Complex::new(-1.3679335994458062, -2.6081595934017354),
            Complex::new(1.1465666351200188, 1.285_874_478_814_278),
            Complex::new(1.8894501128227057, -1.9940821292770452),
            Complex::new(0.437_067_508_500_757, 0.333_207_647_221_510_4),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.736_061_993_587_185_4, 4.142_210_799_596_363),
            Complex::new(-1.883_077_492_581_9, 0.675_018_769_958_628_8),
            Complex::new(2.4847238931676285, 5.931_711_444_304_231),
            Complex::new(2.4017289164433526, -2.1996136400808823),
            Complex::new(1.0456348921765743, 1.2631338026755818),
            Complex::new(-2.777_917_231_486_911, 0.34707730027773437),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.7507023746572674, -0.924_824_424_530_454_7),
            Complex::new(-0.610_280_319_264_252_7, 0.667_090_533_523_151_4),
            Complex::new(0.558_080_619_564_033_3, 0.993_454_236_489_815_3),
            Complex::new(1.5141289683700438, 0.926_414_880_518_325_1),
            Complex::new(1.8194357932749106, -0.504_147_588_697_621_4),
            Complex::new(-1.177_643_108_670_342, -0.324_618_558_588_119_4),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(1.467_102_567_041_1, 1.0634086078069738),
            Complex::new(-0.237_227_906_249_273_7, 0.542_152_985_217_882_7),
            Complex::new(0.30637324007597794, 0.21934840409289302),
            Complex::new(-0.851_658_355_369_514_2, 2.013_377_790_780_023),
            Complex::new(-2.6918384958555888, 1.3759187103651978),
            Complex::new(0.248_311_361_121_017_6, -1.2059451520265783),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(0.715_272_923_513_788_4, -0.13092251889185963),
            Complex::new(-1.988_616_855_632_951, -9.049_643_552_008_341E-2),
            Complex::new(0.707_774_250_774_901_2, 0.788_807_674_818_374_8),
            Complex::new(3.8510307852580397, -3.2624509575940293),
            Complex::new(4.950_653_005_684_57, -0.489_525_252_089_377_9),
            Complex::new(-3.1375194965446105, 2.307_260_797_636_161),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(2.0044098154271035, -1.5061363774597527),
            Complex::new(-0.909_880_696_112_542_5, 1.1872004143335997),
            Complex::new(0.23488258223005987, -0.869_927_203_543_886_1),
            Complex::new(-5.401_802_455_925_014_4E-2, -1.5203825935717596),
            Complex::new(2.765_892_492_283_778, 0.466_030_999_463_660_5),
            Complex::new(1.8724129048158211, 0.17016973619026576),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(-3.3503023073547413, -1.3992004448402335),
            Complex::new(2.0863988846205275, 2.193_903_682_620_168_5E-2),
            Complex::new(1.7300381599470136, -0.758_986_925_020_365_4),
            Complex::new(-1.1258130130494317, -4.354_382_544_195_737),
            Complex::new(0.392_621_507_617_302_4, -2.2824825611908137),
            Complex::new(-0.381_907_459_708_632_6, 1.5606792346498484),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.079_683_548_225_464, 3.8602197766084028),
            Complex::new(-2.9451794668445928, -0.606_389_443_535_795_9),
            Complex::new(1.8111268633859385, -0.297_821_199_431_251_5),
            Complex::new(-0.26266325056641937, 7.417_883_968_557_737E-2),
            Complex::new(0.879_115_455_404_355, 3.206_081_946_240_439),
            Complex::new(-0.560_251_173_624_481_1, 1.1367237019560907),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-1.1524028321356348, -3.422_299_191_929_863),
            Complex::new(-1.8041005972235515, -2.292_192_090_058_089),
            Complex::new(-2.771_677_984_148_017, -2.9062779268922014),
            Complex::new(2.2315981487667327, 1.6937744845109919),
            Complex::new(2.7846192173864353, -1.242_365_909_617_654),
            Complex::new(0.313_096_872_908_257_1, 0.610_242_655_250_181_5),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(2.638_708_950_964_484, 3.4521591144709562),
            Complex::new(-2.340_964_564_815_563, 1.5476234868646503),
            Complex::new(2.353_685_249_285_374, 5.594_140_286_229_328),
            Complex::new(2.8493496725869933, -1.2596111250628588),
            Complex::new(1.5850830988910882, 1.318_899_456_163_11),
            Complex::new(-2.991_495_166_788_839, 7.968_546_859_076_342E-2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(2.049_106_842_484_415, -0.950_884_782_608_641_7),
            Complex::new(-0.719_838_301_195_789_8, 0.266_413_232_523_431_2),
            Complex::new(-0.411_592_599_307_220_6, 0.312_968_524_788_814_1),
            Complex::new(1.5596594789972318, 1.5023430347473723),
            Complex::new(1.4243806840861288, 0.686_525_613_439_627_9),
            Complex::new(-0.993_177_555_290_306_3, -0.410_452_192_813_154_6),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(1.752_494_760_319_654, 1.3603743454026176),
            Complex::new(-5.510_303_251_985_293_5E-2, 1.0486726695105522),
            Complex::new(0.176_348_204_485_671_5, -0.36588346796251636),
            Complex::new(-0.876_170_002_959_192_5, 1.040_380_712_882_876),
            Complex::new(-1.8799071716726714, 0.329_599_543_849_144_9),
            Complex::new(7.322_729_212_107_051E-2, -0.797_087_997_048_404_9),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(0.695_405_455_337_491, -1.620_173_308_314_413),
            Complex::new(-3.3327261009348716, -0.231_103_293_961_419_2),
            Complex::new(5.547_739_394_989_443E-2, 1.3367482709807623),
            Complex::new(3.781_663_089_369_644, -2.537_872_226_465_773),
            Complex::new(5.179_353_379_806_54, 0.444_884_631_762_327_2),
            Complex::new(-1.0006786920744175, 2.678_802_637_050_129),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(0.919_874_748_874_120_7, -1.9422426604703886),
            Complex::new(-1.095_984_227_623_723, 1.4269556848110623),
            Complex::new(-5.771_698_096_027_455_5E-2, -1.0229940734147107),
            Complex::new(-0.307_886_143_290_452_6, -1.1367182421134434),
            Complex::new(2.4793983521580545, -1.5375053441635589),
            Complex::new(1.3179438356557611, 0.984_825_254_940_449_3),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(-3.653_365_275_356_449, -1.8489414961824382),
            Complex::new(2.4228401174275858, 8.455_870_600_462_301E-2),
            Complex::new(2.2814873239717413, 0.993_466_082_565_234_4),
            Complex::new(-0.22973851391807287, -3.5043288992695807),
            Complex::new(0.27519030929704497, -2.558_044_318_957_444),
            Complex::new(2.318_803_267_066_754_7E-2, 1.4687940182366304),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(1.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(5.342_637_783_302_369, 4.852_380_156_495_03),
            Complex::new(-3.2714128240356786, -1.0359025403451831),
            Complex::new(3.1409261578576793, 0.940_482_938_752_341_9),
            Complex::new(1.009_766_096_471_85, -0.20516744756494143),
            Complex::new(1.2937568953190581, 4.963_985_045_300_498),
            Complex::new(-2.100_201_186_785_186, 1.697_469_775_678_93),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-1.158_170_004_803_764, -4.588_869_736_172_722),
            Complex::new(0.600_552_713_552_205_2, -3.3577827100989825),
            Complex::new(-2.0080845488605417, -4.470_060_022_801_32),
            Complex::new(1.4325888852512605, 2.850_311_540_480_23),
            Complex::new(1.636_962_180_605_124, -0.410_318_804_782_143_8),
            Complex::new(2.363_529_000_916_353_4E-2, 0.38291396734391636),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(2.8909324128308627, 5.893_523_641_219_613),
            Complex::new(-3.2328856678162037, 0.752_284_379_351_222_6),
            Complex::new(2.789_368_559_317_264, 5.539_262_811_325_267),
            Complex::new(1.6118112156701838, -1.0094698024500963),
            Complex::new(1.3608152138021676, 1.9371427332360165),
            Complex::new(-2.6140995071037043, -9.293_803_163_716_477E-2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.9920000681840786, -0.592_155_896_958_007),
            Complex::new(-0.21623031283824595, 0.255_367_754_239_072_2),
            Complex::new(0.674_176_815_594_512_9, -0.627_680_627_013_249),
            Complex::new(0.868_705_628_251_077, 1.3865177094967467),
            Complex::new(0.13978137988690997, -0.128_443_091_737_679_1),
            Complex::new(-0.946_451_384_363_020_1, -0.16818871179222716),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(1.3191844304055609, 1.608_786_999_206_443),
            Complex::new(-0.704_574_673_106_706, 1.1139608481332748),
            Complex::new(0.903_098_935_953_872_1, -0.34672707716144424),
            Complex::new(0.275_741_732_575_475_4, 1.297_719_087_736_01),
            Complex::new(-0.887_746_791_786_044, 1.5925537789260493),
            Complex::new(-0.356_285_804_688_316_7, -1.1233213542394909),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(2.4533085543975495, -1.2055318683997096),
            Complex::new(-2.7719800272120323, -1.7710533071221248),
            Complex::new(-0.397_306_578_075_023_2, 0.408_181_219_093_250_1),
            Complex::new(2.9496197992313995, -2.8325926675687545),
            Complex::new(4.012_782_835_563_681, 0.43911745909419797),
            Complex::new(-2.066_269_312_115_311, 5.083_455_947_825_886),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(1.751_921_853_709_631, -3.0898996972516994),
            Complex::new(-1.3233129155299883, 1.1374941019119689),
            Complex::new(0.208_420_380_566_214_7, -1.322_209_181_570_915),
            Complex::new(-0.684_588_869_177_751, -1.548_229_067_270_609),
            Complex::new(4.920_762_878_906_713, -1.285_281_882_297_18),
            Complex::new(0.522_604_728_142_333_3, 9.290_415_193_980_829E-2),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(-3.035_121_998_283_543, -2.073_209_381_271_359),
            Complex::new(2.2502166171996576, 0.461_954_365_689_757_9),
            Complex::new(5.758_700_582_598_952E-2, 1.1268024477881653),
            Complex::new(-1.4933529300405093, -2.700_139_396_076_679),
            Complex::new(0.633_919_194_947_679_8, -2.615_151_093_257_781),
            Complex::new(1.214_255_438_630_856_8E-2, 1.9724020065941743),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.487_716_876_961_802, -5.8585309145742155),
            Complex::new(2.8084667388982907, 2.235_781_897_288_646),
            Complex::new(0.37838517208496114, -1.7822597868027001),
            Complex::new(1.1118663889628084, 1.000_298_952_838_299),
            Complex::new(0.611_046_836_886_535_4, -0.590_218_134_637_558_3),
            Complex::new(-0.532_744_100_797_272, 0.10603004292091461),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-2.683_005_739_493_246, -0.288_918_942_309_811_5),
            Complex::new(4.000_577_637_040_638, -4.512_802_167_579_162),
            Complex::new(0.23644402740805845, -2.4799619370296195),
            Complex::new(-1.0464596223417642, 2.0037924783009484),
            Complex::new(-3.075_412_692_661_179, 2.843_086_862_468_182),
            Complex::new(-0.773_218_251_948_045_7, -0.354_362_192_412_575_9),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(-0.423_074_810_283_293_4, -2.2423497270354478),
            Complex::new(3.2746351447542272, -1.9432355634370264),
            Complex::new(2.7070788101852035, -5.673_188_888_756_528),
            Complex::new(-3.261_311_708_310_836, -0.267_749_161_223_067_1),
            Complex::new(-1.4220913042558818, -0.260_793_973_597_197_9),
            Complex::new(1.4421082575779354, 1.8066193662368404),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.763_259_234_090_008, -0.406_611_342_714_849_6),
            Complex::new(-1.6634413952920886, 2.035_982_054_412_457),
            Complex::new(2.4233454820463702, 3.1816091187466107),
            Complex::new(1.6818723779762133, -4.606_534_665_500_913),
            Complex::new(3.2983677492657724, -2.7055402382999523),
            Complex::new(-0.470_070_914_693_084_7, 2.215_753_016_719_017),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.697_291_089_579_424_4, -2.5760519730298737),
            Complex::new(-1.2816420392538765, 3.551_451_890_944_276),
            Complex::new(0.887_213_176_271_630_8, 1.0829884082214079),
            Complex::new(-0.880_800_121_046_393_4, -2.174_137_654_657_566),
            Complex::new(1.593_606_796_848_748, -4.566_602_797_266_19),
            Complex::new(2.2690316989507497, 0.454_211_358_646_047),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-1.0221847462904883, 2.1725651912078767),
            Complex::new(2.018_855_725_024_578, 0.736_966_298_270_090_1),
            Complex::new(-1.3095784837267528, -0.376_029_851_870_540_1),
            Complex::new(-1.276_018_573_205_935, 0.951_148_807_962_374),
            Complex::new(-2.297_782_797_815_178, -1.8554972087834618),
            Complex::new(-1.2205058194738454, -2.509_656_683_032_514),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(-0.757_567_284_860_393_6, 6.129_541_304_086_245),
            Complex::new(-0.509_059_161_554_919_4, -1.400_366_436_704_517),
            Complex::new(1.6532888553021676, 1.7101409523083424),
            Complex::new(-2.0984434231893774, -0.644_797_291_174_847_4),
            Complex::new(-2.290_643_361_689_036, 1.3603583920196214),
            Complex::new(0.765_506_736_136_711_8, -1.7848780816230245),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.6014800415637274, 3.8861101634604127),
            Complex::new(-0.895_557_048_374_636_6, -0.19922831713420708),
            Complex::new(0.554_828_238_648_915_7, 9.820_929_784_779_675E-2),
            Complex::new(-1.7424088901198016, -0.19526234491543665),
            Complex::new(-0.35414076940222317, 1.7210137430267756),
            Complex::new(-1.0628438175206427, -0.833_770_403_269_641_9),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.0288543419192995, -7.067_326_396_625_52),
            Complex::new(2.530_102_928_741_054, 2.5826712075724454),
            Complex::new(1.1030686345361131, -3.093_760_069_559_688),
            Complex::new(0.633_903_482_632_537_4, 3.822_471_832_176_449_5E-2),
            Complex::new(1.9344410478717518, -1.2735119165632034),
            Complex::new(0.22384277208716347, 1.2258408553913924),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-3.615_108_754_243_324, -5.099_109_178_133_543E-2),
            Complex::new(2.6671744589835162, -6.223_406_717_681_582),
            Complex::new(-1.1673003572941527, -2.7780802705200855),
            Complex::new(3.857_189_130_495_02E-2, 2.411_692_483_997_662),
            Complex::new(-2.180_243_588_097_45, 3.5948030821275734),
            Complex::new(-0.897_188_887_540_545_6, -7.732_718_438_390_465E-2),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(1.4795721470940053, -2.9324014121608535),
            Complex::new(2.8167480725205642, -1.0706308465310048),
            Complex::new(2.576_040_166_302_949, -6.010_760_046_831_431),
            Complex::new(-2.813_690_952_167_195, 0.672_253_353_794_956_7),
            Complex::new(-0.882_643_097_541_367_9, -0.20502832010966976),
            Complex::new(1.2285303222760067, 1.5392275345498692),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.46485476626285965, -0.432_671_700_793_036_7),
            Complex::new(-1.7729993772236257, 1.6353047534127365),
            Complex::new(1.4536722631751164, 2.5011234070456094),
            Complex::new(1.7274028886034012, -4.030_606_511_271_866),
            Complex::new(2.9033126400769906, -1.5148670361627032),
            Complex::new(-0.285_605_361_313_049_1, 2.129_919_382_493_982),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.411_898_896_300_870_5, -2.2790862354342303),
            Complex::new(-1.0995171655244558, 4.057_971_575_236_945),
            Complex::new(0.757_188_140_681_324_3, 0.497_756_536_165_998_7),
            Complex::new(-0.905_311_768_636_071_7, -3.147_134_732_554_713),
            Complex::new(2.405_538_121_031_665, -5.6129219637822425),
            Complex::new(2.0939476299508026, 0.863_068_513_624_220_2),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-1.0420522144667856, 0.683_314_401_785_323_5),
            Complex::new(0.674_746_479_722_657_6, 0.596_359_439_828_754_3),
            Complex::new(-1.9618753405517595, 0.171_910_744_291_847_4),
            Complex::new(-1.3453862690943306, 1.6757275390906303),
            Complex::new(-2.069_082_423_693_209, -0.921_087_324_931_757_2),
            Complex::new(0.916_334_984_996_347_4, -2.138_114_843_618_546),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(-1.842_102_351_413_376, 5.693_435_021_075_609),
            Complex::new(-0.695_162_693_066_099_9, -1.1606111662270542),
            Complex::new(1.3606892921118332, 1.5570740824375178),
            Complex::new(-2.352_311_541_920_58, -0.261_132_939_716_531_2),
            Complex::new(-2.5771375018147595, -0.643_177_951_607_597_7),
            Complex::new(0.21103766697665177, -0.970_222_562_872_841_4),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.2984170735620195, 3.436_369_112_118_208),
            Complex::new(-0.559_115_815_567_578_1, -0.13660864795578576),
            Complex::new(1.1062774026736437, 1.8506623054333966),
            Complex::new(-0.846_334_390_988_442_7, 0.654_791_300_010_718_4),
            Complex::new(-0.471_571_967_722_480_8, 1.445_451_985_260_145),
            Complex::new(-0.657_748_325_141_343, -0.925_655_619_682_859_9),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(1.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.291_808_576_996_204, -6.075_166_016_738_893),
            Complex::new(2.2038695715499683, 2.153_158_110_763_058),
            Complex::new(2.432_867_929_007_854, -1.8554559313760945),
            Complex::new(1.9063328296708064, -0.241_121_568_928_754_3),
            Complex::new(2.349_082_487_786_455, 0.48439118249685514),
            Complex::new(-1.316_107_241_073_542, 1.7865869291142316),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-3.620_875_926_911_453, -1.2175616360241943),
            Complex::new(5.071_827_769_759_274, -7.288_997_337_722_476),
            Complex::new(-0.403_706_922_006_677, -4.341_862_366_429_204),
            Complex::new(-0.760_437_372_210_522_2, 3.568_229_539_966_9),
            Complex::new(-3.327_900_624_878_761, 4.426_850_186_963_084),
            Complex::new(-1.1866504704396392, -0.30465587229016994),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(1.731_795_608_960_384, -0.49103688541219626),
            Complex::new(1.9248269695199232, -1.8659699540444326),
            Complex::new(3.011_723_476_334_84, -6.065_637_521_735_491),
            Complex::new(-4.051_229_409_084_004, 0.922_394_676_407_719_2),
            Complex::new(-1.1069109826302885, 0.41321495696323673),
            Complex::new(1.6059259819611416, 1.366_604_034_321_941),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.521_961_540_563_196_5, -7.394_281_514_240_203E-2),
            Complex::new(-1.2693913888660817, 1.6242592751283775),
            Complex::new(2.539_441_678_076_85, 1.5604742552435467),
            Complex::new(1.0364490378572464, -4.146_431_836_522_492),
            Complex::new(1.6187133358777719, -2.3298357413400104),
            Complex::new(-0.23887919038576294, 2.3721828635149094),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.845_209_226_214_963_5, -2.030_673_581_630_405),
            Complex::new(-1.748_988_806_111_309, 4.123_259_753_859_668),
            Complex::new(1.483_938_872_149_525, 0.516_912_926_967_070_8),
            Complex::new(0.246_599_966_898_596_3, -2.889_796_357_701_579),
            Complex::new(3.3976985009182927, -4.349_967_728_705_338),
            Complex::new(1.6644345331414154, 0.536_835_156_433_134_4),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(0.715_850_884_593_273_1, 1.097_955_841_700_027),
            Complex::new(1.235_492_553_445_497, -0.943_590_573_331_951_3),
            Complex::new(-2.414_659_312_576_677, -0.756_656_307_595_664_7),
            Complex::new(-2.177_429_559_232_575, 1.3810070979876488),
            Complex::new(-3.2356529679360677, -0.926_854_497_599_886_4),
            Complex::new(-0.14925563504454614, 0.266_538_467_157_211_1),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(-1.0100552465778656, 4.545_777_984_294_297),
            Complex::new(-0.922_491_380_972_365_2, -1.4500727491261478),
            Complex::new(1.6268266536383225, 1.2578589742813135),
            Complex::new(-2.729_014_267_807_879, -0.672_643_764_873_696_7),
            Complex::new(-0.135_772_975_066_102_3, -0.39095448974121894),
            Complex::new(-0.584_301_440_536_775_9, -1.862_143_665_873_482),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.916_660_350_634_926, 3.2121012270292875),
            Complex::new(-0.731_739_315_795_506_2, 0.240_787_011_729_349_2),
            Complex::new(-1.1176229154721082, 1.9839986706563275),
            Complex::new(-2.109_948_807_110_879, 1.4589808032036202),
            Complex::new(-0.11284308207184601, 1.3883452109598082),
            Complex::new(-0.668_793_803_425_701_9, -0.422_047_631_325_316),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-1.287_677_740_023_705, -4.304_684_847_524_304),
            Complex::new(-1.137_697_087_560_777, 1.614_918_188_085_095),
            Complex::new(1.2228680122060407, -1.0107360295733425),
            Complex::new(-1.1166962295386758, 1.7128466818299062),
            Complex::new(-2.9065888199001435, 0.10139279158079151),
            Complex::new(0.27939544316471343, -2.320_852_107_469_894),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-0.810_096_456_245_258_1, 1.2459405287462044),
            Complex::new(5.671_549_428_120_103, -2.701_058_412_911_257),
            Complex::new(-1.7462852905775264, 1.7644886022274335),
            Complex::new(0.47464225474195265, -0.170_613_693_468_203),
            Complex::new(-1.4693045794839787, 0.39657174058554423),
            Complex::new(-0.509_403_947_161_401_8, -3.004_682_330_124_235),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(3.965_258_303_870_8E-2, -3.023_387_973_007_292),
            Complex::new(1.4989677264990013, -0.851_779_886_404_868_7),
            Complex::new(0.919_295_285_854_621, -1.4251037063186247),
            Complex::new(-0.11093459271046086, -1.3371847451355219),
            Complex::new(0.516_449_364_538_803_7, 1.761_325_341_495_739_7E-2),
            Complex::new(-0.731_493_347_137_733, -4.210_023_536_162_911),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.736_431_021_602_695E-2, 1.0316626095087102),
            Complex::new(-2.8105551147691394, 2.2590085580048225),
            Complex::new(4.021_855_298_484_857, 2.2330157746901174),
            Complex::new(-1.681_676_413_530_464E-2, 0.825_212_405_281_639_6),
            Complex::new(0.321_959_790_797_178_3, 0.22520148482711333),
            Complex::new(2.1434124116920414, 0.39658296834189855),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.405_692_246_448_507_6, -1.4631689034116837),
            Complex::new(-4.664_974_047_912_642, 3.1681241437947727),
            Complex::new(2.379_542_455_341_336, -3.432_367_829_659_081),
            Complex::new(-0.644_766_989_695_458_4, 0.539_745_009_999_776),
            Complex::new(-7.760_686_095_229_73E-3, 2.040_481_536_828_471),
            Complex::new(-0.714_273_473_867_053, -1.0961166378954434),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-1.522_345_080_793_047, 1.587_757_206_777_448),
            Complex::new(2.965_510_872_903_464, 1.0824984849067836),
            Complex::new(-1.3241231658588697, -2.7175660039789205),
            Complex::new(-1.915_825_831_392_018E-2, -1.307_411_956_313_818),
            Complex::new(-0.12696794740557352, -2.0233528430039645),
            Complex::new(-3.763_425_399_582_104, 0.926_283_952_906_522_5),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(3.2566925693405766, 4.778_297_573_786_765),
            Complex::new(1.2676534847649594, -1.1434764845869951),
            Complex::new(-1.8349915084811075, 0.20988840999540426),
            Complex::new(1.533_853_831_082_843, -1.7421235878552461),
            Complex::new(2.3100963123069853, 2.939_033_521_493_684),
            Complex::new(-0.445_797_944_104_303_4, -1.428_192_258_723_897),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.8681918657483916, 2.935_107_825_720_629),
            Complex::new(1.5515774332607888, -2.4279708360605605),
            Complex::new(-0.414_644_666_830_870_3, -1.4817772045559905),
            Complex::new(0.35745451574262255, -1.895_216_856_505_05),
            Complex::new(-5.768_668_949_675_742_6E-2, 4.081_565_724_037_739E-2),
            Complex::new(0.718_393_379_064_206_9, 4.363_871_729_085_75E-2),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.746_540_275_066_207_6, -5.513_480_329_575_609),
            Complex::new(-1.4160608977180136, 1.9618074983688945),
            Complex::new(1.9475514746571925, -2.3222363123303307),
            Complex::new(-1.5946591358689468, 0.750_772_447_313_371_6),
            Complex::new(-1.5831946089149274, -0.581_900_990_344_853_5),
            Complex::new(1.0359823160491488, -1.201_041_294_999_416),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-1.7421994709953363, 1.4838683792746807),
            Complex::new(4.338_146_250_062_981, -4.411_662_963_013_677),
            Complex::new(-3.1500296752797374, 1.4663702687369675),
            Complex::new(1.559_673_768_388_667, 0.23728631222851093),
            Complex::new(-0.574_135_474_920_249_4, 1.1482879602449354),
            Complex::new(-0.633_374_582_753_901_7, -2.7276473220955637),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(1.9422995404160066, -3.713_439_658_132_698),
            Complex::new(1.0410806542653384, 2.082_483_050_115_291_3E-2),
            Complex::new(0.788_256_641_972_366_6, -1.7626748643935275),
            Complex::new(0.33668616343317986, -0.397_182_230_117_498_4),
            Complex::new(1.0558975712533176, 7.337_890_690_248_555E-2),
            Complex::new(-0.945_071_282_439_661_7, -4.477_415_367_849_882),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.24104015761112124, 1.0056022514305232),
            Complex::new(-2.9201130967006765, 1.858_331_257_005_102),
            Complex::new(3.052_182_079_613_603, 1.552_530_062_989_116),
            Complex::new(2.871_374_649_188_329_6E-2, 1.4011405595106867),
            Complex::new(-7.309_531_839_160_344E-2, 1.4158746869643628),
            Complex::new(2.327_877_965_072_077, 0.31074933411686334),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.12030005316995368, -1.166_203_165_816_04),
            Complex::new(-4.482_849_174_183_221, 3.674_643_828_087_442),
            Complex::new(2.2495174197510295, -4.017_599_701_714_491),
            Complex::new(-0.669_278_637_285_136_7, -0.43325206789737125),
            Complex::new(0.804_170_638_087_687_6, 0.994_162_370_312_418_5),
            Complex::new(-0.889_357_542_867_000_1, -0.687_259_482_917_270_2),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-1.5422125489693443, 9.850_641_735_489_452E-2),
            Complex::new(1.6214016276015433, 0.941_891_626_465_447_8),
            Complex::new(-1.9764200226838764, -2.169_625_407_816_533),
            Complex::new(-8.852_595_420_231_571E-2, -0.582_833_225_185_561_7),
            Complex::new(0.10173242671639599, -1.0889429591522592),
            Complex::new(-1.626_584_595_111_911, 1.2978257923204908),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(2.172_157_502_787_594, 4.342_191_290_776_129),
            Complex::new(1.081_549_953_253_779, -0.903_721_214_109_532_3),
            Complex::new(-2.127_591_071_671_442, 5.682_154_012_457_963E-2),
            Complex::new(1.2799857123516405, -1.358_459_236_396_93),
            Complex::new(2.0236021721812616, 0.935_497_177_866_464_9),
            Complex::new(-1.0002670132643634, -0.613_536_739_973_713_7),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.5651288977466837, 2.4853667743784245),
            Complex::new(1.8880186660678473, -2.365_351_166_882_139),
            Complex::new(0.13680449719385757, 0.270_675_803_029_609_3),
            Complex::new(1.2535290148739815, -1.045_163_211_578_895),
            Complex::new(-0.17511788781701504, -0.23474610052625317),
            Complex::new(1.123_488_871_443_507, -4.824_649_912_236_051E-2),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8)
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.9096422916281544, 1.203_408_596_328_597),
            Complex::new(-0.19413875177534923, -2.3442696055949512),
            Complex::new(1.9464392664377108, 4.951_750_750_884_996),
            Complex::new(1.0340547442007457, 0.28893588716060326),
            Complex::new(5.351_700_313_150_021E-3, -0.34351063948865046),
            Complex::new(-0.23138141782270227, -1.202_196_355_531_51),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(0.459_600_452_817_492_5, -2.2353081458396282),
            Complex::new(-4.992_597_089_542_461, -1.600_854_263_631_994),
            Complex::new(-0.893_377_508_353_471_8, -1.3497813549939321),
            Complex::new(-3.121_351_958_038_174, -2.657_856_483_041_046),
            Complex::new(-0.494_553_515_944_070_6, 0.938_751_596_045_248_6),
            Complex::new(-5.016_405_688_913_975, -1.9736803992804741),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.768_475_771_511_564, 4.330_302_153_253_413),
            Complex::new(-1.839_234_820_822_02, -2.5205044053904198),
            Complex::new(0.296_007_400_321_834_5, 3.787_141_568_786_611),
            Complex::new(-1.1173948354420622, -1.1916939916014457),
            Complex::new(-1.335_609_999_232_739, 0.644_349_808_504_321_6),
            Complex::new(3.3524594402636114, 2.804_651_727_999_903),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.257_687_370_043_326_5, -0.647_077_989_277_744_2),
            Complex::new(-1.9267624624599224, -1.849_279_176_344_612),
            Complex::new(0.299_899_139_572_832_3, 0.428_794_235_117_579),
            Complex::new(-1.1339707022899357, -1.7766410268450072),
            Complex::new(-0.482_399_933_154_472_8, -1.2769456221699438),
            Complex::new(-0.746_838_757_982_826_8, 0.514_345_907_648_023_5),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(1.0433537180198125, -1.323_770_159_009_939),
            Complex::new(0.21849071489023797, 1.1839481314119706),
            Complex::new(-0.666_136_756_927_918_8, 1.285_347_334_047_259),
            Complex::new(-0.852_943_394_753_576_3, 0.886_724_657_864_453),
            Complex::new(0.112_126_433_622_049_1, -0.489_948_535_259_863_8),
            Complex::new(-0.481_924_250_850_898_3, 1.2337083353554068),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(0.545_072_923_238_030_5, 1.406_865_246_361_521),
            Complex::new(-3.7962670792045543, -1.5560385328104671),
            Complex::new(3.7911783617866894, 1.9893193001505445),
            Complex::new(-0.49300550871439563, -0.296_066_457_705_268_1),
            Complex::new(-0.885_708_693_972_814_9, 0.708_155_606_481_874_9),
            Complex::new(-1.1505367129102981, -0.619_567_268_133_755_5),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(1.1223822468957279, -1.4280988498675686),
            Complex::new(-1.8383994720677506, 0.28997438910901774),
            Complex::new(3.1041057220284323, -1.6686916883528002),
            Complex::new(0.37530693191459574, -0.718_254_279_015_726_2),
            Complex::new(0.340_831_070_364_152_5, 2.0581299127777353),
            Complex::new(0.10214324732675245, -1.9689087625848427),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(-1.3254949515917425, 2.4727583262302915),
            Complex::new(0.45003350944482257, 1.6732536514201826),
            Complex::new(1.748_852_464_125_816_3E-3, -2.806_771_694_941_393),
            Complex::new(0.273_503_481_035_873_2, 0.778_545_077_846_274_6),
            Complex::new(-0.449_468_729_043_338_7, 2.8547206982261146),
            Complex::new(2.2531686840963063, -2.152_186_059_031_902),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.450_779_756_585_652, -5.386_885_722_707_957E-3),
            Complex::new(-0.472_502_561_932_585_8, -1.9973802953111517),
            Complex::new(2.6711227288888626, 3.6402504681280075),
            Complex::new(0.556_091_837_870_474_7, -0.673_138_347_355_931_3),
            Complex::new(1.3287459112983664, -1.0268044214142955),
            Complex::new(0.525_205_455_061_733_1, -8.238_554_306_103_224E-2),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-0.472_502_561_932_585_8, -1.9973802953111517),
            Complex::new(-6.326_000_267_599_583, -3.3114588137344145),
            Complex::new(-2.297_121_893_055_683, -1.6478996884843982),
            Complex::new(-2.0363204443914595, -2.249_956_477_344_332),
            Complex::new(0.40061558861965874, 1.6904678157046398),
            Complex::new(-5.140_376_324_506_475, -1.696_645_391_251_803),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(2.6711227288888626, 3.6402504681280075),
            Complex::new(-2.297_121_893_055_683, -1.6478996884843982),
            Complex::new(0.164_968_756_439_580_1, 3.4495704107117082),
            Complex::new(-0.669_774_079_298_421_5, -0.251_691_476_583_422_2),
            Complex::new(-0.796_161_792_518_225_3, 0.700_115_461_991_849_7),
            Complex::new(3.1388815049616827, 2.537_259_896_312_932),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.556_091_837_870_474_7, -0.673_138_347_355_931_3),
            Complex::new(-2.0363204443914595, -2.249_956_477_344_332),
            Complex::new(-0.669_774_079_298_421_5, -0.251_691_476_583_422_2),
            Complex::new(-1.0884401916627477, -1.2007128726159602),
            Complex::new(-0.877_455_042_343_254_6, -8.627_242_003_269_428E-2),
            Complex::new(-0.562_373_204_602_791_2, 0.428_512_273_422_988_2),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(1.3287459112983664, -1.0268044214142955),
            Complex::new(0.40061558861965874, 1.6904678157046398),
            Complex::new(-0.796_161_792_518_225_3, 0.700_115_461_991_849_7),
            Complex::new(-0.877_455_042_343_254_6, -8.627_242_003_269_428E-2),
            Complex::new(0.924_057_757_804_966_5, -1.5362677017759168),
            Complex::new(-0.657_008_319_850_845_4, 1.642_565_490_333_58),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(0.525_205_455_061_733_1, -8.238_554_306_103_224E-2),
            Complex::new(-5.140_376_324_506_475, -1.696_645_391_251_803),
            Complex::new(3.1388815049616827, 2.537_259_896_312_932),
            Complex::new(-0.562_373_204_602_791_2, 0.428_512_273_422_988_2),
            Complex::new(-0.657_008_319_850_845_4, 1.642_565_490_333_58),
            Complex::new(0.986_304_091_559_894_7, -0.24802542871978728),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(3.784_718_034_274_526E-2, -1.8642051328782046),
            Complex::new(-2.024_503_003_578_931, 0.529_729_659_586_480_6),
            Complex::new(2.811_506_158_838_098, -1.8217585582236249),
            Complex::new(0.12143881318339332, -0.33458992755740996),
            Complex::new(5.433_693_023_842_876E-2, 5.459_356_915_051_595_5E-2),
            Complex::new(-0.45232582183330755, -1.1542532438346593),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(-1.6285579195934503, 2.023_017_274_888_087),
            Complex::new(0.786_474_742_251_881_1, 1.7358733205986039),
            Complex::new(0.553_198_016_488_853_7, -1.0543186873557933),
            Complex::new(1.1695779801672321, 1.6285987227724297),
            Complex::new(-0.566_899_927_363_596_3, 2.579_158_940_459_484),
            Complex::new(2.6582641764756065, -2.244_071_275_445_12),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(1.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.8283689424185956, 6.845_775_252_682_875),
            Complex::new(-4.2948968001052625, -2.5025015589473885),
            Complex::new(3.5184471989349513, 2.8876146576038475),
            Complex::new(1.0362240384267165, -2.365_960_299_611_379),
            Complex::new(2.1934113240921658, 3.7161922264642158),
            Complex::new(-1.9612249336831489, 2.317_161_343_507_339),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-3.9744306155823055, -3.239_559_006_380_86),
            Complex::new(1.4944247452173542, -5.586_348_211_484_794),
            Complex::new(-3.557_513_040_410_686, -3.7239465223880606),
            Complex::new(1.841_111_512_718_554, 2.5121894432588125),
            Complex::new(-0.320_920_055_999_406, 2.195_162_809_837_145),
            Complex::new(-0.331_372_744_027_181_8, 0.287_279_479_611_364_1),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(2.4408713663295885, 4.0906750461689105),
            Complex::new(-5.213_027_578_698_802, -2.955_503_533_992_369),
            Complex::new(-0.737_952_066_696_162_2, 0.392_082_841_267_609_7),
            Complex::new(2.144_513_460_962_476, 0.165_219_008_471_212_4),
            Complex::new(2.8684018438942593, 4.782_186_776_918_232),
            Complex::new(-1.0194560751178705, 1.6192798133345434),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.293_312_082_911_889_8, -1.7278851267102249),
            Complex::new(3.1437287645915704, 1.3446069090052153),
            Complex::new(4.467_821_332_781_019, -1.0255714659436133),
            Complex::new(-1.9711965620384884, -2.963_631_084_136_018),
            Complex::new(-0.704_074_094_655_575_6, -2.131_722_837_131_521),
            Complex::new(0.313_753_984_626_277_6, 1.795_705_084_686_177),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(1.3454595542633692, 2.2067017812079825),
            Complex::new(0.177_265_340_195_051_9, 1.4284038836243576),
            Complex::new(3.819_420_460_451_381, 4.183_099_890_646_398),
            Complex::new(1.732_436_945_078_311, -1.0594157571010796),
            Complex::new(1.4554949388239926, 2.8198769011035982),
            Complex::new(-2.4847838333500434, -0.42537683269406157),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(1.3366281785376153, 2.1710567096992035),
            Complex::new(0.518_834_912_594_751, -1.025_341_845_643_076),
            Complex::new(-1.849_635_706_827_923, 0.863_336_261_674_959_4),
            Complex::new(-0.565_015_476_439_253_1, 1.258_721_162_562_268),
            Complex::new(-3.221_841_280_783_515, -0.10491064817110482),
            Complex::new(-1.6141820441138848, 0.392_058_188_052_499),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(1.5360272204005236, -5.466_360_992_108_028),
            Complex::new(0.935_228_754_149_359_8, 2.155_578_199_982_893),
            Complex::new(-2.7457798461243357, 0.188_749_901_639_536_2),
            Complex::new(1.3724336513755033, 1.156_466_959_119_013),
            Complex::new(2.907_787_822_928_035, -0.392_420_227_317_389_8),
            Complex::new(-0.818_764_033_555_453_2, -2.419_583_686_956_538),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.9769249549719594, -2.2964971037134028),
            Complex::new(-0.839_875_495_407_222_7, 3.1105907114368527),
            Complex::new(-2.854_179_763_986_259, 5.304_696_326_759_267E-2),
            Complex::new(-0.998_448_943_119_102_8, 1.0045043819556907),
            Complex::new(1.4613563705577874, -2.6690315541861764),
            Complex::new(0.678_481_213_706_665_4, 3.248_554_119_927_652E-2),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.565_414_707_341_691_3, 5.853_614_872_796_247),
            Complex::new(-3.9686634429141763, -2.0729884621380013),
            Complex::new(2.1886479044632106, 1.649_310_519_420_254),
            Complex::new(-0.23620530861155303, -2.0866140123608603),
            Complex::new(1.7787698841774622, 1.9582891274041572),
            Complex::new(-0.42127492052244336, 1.7564152697844995),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-3.9686634429141763, -2.0729884621380013),
            Complex::new(-0.910_228_565_558_402_6, -4.520_757_591_443_9),
            Complex::new(-4.321_106_475_698_162, -2.160_164_426_478_942),
            Complex::new(2.6401207762340264, 1.3556523872895743),
            Complex::new(0.826_736_980_781_904_8, 1.363_115_705_001_635),
            Complex::new(-4.191_116_112_808_818E-2, 0.514_608_167_517_629_3),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(2.1886479044632097, 1.649_310_519_420_254),
            Complex::new(-4.321_106_475_698_161, -2.1601644264789415),
            Complex::new(-1.173_635_376_728_053, 0.446_960_316_171_670_1),
            Complex::new(3.382_051_917_879_285, -8.492_231_414_155_005E-2),
            Complex::new(3.092_669_728_983_18, 4.163_943_499_845_326),
            Complex::new(-1.3968517348030054, 1.7919033135624716),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.236_205_308_611_553, -2.086_614_012_360_86),
            Complex::new(2.6401207762340264, 1.3556523872895743),
            Complex::new(3.382_051_917_879_285, -8.492_231_414_154_983E-2),
            Complex::new(-1.2802427112923338, -2.8478057588853924),
            Complex::new(0.580_525_209_543_643_3, -1.3167541319542138),
            Complex::new(0.267_027_813_698_991_5, 1.5534416036652496),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(1.7787698841774622, 1.9582891274041572),
            Complex::new(0.826_736_980_781_904_8, 1.363_115_705_001_635),
            Complex::new(3.092_669_728_983_18, 4.163_943_499_845_326),
            Complex::new(0.580_525_209_543_643_3, -1.3167541319542138),
            Complex::new(0.463_334_558_937_365_4, 1.5569226660266944),
            Complex::new(-2.055_270_736_540_656, -9.914_347_550_297_571E-2),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-0.42127492052244325, 1.7564152697844997),
            Complex::new(-4.191_116_112_808_825E-2, 0.514_608_167_517_629_5),
            Complex::new(-1.3968517348030054, 1.7919033135624716),
            Complex::new(0.267_027_813_698_991_5, 1.5534416036652496),
            Complex::new(-2.055_270_736_540_656, -9.914_347_550_297_561E-2),
            Complex::new(-0.548_591_424_072_991_1, -2.012_595_122_723_258),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(0.703_980_115_565_013_5, -4.318_703_955_326_717),
            Complex::new(1.162_557_442_055_625, 2.4450397828819868),
            Complex::new(-3.011_917_207_650_825, 0.487_965_009_795_740_5),
            Complex::new(1.749_136_377_262_802, 1.5679777842761784),
            Complex::new(0.466_423_296_179_377_5, -0.644_643_689_183_768_6),
            Complex::new(-2.342_492_604_202_548E-2, -1.5276625839558975),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.358_681_677_899_053, -2.072_229_218_624_482),
            Complex::new(-0.667_251_995_179_294_6, 2.733_195_051_751_718),
            Complex::new(-0.630_279_445_840_507_1, -8.028_940_195_533_824E-2),
            Complex::new(0.26516547300333376, 0.20031487876278925),
            Complex::new(1.1026274849071527, -2.6119247798858396),
            Complex::new(0.689_526_691_991_024_3, -0.47112244715826745),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.427_724_238_419_397_3E-2, 7.062_410_354_847_552),
            Complex::new(-3.6902996327569393, -2.419_877_772_421_801),
            Complex::new(1.4639644420120586, 2.960_810_802_177_242),
            Complex::new(0.24175759771871802, -1.1245397778443258),
            Complex::new(0.45537567319224587, 2.641_582_909_329_802),
            Complex::new(-1.1778617934068787, 0.636_604_457_314_021_6),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-3.036_560_428_164_098, -2.3109163126664773),
            Complex::new(0.42317461249871874, -2.8101530413414797),
            Complex::new(-2.9173620909959506, -1.862_046_092_988_476),
            Complex::new(1.555_089_262_587_312, 0.947_752_381_592_860_3),
            Complex::new(-6.843_212_378_182_428E-2, 0.611_399_485_342_243_9),
            Complex::new(8.205_947_446_441_17E-2, 0.237_573_159_488_958_1),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.286_000_947_085_911_4, 2.3393622045456595),
            Complex::new(-3.8632194034644978, -3.032_769_143_384_963),
            Complex::new(-1.0425967328457988, 0.784_531_474_246_573_1),
            Complex::new(2.9344311617356444, -1.0249248291595738),
            Complex::new(2.553_221_522_268_666, 4.108_177_846_357_798),
            Complex::new(-1.1832737995010767, 2.059_295_145_249_443),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.534_609_776_438_701_2, -2.060_553_654_282_673),
            Complex::new(2.749_678_758_165_563, 1.7563296882892945),
            Complex::new(4.351_725_136_750_539, 0.595_563_397_559_451_4),
            Complex::new(-1.3257732219195217, -3.423_733_913_114_44),
            Complex::new(0.975_580_318_732_424_8, -2.5074273340914632),
            Complex::new(8.256_226_031_895_585E-2, 1.6392752378902848),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(1.4933776908989083, 1.6613233898085138),
            Complex::new(0.644_612_107_052_484_1, 0.856_596_020_708_965_8),
            Complex::new(3.222_694_764_573_486, 4.749_175_371_900_734),
            Complex::new(0.605_036_857_133_321_6, -0.343_757_054_057_066_4),
            Complex::new(-0.34859676524555194, 2.603_241_832_542_747),
            Complex::new(-1.880_186_667_540_709, -0.508_000_630_481_149),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-0.401_407_452_346_145_9, 3.245_666_059_207_053),
            Complex::new(1.302_198_084_173_832, 0.655_215_025_958_965_3),
            Complex::new(-0.744_554_877_977_998_7, 1.243_962_717_400_084),
            Complex::new(0.336_395_509_587_387, 0.828_862_872_536_993_3),
            Complex::new(-2.2839711106626255, -1.0335533593546806),
            Complex::new(-2.6854322285431835, -2.3841369621372257),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(1.7885151821179959, -3.882_597_672_316_08),
            Complex::new(1.3486609735668056, 2.205_284_512_404_524),
            Complex::new(-2.7193176444604905, 0.641_031_879_666_565),
            Complex::new(2.0030044959940043, 1.1843134328178624),
            Complex::new(0.752_917_436_305_101_2, 1.3588926544434505),
            Complex::new(0.531_044_143_118_034_5, -2.3423181027060807),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.6617446459007608, -1.6224881672822773),
            Complex::new(-1.003_693_227_986_353, 2.6705753825732965),
            Complex::new(-1.1817286098652349, -1.8327424095409381),
            Complex::new(-0.630_909_026_128_025_2, -0.649_738_766_163_365_8),
            Complex::new(1.2200586832274105, -2.336_363_022_119_209),
            Complex::new(0.28443119961172436, -0.37923723074504945),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.8196284538355458, -4.299_658_015_771_111),
            Complex::new(0.45734796133360955, 2.8388425183224153),
            Complex::new(-1.5013115133408128, -0.877_518_372_329_253_9),
            Complex::new(1.8892081183447096, 1.9344024594218006),
            Complex::new(-0.795_988_651_496_310_4, -0.969_084_039_892_014_4),
            Complex::new(0.589_066_188_872_950_7, -0.859_359_031_283_092_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-1.498_243_671_072_235, 1.8295192701688159),
            Complex::new(5.318_376_582_135_686, -7.587_666_198_252_199),
            Complex::new(1.1670895062939062, 2.226_802_501_928_325),
            Complex::new(-1.6470707251294971, -3.567_664_000_595_615),
            Complex::new(-0.49997600812399035, 1.0883817216415144),
            Complex::new(2.1952765649333856, -2.642_136_822_081_824),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.21811007379003433, -0.257_230_435_733_303_5),
            Complex::new(-0.775_536_091_868_191_1, 0.628_893_019_127_654_9),
            Complex::new(2.902_699_326_403_965, -6.129_636_734_022_768),
            Complex::new(-0.340_445_014_242_127_1, -2.362_109_660_932_51),
            Complex::new(-0.536_919_419_488_456_2, -3.723_534_617_971_73E-2),
            Complex::new(2.6674768453128817, -1.158_338_645_958_069),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.9757767624629965, -0.32530470929358923),
            Complex::new(2.785_276_265_900_652, -1.3714762599359638),
            Complex::new(1.9255606839696517, -0.37788781790985637),
            Complex::new(0.836_541_339_788_660_1, -2.6340956883647433),
            Complex::new(-0.264_418_107_706_35, -1.2507483452160089),
            Complex::new(2.1424623995832146, -2.606_850_743_696_776E-2),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(0.547_429_354_381_601_8, -1.8184509856239055),
            Complex::new(-1.7871565933077898, 0.47633900148100994),
            Complex::new(0.11486254555456127, 0.596_180_202_963_475_1),
            Complex::new(0.522_823_434_578_053_1, 1.4091155360784073),
            Complex::new(-3.277_131_559_972_113E-2, -0.771_720_750_307_952_2),
            Complex::new(-0.26524520459442386, 1.4776512170289295),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-1.096_772_107_430_174, 0.694_434_237_550_293_3),
            Complex::new(1.6282824605005524, -2.9904090194366253),
            Complex::new(-7.621_587_286_377_518E-3, -3.3081643013284214),
            Complex::new(-1.4543775449277387, -2.4867694780908165),
            Complex::new(-1.2911173489954964, 0.685_489_458_187_058_4),
            Complex::new(0.20149107900190577, -5.827_649_257_792_341),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(-1.5406923567757924, -0.46501488646685485),
            Complex::new(1.3575059813474573, -1.0568234499978022),
            Complex::new(-1.435_400_888_237_193, 0.790_730_963_091_373_9),
            Complex::new(0.19568636296598083, -0.663_689_407_869_223_3),
            Complex::new(-4.855_139_650_953_938E-2, 2.5799940115246076),
            Complex::new(-0.45900973107536047, -2.8209087503259562),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(0.806_693_321_699_351_3, 4.122_560_870_733_664),
            Complex::new(-1.2719421237726531, -2.760_384_716_477_659_6E-2),
            Complex::new(-2.424_206_912_739_124, -2.762_971_859_676_537),
            Complex::new(-3.355_149_049_238_193, -0.27416575871110116),
            Complex::new(-2.675_290_880_669_800_6E-2, 2.7401980493192077),
            Complex::new(-2.5113098663629576, -2.478_989_126_038_656),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.360_765_918_793_043, -5.508_453_497_822_416),
            Complex::new(0.178_984_151_176_373, 3.185_731_828_606_215),
            Complex::new(-0.776_628_050_889_661_1, -2.189_018_655_086_242),
            Complex::new(1.4112452120144385, 0.972_328_224_905_266),
            Complex::new(0.527_405_559_488_906, -1.6523778218176595),
            Complex::new(1.345_653_061_757_386, 0.260_451_781_187_385_3),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-2.4303466858223133, 2.067_447_120_697_292),
            Complex::new(3.984_973_404_078_565, -9.298_270_748_354_62),
            Complex::new(-0.236_654_878_408_305, 1.928_684_168_437_859),
            Complex::new(-0.562_039_211_482_782_8, -3.159_763_994_898_901),
            Complex::new(0.395_193_096_439_739, 1.8400979413009055),
            Complex::new(2.0713059293408858, -2.365_101_814_053_153),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(2.120_757_031_167_333, -0.947_282_120_858_709_2),
            Complex::new(-1.233_423_164_101_854, 1.5014977360336765),
            Complex::new(2.7716606825217105, -6.467_207_892_097_671),
            Complex::new(0.10717574190151363, -1.422_107_145_914_486),
            Complex::new(2.528_787_226_057_686E-3, 1.853_030_730_781_085_3E-2),
            Complex::new(2.453_898_910_010_953, -1.425_730_477_645_04),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.6773722946358482, -0.351_365_067_371_776_3),
            Complex::new(2.6757182839691147, -1.772_153_560_935_684),
            Complex::new(0.955_887_465_098_398, -1.0583735296108576),
            Complex::new(0.882_071_850_415_848, -2.058_167_534_135_696),
            Complex::new(-0.659_473_216_895_131_7, -6.007_514_307_875_93E-2),
            Complex::new(2.326_927_952_963_25, -0.11190214166200296),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(0.832_821_547_660_155_7, -1.521_485_248_028_262),
            Complex::new(-1.605_031_719_578_369, 0.982_858_685_773_679_2),
            Complex::new(-1.516_249_003_574_516E-2, 1.094_833_090_806_583_2E-2),
            Complex::new(0.498_311_786_988_374_9, 0.43611845818125994),
            Complex::new(0.779_160_008_583_196_2, -1.8180399168240051),
            Complex::new(-0.44032927359437096, 1.8865083720071028),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-1.1166395756064713, -0.794_816_551_872_26),
            Complex::new(0.284_173_215_198_631_8, -3.131_015_877_877_961),
            Complex::new(-0.659_918_444_111_384_2, -2.760_223_705_166_034),
            Complex::new(-1.5237452408161343, -1.7621907469625604),
            Complex::new(-1.0624169748735268, 1.6198993420387635),
            Complex::new(2.3383318834720987, -5.456_107_418_378_373),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(-2.625_227_423_328_775, -0.901_121_169_477_490_8),
            Complex::new(1.1714024498362767, -0.817_068_179_520_339_4),
            Complex::new(-1.7280004514275273, 0.637_664_093_220_549_3),
            Complex::new(-5.818_175_576_522_158E-2, -0.280_025_056_410_907),
            Complex::new(-0.335_045_536_635_263_1, 0.576_457_667_897_388_5),
            Complex::new(-1.0134788002354205, -2.006_253_231_575_773),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(0.503_630_353_697_643_4, 3.672_819_819_391_459),
            Complex::new(-0.935_500_890_965_594_6, 3.501_582_201_364_472_6E-2),
            Complex::new(-1.8727577487143963, -1.0105188520909372),
            Complex::new(-2.459_074_550_106_834, 0.575_887_886_215_053_9),
            Complex::new(-0.14418410712695562, 2.4646362915525772),
            Complex::new(-2.1062143739836574, -2.570_874_342_451_874),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.538_546_083_267_967, 5.069_015_258_659_708),
            Complex::new(-0.874_039_021_978_398, -3.7691885022136624),
            Complex::new(1.9140254885133325, 4.763_659_397_227_944),
            Complex::new(2.5270697488146867, 1.118_945_190_789_266_7E-2),
            Complex::new(0.429_100_549_334_437_1, 2.0436681273282624),
            Complex::new(-6.118_141_754_694_473E-2, -2.7399841207848903),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-2.0130764520945146, -0.844_317_294_064_272_5),
            Complex::new(-0.47069741916643015, -0.581_587_539_955_668_5),
            Complex::new(-0.937_220_180_113_351_7, 1.8457418203551164),
            Complex::new(-1.8048698148425042, -0.14148677317328284),
            Complex::new(-0.950_272_137_083_582_3, 0.29695644985116076),
            Complex::new(-3.2087554653423718, -0.508_138_301_990_090_5),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(-9.152_009_399_136_007E-2, 0.392_230_485_694_154_1),
            Complex::new(-2.313_790_911_914_354, -3.778_882_643_798_223),
            Complex::new(2.484_723_893_167_628, 5.931_711_444_304_231),
            Complex::new(-0.859_213_355_450_861_2, -0.627_033_990_229_209_5),
            Complex::new(-0.363_100_002_228_842_4, -0.42164912145004435),
            Complex::new(0.26905532925182346, 1.6041401026677333),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.561_067_718_393_567_3, 0.10023919776376478),
            Complex::new(2.341_156_130_698_27, 2.094_451_785_510_712),
            Complex::new(3.8190228914582462, -0.579_125_413_361_857_5),
            Complex::new(1.5141289683700436, 0.926_414_880_518_325_2),
            Complex::new(-0.481_114_893_770_410_7, -0.15029248925437355),
            Complex::new(3.5971975359896087, -2.452_038_592_240_738),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(0.593_723_262_125_801_3, 2.9091162086447957),
            Complex::new(2.6024943436570145, -1.7488855939103223),
            Complex::new(1.7151081344813948, 1.9041313282185193),
            Complex::new(1.4488923316758069, 1.6595226913367753),
            Complex::new(-2.6918384958555883, 1.3759187103651978),
            Complex::new(5.354_437_448_806_487, 3.602_747_678_415_397E-2),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-0.540_383_705_448_183_6, 2.6259744913786442),
            Complex::new(1.6572061182101778, 0.750_849_513_691_517_4),
            Complex::new(-2.3391983099638334, -0.46825512757162424),
            Complex::new(-0.923_809_859_401_910_8, -1.135_030_923_941_411),
            Complex::new(-0.15547308200089907, -1.7314978809001098),
            Complex::new(-3.1375194965446105, 2.3072607976361614),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(-2.592_804_565_913_804, -2.566_348_293_386_559),
            Complex::new(0.13950376570458456, 1.8101560578598437),
            Complex::new(-0.28371278516671494, -1.696_358_404_494_646),
            Complex::new(-1.499_221_550_339_226, 0.424_077_052_313_097_9),
            Complex::new(-1.9154880248899508, 0.292_146_089_721_657),
            Complex::new(0.586_088_176_609_562_9, 2.141_843_762_473_539),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(0.26688042031916215, -1.6134463686323126),
            Complex::new(-3.7328432388295463, 1.5568438906213706),
            Complex::new(-0.700_327_589_175_196_3, -4.207_308_422_933_22),
            Complex::new(-2.6275472719887603, -1.7627577611524732),
            Complex::new(0.19085108885961843, -0.11999828389145634),
            Complex::new(-2.0306778826051053, 1.0207520805142891),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.079_683_548_225_464, 3.860_219_776_608_403),
            Complex::new(-1.1524028321356345, -3.422_299_191_929_863),
            Complex::new(2.6387089509644843, 3.4521591144709562),
            Complex::new(2.0491068424844157, -0.950_884_782_608_641_8),
            Complex::new(1.7524947603196535, 1.3603743454026174),
            Complex::new(0.695_405_455_337_490_7, -1.6201733083144128),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-2.9451794668445928, -0.606_389_443_535_796_2),
            Complex::new(-1.8041005972235518, -2.292_192_090_058_089),
            Complex::new(-2.340_964_564_815_563, 1.5476234868646503),
            Complex::new(-0.719_838_301_195_79, 0.266_413_232_523_431_1),
            Complex::new(-5.510_303_251_985_299E-2, 1.048_672_669_510_552),
            Complex::new(-3.3327261009348716, -0.23110329396141926),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(1.8111268633859385, -0.297_821_199_431_251_6),
            Complex::new(-2.771_677_984_148_017, -2.9062779268922014),
            Complex::new(2.3536852492853737, 5.594_140_286_229_328),
            Complex::new(-0.41159259930722053, 0.31296852478881404),
            Complex::new(0.17634820448567146, -0.365_883_467_962_516_2),
            Complex::new(5.547_739_394_989_476E-2, 1.3367482709807623),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.26266325056641915, 7.417_883_968_557_77E-2),
            Complex::new(2.231_598_148_766_733, 1.6937744845109917),
            Complex::new(2.8493496725869925, -1.2596111250628588),
            Complex::new(1.5596594789972316, 1.5023430347473723),
            Complex::new(-0.876_170_002_959_192_5, 1.040_380_712_882_876),
            Complex::new(3.781_663_089_369_644, -2.5378722264657734),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(0.879_115_455_404_355_2, 3.206_081_946_240_439),
            Complex::new(2.7846192173864353, -1.2423659096176531),
            Complex::new(1.5850830988910882, 1.318_899_456_163_11),
            Complex::new(1.4243806840861286, 0.686_525_613_439_627_9),
            Complex::new(-1.879_907_171_672_671, 0.329_599_543_849_144_8),
            Complex::new(5.179_353_379_806_54, 0.444_884_631_762_327_2),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-0.560_251_173_624_481, 1.136_723_701_956_091),
            Complex::new(0.313_096_872_908_257_2, 0.610_242_655_250_181_6),
            Complex::new(-2.991_495_166_788_84, 7.968_546_859_076_331E-2),
            Complex::new(-0.993_177_555_290_306_4, -0.410_452_192_813_154_6),
            Complex::new(7.322_729_212_107_043E-2, -0.797_087_997_048_404_8),
            Complex::new(-1.0006786920744175, 2.6788026370501297),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(-3.6773396324667864, -3.002_454_576_397_195),
            Complex::new(-4.659_976_580_659_597E-2, 2.0499113283373065),
            Complex::new(-0.576_312_348_357_049_4, -1.8494252743654707),
            Complex::new(-1.7530896690704285, 0.807_741_403_771_414_1),
            Complex::new(-2.2019821650156746, -1.711_390_253_905_562),
            Complex::new(3.161_910_744_950_291_5E-2, 2.9564992812237225),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(-3.618_254_768_254_569_6E-2, -2.0631874199745175),
            Complex::new(-3.3964020060224875, 1.619_463_559_799_792),
            Complex::new(-0.14887842515046845, -2.4548554153476205),
            Complex::new(-1.731_472_772_857_401, -0.912_704_116_226_318),
            Complex::new(7.341_989_053_936_084E-2, -0.395_560_041_658_086_9),
            Complex::new(-1.6255823902258053, 0.928_866_864_101_071_1),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-6.150_043_876_169_741, 0.916_762_183_192_537_7),
            Complex::new(3.551_341_102_985_688, -1.872_596_912_423_66),
            Complex::new(-5.044_322_117_053_753, 1.7815102541278283),
            Complex::new(-0.246_642_399_334_648_5, -1.177_544_393_350_447),
            Complex::new(-3.517_109_937_379_48, 0.352_434_965_588_633_3),
            Complex::new(-6.294_782_805_159_294E-2, -2.7407411539012854),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(3.4023707943114747, 1.476_588_800_430_464),
            Complex::new(4.237_473_735_395_275, 1.4362002122560311),
            Complex::new(1.897_509_721_908_682, 3.060_626_133_043_364),
            Complex::new(-0.781_511_261_905_209_9, 0.297_095_488_696_547),
            Complex::new(-1.6165507017720082, 1.140_847_734_661_165_6E-2),
            Complex::new(2.589_752_997_831_927, 1.9769368947246266),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(-2.9360362770799613, -0.826_847_947_689_278_9),
            Complex::new(4.473_935_215_144_736, -0.869_856_995_638_200_3),
            Complex::new(-5.543_121_823_836_927, 2.4912059417117076),
            Complex::new(-0.390_396_192_247_968_9, -0.42611233745095733),
            Complex::new(-0.396_117_544_971_925_5, -0.435_799_497_714_630_5),
            Complex::new(-0.792_672_499_894_227, 1.1491138643464012),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.17097311988904368, 0.26742260661323425),
            Complex::new(-2.6560015565570594, -4.718_734_488_598_586E-2),
            Complex::new(-8.326_320_630_737_194E-2, -2.2515338359121757),
            Complex::new(-2.2090613105721975, -0.669_238_186_750_569_1),
            Complex::new(0.24593109115317413, 0.16129866482933353),
            Complex::new(-0.954_739_335_471_806_1, -4.402_868_790_751_379),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-3.213_324_326_246_65, 1.2775242924371235),
            Complex::new(-1.2029075227147334, -3.379_772_200_649_084),
            Complex::new(-1.9182008359011142, 0.346_998_823_947_609_7),
            Complex::new(-1.4549590730581896, 0.41501487580464025),
            Complex::new(0.24588078336315844, 2.634_941_330_071_892),
            Complex::new(-3.7190414743748983, -3.8526065681799078),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-0.416_897_210_677_407_5, 2.6788972778560662),
            Complex::new(0.686_280_505_652_198_3, 0.33473851325986215),
            Complex::new(2.657_693_610_186_431, 1.673_270_102_630_723),
            Complex::new(1.0515417177842015, -0.28845162851873785),
            Complex::new(0.29799972291665666, -1.5371523820460204),
            Complex::new(-3.386_540_273_529_574, 2.200_537_601_441_465),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(5.794_822_585_438_096, 1.028_349_261_250_6),
            Complex::new(-1.2661773065742703, 1.2077212783994682),
            Complex::new(2.029_295_382_217_705, -0.705_069_133_629_473),
            Complex::new(0.877_979_212_689_870_8, 1.4428774371591229),
            Complex::new(3.0443851104182165, 2.4178061255196392),
            Complex::new(-1.608_250_567_323_7, 1.201_412_818_831_617),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.8220487762119173, -0.946_945_606_843_475_2),
            Complex::new(0.833_189_839_652_616_7, 3.513_715_321_055_271),
            Complex::new(1.3288795985618007, -3.3376481502499455),
            Complex::new(0.958_968_299_268_256_2, -0.22567957193089871),
            Complex::new(0.35323683461731087, -5.040_438_890_185_556E-2),
            Complex::new(4.336_800_732_670_765E-2, 1.909_628_940_943_34),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-5.608_906_411_212_244, -0.292_033_298_858_767_3),
            Complex::new(3.2729772928284513, -1.5257076021398606),
            Complex::new(-4.319_638_654_602_601, 0.470_009_971_370_840_1),
            Complex::new(-0.724_605_305_664_919_5, -2.1396186278669815),
            Complex::new(-2.1937157263942635, -0.33085881633701175),
            Complex::new(0.693_639_044_832_842_4, -1.6209303414308074),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(2.4702677795613965, 1.7145166509589402),
            Complex::new(2.9040705573381533, -0.274_404_337_846_389_4),
            Complex::new(0.493_765_337_206_471, 2.762_507_799_552_898),
            Complex::new(0.30352025174150443, 0.704_995_494_393_260_9),
            Complex::new(-0.721_381_597_208_278_9, 0.763_124_697_006_002_8),
            Complex::new(2.4657823622394273, 2.253_971_902_753_298),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(-1.0333893197026627, -1.5168996328146847),
            Complex::new(4.016_048_142_911_073, 2.747_721_267_821_301_4E-3),
            Complex::new(-5.674_160_467_719_181, 2.1536347836368046),
            Complex::new(5.722_456_389_567_182E-2, 0.513_890_177_567_066_2),
            Complex::new(0.143_330_661_742_588_4, -0.38003384422710235),
            Complex::new(-1.0062504351961556, 0.881_722_032_659_430_2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.127_431_347_938_104_5, 0.24136224853504717),
            Complex::new(-2.7655595384885965, -0.447_864_645_885_706_2),
            Complex::new(-1.0529364251786257, -2.932_019_547_613_177),
            Complex::new(-2.1635307999450095, -9.331_003_252_152_203E-2),
            Complex::new(-0.149_124_018_035_607_6, 1.351_971_866_966_583),
            Complex::new(-0.770_273_782_091_770_4, -4.488_702_424_976_414),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-2.9279321329680963, 1.574_490_030_032_767),
            Complex::new(-1.0207826489853127, -2.873_252_516_356_415),
            Complex::new(-2.0482258714914208, -0.23823304810779955),
            Complex::new(-1.4794707206478679, -0.557_982_202_092_507),
            Complex::new(1.0578121075460758, 1.588_622_163_555_839),
            Complex::new(-3.8941255433748454, -3.4437494132017346),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(-0.43676467885370485, 1.189_646_488_433_513),
            Complex::new(-0.657_828_739_649_722_2, 0.19413165481852632),
            Complex::new(2.005_396_753_361_424, 2.2212106987931106),
            Complex::new(0.982_174_021_895_805_9, 0.436_127_102_609_518_5),
            Complex::new(0.526_700_097_038_626_2, -0.602_742_498_194_315_2),
            Complex::new(-1.2496994690593812, 2.572_079_440_855_433),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(4.710_287_518_885_114, 0.592_242_978_239_964_1),
            Complex::new(-1.4522808380854508, 1.447_476_548_876_931),
            Complex::new(1.7366958190273707, -0.858_136_003_500_297_6),
            Complex::new(0.624_111_093_958_668_4, 1.826_541_788_617_439),
            Complex::new(2.7578909702924927, 0.41426978189242025),
            Complex::new(-2.162_719_636_483_76, 2.0160683375818005),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(1.5189858082102095, -1.396_686_658_185_68),
            Complex::new(1.1696310724596752, 3.5763349902336925),
            Complex::new(1.8803287625865286, -1.5851951426643458),
            Complex::new(1.8550427983996152, 0.624_374_072_995_256_4),
            Complex::new(0.23580563629705326, -0.325_966_146_668_486_1),
            Complex::new(0.44846349970600774, 1.817_743_724_530_122),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.9662382698970875, -2.0530064297387383),
            Complex::new(-0.165_661_788_003_219_5, 2.0315047686864234),
            Complex::new(-0.386_202_888_099_978_8, -1.7003378831363722),
            Complex::new(1.0340649521920033, 2.634_601_526_324_833),
            Complex::new(0.18984068857561254, 1.4284340848302317),
            Complex::new(-0.601_337_812_342_313_4, -2.698_309_238_399_76),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(1.0590944192764742, 2.047_022_378_015_706),
            Complex::new(1.5362309226730355, -4.473_337_872_994_366),
            Complex::new(2.5143241756448425, 3.590_464_191_405_232),
            Complex::new(-2.332_496_574_794_323, -1.3736732601341644),
            Complex::new(-1.3307325220258206, 0.455_959_768_581_709_4),
            Complex::new(2.5359736395518007, -1.6995204331579026),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(-0.553_121_207_650_472_1, -3.277_433_897_723_909),
            Complex::new(-0.275_179_605_154_254_3, -1.6121287859899063),
            Complex::new(0.863_833_176_379_647_1, -1.448_873_183_157_205),
            Complex::new(-0.392_203_370_592_559_3, -1.4577285139278198),
            Complex::new(-1.3207898487439298, -0.769_775_025_546_211),
            Complex::new(4.107_617_633_193_264, -2.1361187125788117),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.1928338144108308, 0.545_032_794_372_464_7),
            Complex::new(0.777_740_791_874_755, 3.796_849_748_149_8),
            Complex::new(-2.2595258003240897, -0.459_004_849_044_123_2),
            Complex::new(-1.0799521591340557, 0.369_582_924_417_763_3),
            Complex::new(-0.579_822_935_140_723_8, -0.16127684822808552),
            Complex::new(-2.014_923_952_133_7, -1.385_561_288_749_201),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(0.642_065_337_771_869, -1.0141299132555142),
            Complex::new(0.248_546_029_822_603_2, 5.273_918_582_362_377),
            Complex::new(1.4879302282060944, -3.8144873772657073),
            Complex::new(0.799_817_370_003_142_6, 1.1588526278722129),
            Complex::new(-2.0864424504400287, 1.149_617_872_966_786),
            Complex::new(1.2861047516169348, -0.23881163545053613),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(1.0121300475780082, 2.6739608948819784),
            Complex::new(-0.45615820581901767, -0.38393120350382026),
            Complex::new(3.5864532049429783, -0.613_033_154_168_673_5),
            Complex::new(0.552_471_737_808_755_2, -1.0624276583543844),
            Complex::new(0.48968426694509803, -1.7590733075657838),
            Complex::new(-1.954_863_294_387_777, 1.7013820419892762),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(-3.557_850_066_440_701, 1.8577791355219724),
            Complex::new(9.462_588_005_740_53E-2, -1.6462026294281489),
            Complex::new(1.7187570531033243, 1.7329235942744154),
            Complex::new(0.354_831_289_044_009_5, -2.247_418_991_698_51),
            Complex::new(-1.7865225219801513, 1.183_339_635_706_334),
            Complex::new(1.6885936017695036, -0.513_452_972_851_591_3),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(-2.5760846495535086, 1.0304177824689875),
            Complex::new(7.431_755_193_825_018E-2, -3.061_082_249_709_629),
            Complex::new(-0.841_803_712_712_155_1, -1.6648453774686487),
            Complex::new(-1.0037348754404496, -2.478_583_771_556_249),
            Complex::new(0.408_190_712_431_134_3, 0.24047741225782382),
            Complex::new(-1.1449782488550009, -0.754_949_168_578_846_1),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.507_375_734_854_585, -3.261_801_911_790_043),
            Complex::new(-0.44402559816045606, 2.378_394_078_970_223),
            Complex::new(0.33848057435117296, -3.0118381658933604),
            Complex::new(0.556_102_045_861_732_2, 1.6725272918082985),
            Complex::new(1.513_234_899_560_829, 0.745_140_302_904_586_7),
            Complex::new(0.155_249_060_542_122, -1.5784984259292822),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(0.126_991_404_526_395_9, 2.2849502285441825),
            Complex::new(0.202_827_744_615_913_9, -6.183_942_423_096_786),
            Complex::new(1.1105797909426314, 3.292_345_857_914_766),
            Complex::new(-1.2474650611476088, -0.965_773_254_437_450_4),
            Complex::new(-0.435_563_417_462_091_3, 1.2076759882411006),
            Complex::new(2.412_003_003_959_301, -1.4224854251292314),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(1.3495257497268265, -3.9674855828493145),
            Complex::new(-0.733_066_677_387_917_3, -0.739_524_069_083_884_6),
            Complex::new(0.732_794_532_497_392_7, -1.7864443412321078),
            Complex::new(5.541_738_555_108_144_4E-2, -0.517_725_998_909_796_1),
            Complex::new(-0.781_341_642_029_415_9, -0.714_009_372_058_682_9),
            Complex::new(3.894_039_697_891_335, -2.4035105442657825),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.894_429_346_583_682_6, 0.518_972_436_294_277_6),
            Complex::new(0.668_182_809_943_217_9, 3.3961724471500796),
            Complex::new(-3.2291990191953435, -1.1394905607451244),
            Complex::new(-1.0344216485068678, 0.945_511_078_646_810_4),
            Complex::new(-0.974_878_044_329_505_5, 1.029_396_353_909_164),
            Complex::new(-1.8304583987536645, -1.4713949229742362),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(0.927_457_531_050_423, -0.717_164_175_659_870_6),
            Complex::new(0.430_670_903_552_024, 5.780_438_266_655_047),
            Complex::new(1.357_905_192_615_788, -4.399_719_249_321_117),
            Complex::new(0.775_305_722_413_464_3, 0.18585554997506562),
            Complex::new(-1.2745111262571114, 0.10329870645073308),
            Complex::new(1.1110206826169877, 0.17004551952763708),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(0.992_262_579_401_710_8, 1.1847101054594251),
            Complex::new(-1.8002674511209382, -0.524_538_061_945_156_1),
            Complex::new(2.9341563481179715, -6.509_255_800_628_6E-2),
            Complex::new(0.483_104_041_920_359_7, -0.337_848_927_226_128),
            Complex::new(0.718_384_641_067_067_6, -0.824_663_423_714_078_7),
            Complex::new(0.18197751008241592, 2.0729238814032445),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(-4.642_385_132_993_684, 1.4216728525113365),
            Complex::new(-9.147_765_145_377_523E-2, -1.406_447_358_950_686),
            Complex::new(1.4261574899129899, 1.5798567244035908),
            Complex::new(0.100_963_170_312_807_1, -1.8637546402401939),
            Complex::new(-2.073_016_662_105_875, -0.820_196_707_920_885_2),
            Complex::new(1.1341245326094436, 0.30120254589859213),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(-2.8791476175552164, 0.580_676_731_126_782_6),
            Complex::new(0.410_758_784_745_308_7, -2.9984625805312075),
            Complex::new(-0.290_354_548_687_427_2, 8.760_763_011_695_11E-2),
            Complex::new(-0.10766037630909076, -1.628_530_126_630_094),
            Complex::new(0.290_759_514_110_876_7, -3.508_434_550_880_672E-2),
            Complex::new(-0.739_882_756_475_700_8, -0.846_834_384_992_064_1),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.0, 0.0),
        &a,
        8,
        &b,
        8,
        Complex::new(1.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.2629542350769043, 0.992_160_379_886_627_2),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(0.377_395_659_685_134_9, -0.17262350022792816),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
            Complex::new(0.992_160_379_886_627_2, 1.2629542350769043),
            Complex::new(-0.429_513_096_809_387_2, -0.326_233_357_191_085_8),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(1.7579030990600586, 0.41464143991470337),
            Complex::new(0.560_746_073_722_839_4, -1.5399500131607056),
            Complex::new(-0.452_783_972_024_917_6, -0.928_567_051_887_512_2),
            Complex::new(-0.832_043_290_138_244_6, -0.29472044110298157),
            Complex::new(-1.1665705442428589, -5.767_172_668_129_206E-3),
            Complex::new(-1.0655906200408936, 2.404_653_310_775_757),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(0.832_047_104_835_510_3, -1.147_657_036_781_311),
            Complex::new(-0.22732868790626526, -0.28946158289909363),
            Complex::new(0.26613736152648926, -0.299_215_108_156_204_2),
            Complex::new(-0.376_702_725_887_298_6, -0.411_510_825_157_165_5),
            Complex::new(2.4413645267486572, 0.252_223_461_866_378_8),
            Complex::new(-0.795_339_107_513_427_7, -0.891_921_103_000_640_9),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(0.618_243_277_072_906_5, -0.224_267_885_088_920_6),
            Complex::new(-0.17262350022792816, 0.377_395_659_685_134_9),
            Complex::new(-2.223_900_318_145_752, 0.133_336_365_222_930_9),
            Complex::new(-1.2636144161224365, 0.804_189_503_192_901_6),
            Complex::new(0.35872888565063477, -5.710_677_430_033_684E-2),
            Complex::new(-1.104_547_828_435_897_8E-2, 0.503_607_988_357_544),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.0, 0.0),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.2),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(5.415_877_184_508_4E-2, 0.451_022_929_713_471_6),
            Complex::new(2.065_594_823_145_788_8E-2, -0.15114929305239455),
            Complex::new(1.829_903_153_030_621E-2, 0.513_620_694_184_611_5),
            Complex::new(0.31035513148240934, 0.198_616_614_917_168_2),
            Complex::new(-0.26865233583230275, 0.43450891426963967),
            Complex::new(-0.420_139_223_637_271_2, -0.195_840_790_805_828_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(0.23216067777440957, -0.23446754687603627),
            Complex::new(0.694_048_796_505_462_9, 0.26781254213769046),
            Complex::new(0.46547511317543844, -0.16003773450907666),
            Complex::new(-0.391_109_269_724_924_3, 7.150_555_955_626_903E-2),
            Complex::new(-0.39594083422334236, -6.312_198_732_975_105E-2),
            Complex::new(-1.242_657_918_373_613E-2, -0.103_358_055_701_226_8),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(-0.43782821950060447, 0.538_717_605_750_525),
            Complex::new(-1.931_639_938_527_940_4E-2, -0.337_452_047_131_241),
            Complex::new(9.811_215_844_917_531E-2, 7.616_116_816_045_593E-2),
            Complex::new(-0.29753596033954555, -0.197_479_429_803_482_1),
            Complex::new(-0.16850223494324434, 7.879_507_957_093_534E-2),
            Complex::new(0.11000383362179744, 4.095_443_250_170_993_6E-2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-8.316_713_322_948_116E-2, 6.032_442_316_896_352_6E-2),
            Complex::new(0.10293069486216744, 9.851_250_348_258_767E-2),
            Complex::new(0.405_283_719_379_957_2, 2.902_405_305_242_617E-2),
            Complex::new(-0.11502570681312241, -0.161_355_837_603_745_4),
            Complex::new(-9.392_612_120_399_058E-2, -0.41991360813250544),
            Complex::new(-3.910_746_260_147_485E-2, 5.779_793_125_089_899E-2),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.136_344_598_775_276_5, -3.697_953_577_309_154E-2),
            Complex::new(-0.142_951_965_972_065_4, -0.11683669413382847),
            Complex::new(0.14151887024222118, 0.149_181_426_676_831),
            Complex::new(0.17891467480234313, 0.28185002627745304),
            Complex::new(-5.415_877_184_508_4E-2, 0.451_022_929_713_471_6),
            Complex::new(-2.065_594_823_145_788_8E-2, -0.15114929305239455),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(0.26865233583230275, 0.43450891426963967),
            Complex::new(0.420_139_223_637_271_2, -0.195_840_790_805_828_4),
            Complex::new(9.515_661_739_046_3E-2, -0.276_270_208_899_232_8),
            Complex::new(-0.10746457140839949, -0.22535274960626284),
            Complex::new(-0.23216067777440957, -0.23446754687603627),
            Complex::new(-0.694_048_796_505_462_9, 0.26781254213769046),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(0.39594083422334236, -6.312_198_732_975_105E-2),
            Complex::new(1.242_657_918_373_613E-2, -0.103_358_055_701_226_8),
            Complex::new(0.11307049562142035, -6.615_549_424_522_36E-3),
            Complex::new(6.961_619_957_709_608E-3, -0.15764271255795226),
            Complex::new(0.43782821950060447, 0.538_717_605_750_525),
            Complex::new(1.931_639_938_527_940_4E-2, -0.337_452_047_131_241),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(0.16850223494324434, 7.879_507_957_093_534E-2),
            Complex::new(-0.11000383362179744, 4.095_443_250_170_993_6E-2),
            Complex::new(-0.47144734369884933, -0.418_112_796_814_930_3),
            Complex::new(-0.41356079002560353, -9.188_498_395_509_992E-2),
            Complex::new(8.316_713_322_948_116E-2, 6.032_442_316_896_352_6E-2),
            Complex::new(-0.10293069486216744, 9.851_250_348_258_767E-2),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.0, 0.0),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.0, 0.0),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.252_590_850_779_277_8, 0.198_432_078_934_193_8),
            Complex::new(-6.524_667_241_046_833E-2, -8.590_262_064_192_622E-2),
            Complex::new(0.265_959_862_857_458_9, 0.24766083132715266),
            Complex::new(0.25448587319978877, -5.586_925_828_262_057E-2),
            Complex::new(8.292_828_921_866_846E-2, 0.351_580_625_050_971_2),
            Complex::new(-0.307_990_007_221_549_8, 0.112_149_216_415_721_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-1.153_434_550_813_355E-3, -0.23331411232522292),
            Complex::new(0.480_930_669_321_576_7, -0.21311812718388623),
            Complex::new(0.152_718_689_333_180_9, -0.31275642384225755),
            Complex::new(-0.15980185508432765, 0.23130741464059668),
            Complex::new(-0.229_531_410_776_546_7, 0.16640942344679566),
            Complex::new(-5.789_231_744_248_147E-2, -4.546_573_825_874_533_6E-2),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(5.044_469_312_496_025E-2, 0.488_272_912_625_564_7),
            Complex::new(-0.178_384_223_258_260_2, -0.159_067_823_872_980_8),
            Complex::new(8.713_666_330_481_562E-2, -1.097_549_514_435_969_3E-2),
            Complex::new(-0.24750769507151382, 5.002_826_526_803_172_4E-2),
            Complex::new(-4.485_357_768_615_45E-2, 0.12364865725708984),
            Complex::new(7.547_913_306_175_369E-2, -3.452_470_056_004_375E-2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.142_135_503_025_881_7E-2, 7.174_577_819_922_234E-2),
            Complex::new(0.10072159917237755, -2.209_095_689_789_886E-3),
            Complex::new(0.217_153_886_216_191_7, -0.18812983316376553),
            Complex::new(-0.138_190_772_208_433_9, -2.316_506_539_531_149E-2),
            Complex::new(-0.256_919_864_668_248, -0.16299374346425743),
            Complex::new(9.345_234_324_712_07E-3, 4.845_269_692_618_692E-2),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-8.666_206_727_418_402E-2, 4.968_253_150_109_247_5E-2),
            Complex::new(-0.12989433005294693, 1.305_763_591_911_846E-2),
            Complex::new(0.145_350_148_459_526_1, 3.831_278_217_304_917_6E-3),
            Complex::new(0.23038235053989808, 5.146_767_573_755_495E-2),
            Complex::new(0.198_432_078_934_193_8, 0.252_590_850_779_277_8),
            Complex::new(-8.590_262_064_192_622E-2, -6.524_667_241_046_833E-2),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.279_346_287_250_518_8, 1.272_429_347_038_269),
            Complex::new(0.351_580_625_050_971_2, 8.292_828_921_866_846E-2),
            Complex::new(0.112_149_216_415_721_4, -0.307_990_007_221_549_8),
            Complex::new(-9.055_679_575_438_491E-2, -0.185_713_413_144_847_9),
            Complex::new(-0.16640866050733116, -5.894_408_909_893_167_3E-2),
            Complex::new(-0.23331411232522292, -1.153_434_550_813_355E-3),
            Complex::new(-0.21311812718388623, 0.480_930_669_321_576_7),
            Complex::new(-1.5637820959091187, 0.763_593_435_287_475_6),
            Complex::new(1.1565370559692383, -0.799_009_263_515_472_4),
            Complex::new(0.16640942344679566, -0.229_531_410_776_546_7),
            Complex::new(-4.546_573_825_874_533_6E-2, -5.789_231_744_248_147E-2),
            Complex::new(5.322_747_309_844_899_6E-2, -5.984_302_252_297_135_6E-2),
            Complex::new(-7.534_054_630_012_132E-2, -8.230_216_625_783_093E-2),
            Complex::new(0.488_272_912_625_564_7, 5.044_469_312_496_025E-2),
            Complex::new(-0.159_067_823_872_980_8, -0.178_384_223_258_260_2),
            Complex::new(-5.487_747_490_406_036_4E-2, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.237_538_456_916_809),
            Complex::new(0.12364865725708984, -4.485_357_768_615_45E-2),
            Complex::new(-3.452_470_056_004_375E-2, 7.547_913_306_175_369E-2),
            Complex::new(-0.444_780_070_256_889_8, 2.666_727_344_195_951_6E-2),
            Complex::new(-0.252_722_886_990_351_7, 0.160_837_903_035_251_8),
            Complex::new(7.174_577_819_922_234E-2, -1.142_135_503_025_881_7E-2),
            Complex::new(-2.209_095_689_789_886E-3, 0.10072159917237755),
            Complex::new(-0.940_649_151_802_063, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.690_953_850_746_154_8),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'x',
            't',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            8,
            &b,
            8,
            Complex::new(0.2, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'c',
            'x',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            8,
            &b,
            8,
            Complex::new(0.2, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'n',
            'n',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            4,
            &b,
            8,
            Complex::new(0.2, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'n',
            'n',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            8,
            &b,
            3,
            Complex::new(0.2, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'n',
            'n',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            8,
            &b,
            8,
            Complex::new(0.2, 0.0),
            &mut [],
            5,
        );
    });
    assert!(result.is_err());
}

#[test]
fn trmm() {
    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-0.41405065468799945, -1.5191217029575041),
            Complex::new(-0.694_908_766_386_282_1, -1.4153085671446701),
            Complex::new(-0.834_190_641_986_409_5, -0.505_551_043_935_302_8),
            Complex::new(0.346_457_748_180_885_8, 0.28057501053159395),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.942_408_023_783_915, 1.8194772369531083),
            Complex::new(-2.915_365_888_283_363, -2.3126831220695263),
            Complex::new(-1.5721870875427124, 0.759_992_930_332_232_1),
            Complex::new(0.798_511_116_953_622_9, 0.41539800883503275),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.30059598777530616, -4.762_299_193_558_084E-4),
            Complex::new(-0.400_307_044_049_133_9, 0.649_826_391_609_889_5),
            Complex::new(0.332_133_533_160_737, 0.20926732060823242),
            Complex::new(1.283_759_948_501_932_1E-2, -0.190_490_023_715_409),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.763_255_124_716_289_5, 0.795_461_934_615_075_7),
            Complex::new(-0.837_924_054_585_266_8, 0.510_768_862_334_922_4),
            Complex::new(-3.695_949_673_677_695E-2, -5.480_567_432_648_478E-2),
            Complex::new(0.12676149970562242, 6.404_394_595_064_805E-2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.6508024981725062, -0.644_235_944_558_743_1),
            Complex::new(0.37551185028990675, 7.469_039_070_119_454E-2),
            Complex::new(-0.10496880817482218, 0.15546792320308533),
            Complex::new(-0.11660175095677679, -0.20949314958488327),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.676_628_461_504_606, 0.409_709_868_407_952_6),
            Complex::new(0.18500013285725259, 1.1724732013706247),
            Complex::new(0.518_424_483_618_668_9, 1.390_172_955_521_355_7E-2),
            Complex::new(-0.15617033770313232, -0.15971929721539613),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        'n',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-0.41405065468799945, -1.5191217029575041),
            Complex::new(-4.587_852_827_007_91E-2, -1.6328225075105753),
            Complex::new(-1.4266711201397058, 1.3912352824123402),
            Complex::new(0.47796290633027105, 0.962_074_234_516_534_5),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.765_894_253_911_223_2, 0.986_066_788_619_331_7),
            Complex::new(-1.7952358832719872, -2.328_607_480_803_268),
            Complex::new(-0.424_506_258_794_783_1, 0.20280603525803245),
            Complex::new(1.3334031780571216, 1.7106045501024205),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.594_573_116_788_423_2, -0.752_192_449_578_747_1),
            Complex::new(-9.294_608_487_344_869E-3, 0.394_292_439_332_953_2),
            Complex::new(-7.177_121_192_176_292E-2, 4.001_516_303_301_716_5E-2),
            Complex::new(0.21906001894265437, -0.40454921133144506),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.894_293_768_598_543_9, 1.1330330926899785),
            Complex::new(-0.635_345_012_092_590_3, -1.0787114552230488),
            Complex::new(-0.752_660_080_851_015_8, 1.631_006_856_151_182E-2),
            Complex::new(0.213_577_935_301_928_7, 0.267_391_831_686_971),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.9492069659996545, -0.618_175_586_480_556),
            Complex::new(0.18397794917513985, 0.684_612_466_338_727_1),
            Complex::new(1.3359479596257482, 0.781_498_968_716_159_9),
            Complex::new(-4.553_051_062_718_794E-2, -0.575_928_154_229_047_1),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.7695659025695811, -6.387_506_477_740_024E-2),
            Complex::new(-3.414_128_889_417_789E-2, 0.37099623206041554),
            Complex::new(6.860_495_649_386_383E-2, -0.295_967_118_014_385_3),
            Complex::new(-0.18212487372942077, -0.506_519_684_292_669_2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.370_666_427_958_966_4, -0.129_375_369_917_894_4),
            Complex::new(-0.538_479_207_945_392_6, -0.908_016_494_554_163_1),
            Complex::new(1.4384450317723125, -1.116_901_710_817_848),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.928_984_834_394_146, -0.19018934561877915),
            Complex::new(0.578_489_596_390_765_2, -1.275_859_708_056_164),
            Complex::new(1.3474196179958526, -2.561_181_525_291_386),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.0000000000000000, -0.0000000000000000),
            Complex::new(-0.29787973916147625, 0.608_220_704_511_993_4),
            Complex::new(-0.45228594812363454, -2.2680385476264697),
            Complex::new(-1.2911708889627647, -1.5158614406578568),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.547_957_741_853_509_5, 0.483_068_016_614_719_9),
            Complex::new(-1.1615060277364126, 1.011_888_532_369_323),
            Complex::new(-1.4892507275872222, -1.1002656652229008),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(0.40963463948849754, -8.957_790_566_506_539E-2),
            Complex::new(-0.43354575166980625, -0.41052366517593775),
            Complex::new(5.869_624_484_297_969_5E-2, 0.10846525402097236),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.742_152_732_488_28, 0.12542282209793743),
            Complex::new(1.7852967366485175, 1.2067822355121136),
            Complex::new(-0.24207421890203995, -1.278_638_141_184_665),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'n',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-1.1309596860986888, 0.988_769_831_793_479_9),
            Complex::new(1.5699501899216979, -0.435_402_486_832_907_4),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.17651376987269174, -0.833_410_448_333_776_5),
            Complex::new(0.191_145_170_617_229_9, -0.206_113_704_352_521_3),
            Complex::new(1.7261704251386947, -1.8330466031303638),
            Complex::new(1.8823116790993515, -1.265_974_984_023_998),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.895_169_104_563_729_3, -0.751_716_219_659_391_2),
            Complex::new(9.313_269_640_031_28E-2, 0.352_686_752_235_057_2),
            Complex::new(-0.856_190_693_206_134_5, -2.437_290_705_201_685),
            Complex::new(-1.0849484695051297, -1.7299206282738928),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.131_038_643_882_254_4, 0.337_571_158_074_902_8),
            Complex::new(-0.34537869936083304, -1.1064123009432514),
            Complex::new(-1.8772066118506514, 1.0830042752573195),
            Complex::new(-1.4024342919909158, -0.896_917_779_486_577_7),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.298_404_467_827_148_2, 2.606_035_807_818_707_4E-2),
            Complex::new(0.21810073837373067, 0.520_344_169_972_467_1),
            Complex::new(1.007_371_016_130_764, 0.21550738033713684),
            Complex::new(0.12976748517256848, -0.25796975062319144),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.092_937_441_064_975, -0.473_584_933_185_352_8),
            Complex::new(-0.961_294_154_239_710_4, -0.676_054_147_212_271_6),
            Complex::new(1.3354772095237124, 0.896_913_387_942_514_7),
            Complex::new(-0.26802875492832845, -1.6254385282619381),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut mat2 = fixtures::complex::matrix_mxn(6, 6);
    mat2[0] = Complex { re: 0.0, im: 0.0 };
    mat2[30] = Complex { re: 0.0, im: 0.0 };

    let a = mat2.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, -0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.745_455_787_584_854_9, 9.875_599_711_318_489E-2),
            Complex::new(-0.928_984_834_394_146, -0.19018934561877915),
            Complex::new(0.794_067_410_388_616_4, -1.5951187526018875),
            Complex::new(1.022_107_051_632_099, -2.7233636737611393),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.22735583281902055, 0.18780057023632762),
            Complex::new(-0.261_244_260_211_259_2, 0.724_106_982_265_696_9),
            Complex::new(-0.45228594812363454, -2.2680385476264697),
            Complex::new(-1.304_008_488_447_784, -1.3253714169424478),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.763_255_124_716_289_5, 0.795_461_934_615_075_7),
            Complex::new(-0.735_681_997_802_459_1, 0.34435907640969454),
            Complex::new(-1.3747179018729143, 1.0839642544183627),
            Complex::new(-1.4892507275872222, -1.1002656652229006),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.2462339501523765, -0.434_522_759_648_950_4),
            Complex::new(0.669_855_960_563_057_4, -0.409_638_849_075_303_9),
            Complex::new(-0.758_337_993_821_317_7, -1.9739152075580129),
            Complex::new(-0.352_178_715_012_702_5, 0.885_408_101_504_247_4),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.8401026154629083, 0.158_659_602_692_309_7),
            Complex::new(-0.11242079794698363, 0.946_505_564_969_239_3),
            Complex::new(0.538_813_400_350_457_7, 0.581_763_055_529_342),
            Complex::new(-1.6019671547082783, -1.4204888527818205),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let a = mat.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'n',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-0.724_683_462_451_151_8, 1.3115002827569882),
            Complex::new(0.47796290633027105, 0.962_074_234_516_534_5),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.17651376987269174, -0.833_410_448_333_776_5),
            Complex::new(0.191_145_170_617_229_9, -0.206_113_704_352_521_3),
            Complex::new(2.1988465083684905, -1.1276187450483688),
            Complex::new(1.3251943645016633, 0.600_840_171_251_673_3),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.1357211635016546, -0.550_602_555_782_600_4),
            Complex::new(-0.17390910356897638, 0.33118569648332224),
            Complex::new(-0.856_190_693_206_134_5, -2.437_290_705_201_685),
            Complex::new(-1.1270680619558762, -1.9092679197542792),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.786_567_638_263_470_1, 1.0282555521697014),
            Complex::new(-0.852_106_099_027_044_8, -0.318_160_431_047_603_3),
            Complex::new(-1.7009542344509263, 0.956_122_878_881_794_7),
            Complex::new(-1.4024342919909158, -0.896_917_779_486_577_7),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.9492069659996545, -0.618_175_586_480_556),
            Complex::new(0.593_612_588_663_637_4, 0.595_034_560_673_661_8),
            Complex::new(0.902_402_207_955_942, 0.370_975_303_540_222_1),
            Complex::new(1.316_573_421_579_174_4E-2, -0.467_462_900_208_074_7),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.5522010148990604, -5.065_203_308_423_735E-2),
            Complex::new(-0.704_348_208_838_602_8, 0.789_710_311_259_861_5),
            Complex::new(2.5455767640142994, 1.4239340453601215),
            Complex::new(-0.44625571973813855, -2.2045862330913715),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut mat2 = fixtures::complex::matrix_mxn(6, 6);
    mat2[0] = Complex { re: 0.0, im: 0.0 };
    mat2[1] = Complex { re: 0.0, im: 0.0 };
    let a = mat2.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-1.5855558497137823, -0.886_795_946_883_151_9),
            Complex::new(-0.16263993725816017, -0.596_137_558_710_675_2),
            Complex::new(-1.0223398005499513, 1.7784779276016929),
            Complex::new(2.6967577459040637, 0.37291596442254626),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-1.455_063_610_577_763, 3.9484377185545276),
            Complex::new(-1.4668178548226742, -2.353_666_907_806_492),
            Complex::new(0.331_187_192_058_818_1, -1.0349663957667417),
            Complex::new(1.1515637421064389, -1.6259125522497935),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.949_213_981_001_795_2, -1.3703864354141615),
            Complex::new(-1.013_091_064_401_005, 1.6811452270216223),
            Complex::new(-1.0662469530871845, 3.240_081_162_177_701),
            Complex::new(1.2091099992327403, 0.329_064_731_422_851_1),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.40639367076936217, -0.990_029_413_707_901_3),
            Complex::new(-0.20458752516298695, -0.250_987_934_021_063_6),
            Complex::new(0.824_653_625_819_205_2, -1.8718384058185786),
            Complex::new(-1.9466246653527595, -8.869_510_098_443_542E-2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.570_369_664_176_709_5, 0.452_363_203_383_692_1),
            Complex::new(0.254_535_483_805_041_5, -0.718_097_717_475_082_4),
            Complex::new(-0.632_458_313_976_584_9, -1.747_420_977_411_535),
            Complex::new(-0.29667373591331025, 0.709_152_916_246_794_6),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.3808390416288232, -0.26427329740880573),
            Complex::new(-0.369_366_743_348_091_3, -0.519_258_893_502_893_8),
            Complex::new(-0.25232593636761924, -0.415_520_681_402_205_2),
            Complex::new(-7.944_482_699_469_124E-2, -0.630_333_687_641_902_1),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1E-5
    );

    let a = mat.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'n',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-2.0011012320269455, -0.690_724_634_332_615_4),
            Complex::new(-0.25494255505989005, -1.072_402_238_912_369),
            Complex::new(-2.153_299_486_648_64, 2.7672477593951728),
            Complex::new(3.474_447_114_698_216, 0.20421980543002827),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.533_094_053_120_216_3, 3.0162712731075665),
            Complex::new(-0.34668784981129874, -2.3695912665402337),
            Complex::new(1.7359662900386923, -0.567_466_388_213_222_9),
            Complex::new(1.454_651_054_976_003, 1.698_291_292_763_019),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-2.3122909773224705, -2.108_789_561_433_089),
            Complex::new(-0.925_755_907_758_722_1, 1.2882239412392475),
            Complex::new(-1.4701516981696845, 3.0708290046024858),
            Complex::new(1.3860504257246484, -0.254_831_771_388_980_3),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.429_706_184_316_542_7, -0.757_235_796_153_275_6),
            Complex::new(-0.32101162638757264, -0.913_507_441_478_361_5),
            Complex::new(0.498_417_293_241_193_2, -1.9996797813551468),
            Complex::new(-1.859_808_229_756_453, 0.11465278475188753),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.13260335167056853, 0.26871037655208646),
            Complex::new(0.178_292_111_905_621_5, 0.28657569227388313),
            Complex::new(1.028_281_887_800_675, 0.597_469_533_686_699_7),
            Complex::new(6.867_071_331_518_397E-2, -0.643_718_085_465_527_7),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.092_937_441_064_975, -0.473_584_933_185_352_8),
            Complex::new(-0.40133057238654146, -0.361_122_404_949_700_8),
            Complex::new(-0.285_392_193_278_553_9, -0.296_965_737_595_643_6),
            Complex::new(-0.18212487372942077, -0.506_519_684_292_669_2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut mat2 = fixtures::complex::matrix_mxn(6, 6);
    mat2[0] = Complex { re: 0.0, im: 0.0 };
    mat2[6] = Complex { re: 0.0, im: 0.0 };
    let a = mat2.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        't',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.803_601_486_070_098_6, -1.2966782756548307),
            Complex::new(-0.728_405_200_318_936, 0.709_586_180_548_449_8),
            Complex::new(-0.425_602_350_609_060_7, 0.777_692_480_403_652_2),
            Complex::new(-0.276_785_851_450_944_9, 1.1468217123407773),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-1.473_860_987_903_791, 0.808_342_177_661_634_7),
            Complex::new(0.586_406_335_294_129_2, 0.966_828_991_671_473_5),
            Complex::new(1.0049561183225213, -0.266_697_715_688_227_5),
            Complex::new(0.798_683_027_587_797_5, -1.9049819683022284),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.425_602_350_609_060_8, 0.777_692_480_403_652_4),
            Complex::new(1.4776322015523173, 0.438_730_142_393_767_7),
            Complex::new(2.1769827423749217, -0.453_384_669_570_560_3),
            Complex::new(-0.557_531_759_243_819_6, -0.15683583700867554),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.361_984_079_285_778_1, 0.500_269_708_685_467_2),
            Complex::new(-7.625_773_636_122_174E-2, -0.358_685_501_785_461),
            Complex::new(-0.599_651_351_694_566_2, -0.336_183_128_489_061_8),
            Complex::new(0.24286860372209002, 0.784_336_877_129_962_1),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.207_933_810_820_682, -0.11352827495281692),
            Complex::new(-9.894_813_129_527_408E-2, -0.874_130_125_981_050_6),
            Complex::new(-0.892_787_176_402_598_3, -1.8856919508018803),
            Complex::new(-0.533_531_256_036_346_3, 0.40534044116477896),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.3808390416288232, -0.26427329740880573),
            Complex::new(-0.369_366_743_348_091_3, -0.519_258_893_502_893_8),
            Complex::new(-0.25232593636761924, -0.415_520_681_402_205_2),
            Complex::new(-7.944_482_699_469_124E-2, -0.630_333_687_641_902_1),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'c',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.884_132_257_802_803_9, 3.5365290312112156),
            Complex::new(0.230_491_356_041_389_7, -0.768_315_584_039_666_3),
            Complex::new(0.605_386_595_111_594_4, -0.33675159754694883),
            Complex::new(5.113_524_416_433_612_4E-2, 0.319_300_918_204_105_9),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(7.647_635_458_852_564E-2, -0.176_968_802_046_708),
            Complex::new(0.638_215_657_901_570_3, 2.552_862_631_606_281),
            Complex::new(1.2252455562261795, 1.6605643502742038),
            Complex::new(-2.088_198_247_319_015, 0.438_952_439_555_613_5),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.692_635_982_767_618_1, -1.224_595_307_714_575_2E-2),
            Complex::new(-0.765_335_277_891_760_6, 1.331_723_183_627_652),
            Complex::new(0.581_212_478_216_626, 2.324_849_912_866_504),
            Complex::new(0.38960418749372067, -0.532_694_419_177_950_7),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.546_405_403_374_326_5, 0.333_673_028_593_557_1),
            Complex::new(0.10830410679399463, -0.435_441_763_210_326_3),
            Complex::new(-0.776_810_089_113_826_1, -0.26053509884876885),
            Complex::new(0.21782701220686007, 0.871_308_048_827_440_1),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.1473127021466114, -0.641_782_353_965_574_5),
            Complex::new(-0.765_862_657_507_113_5, -0.680_181_382_057_774_3),
            Complex::new(-2.013_313_878_563_667, -0.29425112677260773),
            Complex::new(0.385_789_410_176_567_4, 0.338_106_269_092_490_5),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.1370958875071255, -0.826_782_787_208_413_3),
            Complex::new(-0.555_228_048_973_714_1, -0.312_703_378_949_232_4),
            Complex::new(-0.40516729696746967, -0.268_635_954_974_056),
            Complex::new(-0.340_138_731_768_687_4, -0.536_598_249_590_179_3),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let a = mat.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.0975822800182025, 4.390_329_120_072_81),
            Complex::new(0.12760523749832176, -0.467_049_380_518_647_3),
            Complex::new(-0.877_087_098_583_865_7, 1.6177219532921399),
            Complex::new(-1.4835904302906053, 0.296_707_715_958_023_6),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.38842123088837754, -1.4028694431728281),
            Complex::new(1.0890749734962946, 1.5273526653605487),
            Complex::new(2.2340921110675858, 0.576_964_239_546_858_6),
            Complex::new(1.061_483_141_535_889, 1.544_257_949_865_548),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.6555934364546592, -1.2271249663133155),
            Complex::new(-0.530_541_389_075_037_2, 1.0047883335719767),
            Complex::new(0.27638780759211024, 2.010_418_273_042_074),
            Complex::new(0.781_875_933_408_374_5, -0.999_990_811_075_100_5),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.406_547_460_061_376, 0.521_225_947_404_031_3),
            Complex::new(-0.332_653_043_161_524_8, -0.943_421_547_267_249_8),
            Complex::new(-1.122_299_346_286_868, -0.20213359911586032),
            Complex::new(0.396_959_675_639_490_3, 1.0009187930372172),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.48681643885820763, -0.339_054_575_268_751_4),
            Complex::new(-0.18902710702717307, 0.14591937433802404),
            Complex::new(0.756_575_441_926_839_8, 0.470_132_729_068_392_6),
            Complex::new(-0.187_592_984_849_344_2, -0.940_552_850_036_029_8),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.092_937_441_064_975, -0.473_584_933_185_352_8),
            Complex::new(-0.40133057238654146, -0.361_122_404_949_700_8),
            Complex::new(-0.285_392_193_278_553_9, -0.296_965_737_595_643_6),
            Complex::new(-0.18212487372942077, -0.506_519_684_292_669_2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        't',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, -0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.745_455_787_584_854_9, 9.875_599_711_318_489E-2),
            Complex::new(-0.753_244_514_299_147_5, -0.392_654_696_042_026_6),
            Complex::new(0.327_046_383_539_844_4, -0.822_021_960_118_922_3),
            Complex::new(1.2876119054703419, -2.1327513303616947),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.505_342_173_922_630_9, -0.21442243626824406),
            Complex::new(0.36368186249006157, -0.706_135_682_365_218_6),
            Complex::new(-2.7395031753961647, -0.25623058934581977),
            Complex::new(1.4742247368639692, 0.485_202_151_648_363_8),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.27069557709676256, -1.4408250671297336),
            Complex::new(0.801_040_149_312_749, -2.3429315095287957),
            Complex::new(1.2610128627274675, 0.557_277_873_697_403_3),
            Complex::new(5.7903235640717785, 3.931_203_121_716_571),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.6137084509525672, -3.324_143_570_530_387),
            Complex::new(-0.697_188_759_415_216_6, -0.411_421_643_768_265_5),
            Complex::new(-2.7676538957388477, -3.554_407_770_687_19),
            Complex::new(3.455_300_326_801_356, 1.2305711295775565),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(2.9159067910592666, 2.0230227013901896),
            Complex::new(-2.5937574716388743, 1.1974729524258667),
            Complex::new(-0.869_961_433_212_974_4, -0.286_932_081_450_236_5),
            Complex::new(-4.268_844_064_503_33, -1.574_711_562_684_186),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut mat2 = fixtures::complex::matrix_mxn(6, 6);
    mat2[0] = Complex { re: 0.0, im: 0.0 };
    mat2[29] = Complex { re: 0.0, im: 0.0 };
    let a = mat2.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        't',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-0.724_683_462_451_151_8, 1.3115002827569882),
            Complex::new(0.47796290633027105, 0.962_074_234_516_534_5),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.17651376987269174, -0.833_410_448_333_776_5),
            Complex::new(0.366_885_490_712_228_5, -0.408_579_054_775_768_7),
            Complex::new(1.7318254815197185, -0.354_521_952_565_403_4),
            Complex::new(1.590_699_218_339_906, 1.1914525146511177),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.8684191702433062, -0.952_825_562_287_172_1),
            Complex::new(0.451_017_019_132_344_4, -1.0990569681475932),
            Complex::new(-3.1434079204786647, -0.42548274692103505),
            Complex::new(1.6511651633558773, -9.869_435_116_346_748E-2),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.247_383_063_549_582, -1.2080314495751079),
            Complex::new(0.684_616_048_088_163_3, -3.0054510169860937),
            Complex::new(0.934_776_530_149_455_5, 0.429_436_498_160_835_2),
            Complex::new(5.877_139_999_668_085, 4.1345510074528935),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.910_735_435_105_289_4, -3.507_796_397_361_992),
            Complex::new(-0.773_432_131_314_636_6, 0.593_251_765_980_7),
            Complex::new(-1.106_913_693_961_588, -1.2095172595889556),
            Complex::new(3.820_644_776_029_85, -0.12229987213476567),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(2.6482619617292493, 1.8847858699956568),
            Complex::new(-2.5337710479612436, 1.310_345_426_849_501),
            Complex::new(-0.783_479_969_390_811_2, -0.43509003877870955),
            Complex::new(-4.508_923_004_277_573, -1.4129562619614073),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-0.724_683_462_451_151_8, 1.3115002827569882),
            Complex::new(0.47796290633027105, 0.962_074_234_516_534_5),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.17651376987269174, -0.833_410_448_333_776_5),
            Complex::new(0.664_872_494_532_362_7, -0.16945725049517865),
            Complex::new(0.605_212_385_693_036_8, -0.977_044_028_893_290_5),
            Complex::new(0.764_252_250_684_471_4, 1.6020351707669773),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(7.604_499_033_753_12E-2, -0.540_994_033_113_682_5),
            Complex::new(0.530_262_470_410_028_3, -0.372_960_427_186_091),
            Complex::new(0.659_783_778_418_275_5, 3.544_002_156_346_734),
            Complex::new(4.276_441_304_457_035E-2, 1.8285965014649763),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(2.095_112_747_306_29, -1.5062738982448116),
            Complex::new(1.9442693783645022, -1.4635635455859775),
            Complex::new(0.849_360_801_517_736_7, 1.8055481545990144),
            Complex::new(1.9988175236763277, 7.408_350_185_184_567),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.6545957269940992, 1.9979637069394474),
            Complex::new(2.0930886407551093, -1.0842007024239364),
            Complex::new(3.587_342_534_059_919, 3.185_961_866_409_178),
            Complex::new(-1.311_523_951_320_859, 2.2479205698486275),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.0631408799427013, 0.383_735_084_065_348),
            Complex::new(-1.0368134258781332, -1.3392003038132692),
            Complex::new(0.574_041_301_965_986_9, -3.575_557_760_689_099),
            Complex::new(0.49453806642375003, -4.145_033_964_179_725),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, -0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.641_411_355_349_595, 0.39249019279234365),
            Complex::new(0.21401317893763838, 0.856_052_715_750_553_5),
            Complex::new(-0.403_634_169_148_369_6, 0.10655608183405463),
            Complex::new(-2.3854291381704322, 0.49672966045704314),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(1.0390024440245722, 0.673_884_980_122_487_2),
            Complex::new(0.295_468_581_593_304_8, -4.602_557_713_041_588_4E-2),
            Complex::new(0.964_608_449_042_791_3, 3.8584337961711643),
            Complex::new(-0.349_507_332_870_083_3, 2.2958928933621263),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(1.9552548039933393, -1.6938268170552857),
            Complex::new(2.3852265283200214, -0.955_583_761_529_053_9),
            Complex::new(1.1948500586907784, 1.7471466548661059),
            Complex::new(1.8196848602436977, 7.278_739_440_974_79),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.994_099_463_705_695_5, 1.6952359282426244),
            Complex::new(1.5162530902751685, -1.9103014588197347),
            Complex::new(0.817_453_213_569_412_4, 2.4215780105681777),
            Complex::new(-0.738_141_556_294_947_4, 3.5265796889771472),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.1072993263848516, 3.053_723_004_228_753_3E-2),
            Complex::new(-1.190_710_902_465_306, -1.2907812778128007),
            Complex::new(0.45426619827707126, -3.547_227_978_067_511),
            Complex::new(0.336_524_208_384_483_3, -4.175_112_529_477_235),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416)
        ]
    );

    let a = mat.clone();

    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-3.810_737_428_024_957_3E-3, -0.832_043_290_138_244_6),
            Complex::new(-0.971_459_906_077_097_2, -0.999_380_447_362_611_3),
            Complex::new(2.109_527_302_022_176, -0.427_933_473_614_738),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.614_097_385_589_588_6, -0.24858058290286267),
            Complex::new(-0.282_817_418_825_202_5, -0.733_532_432_841_927_9),
            Complex::new(4.363_468_289_039_612, 0.26613736152648926),
            Complex::new(2.1638677380218803, 0.48751141899630657),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-1.1558772903269556, -2.907_860_217_690_086),
            Complex::new(-1.1499955134459103, -2.7178355651022663),
            Complex::new(2.3739862645994934, -0.46820441992672013),
            Complex::new(9.303_593_468_546_417, -0.17262350022792816),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.8638997077444621, 2.534_219_554_859_493),
            Complex::new(-0.659_915_922_207_850_3, -2.7813397425090356),
            Complex::new(4.803_291_104_806_746, -3.2833553245537517),
            Complex::new(2.2588700628324627, 2.2041224304301528),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.848_380_050_474_495_8, -1.1072937862687229),
            Complex::new(-1.8596191095034653, 0.703_376_109_192_503_9),
            Complex::new(-4.214_853_895_438_528, -2.033_972_529_047_965),
            Complex::new(-4.791_403_977_336_39, -1.638_956_288_436_48),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(5.487_911_318_314_761, 0.0000000000000000),
            Complex::new(-0.511_938_899_599_83, -0.287_491_269_396_027),
            Complex::new(1.6452354797736968, 1.5076677268362355),
            Complex::new(-8.728_222_412_836_728E-2, 1.8326674541971397),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-1.7646761512277145, 4.435_749_356_863_416_5E-2),
            Complex::new(2.117_201_625_786_087, -0.832_043_290_138_244_6),
            Complex::new(1.3358673534043253, -2.458_648_258_870_193),
            Complex::new(2.128_974_950_922_295, -0.794_610_169_417_623_5),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.930_615_648_204_503, 1.5868378526793676),
            Complex::new(1.0260623215377946, 0.919_692_306_846_141_8),
            Complex::new(2.4464884634740116, 0.26613736152648926),
            Complex::new(-0.946_496_253_805_526_5, -1.2139689656482757),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.49363420721920326, 0.631_592_869_308_984_5),
            Complex::new(-1.2077468150121478, 0.113_879_594_002_723_3),
            Complex::new(-0.567_892_268_817_248_4, 1.2609010947498187),
            Complex::new(1.2943043477099385, -0.17262350022792816),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.255_706_426_253_441_4, -0.672_447_146_068_457_3),
            Complex::new(0.116_073_642_483_580_6, 0.265_302_290_883_957_3),
            Complex::new(0.775_619_505_560_136_5, -0.751_814_411_926_200_1),
            Complex::new(-1.1617071547461155, -5.593_556_111_904_019E-2),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        't',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.37066642795896637, -0.129_375_369_917_894_4),
            Complex::new(-0.291_636_505_163_317_5, -0.548_154_994_468_764_7),
            Complex::new(-0.559_559_826_238_853_6, 3.733_609_056_763_076_4E-2),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.0546992161128539, 0.30769421901217936),
            Complex::new(8.239_866_625_451_397E-3, 1.4010951255374888),
            Complex::new(0.11753648309305995, 1.321_712_156_903_747),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(0.22381768062330257, 1.0818360809917658),
            Complex::new(1.6850995150621415, 0.15300599796037123),
            Complex::new(-0.32629307536500785, -0.221_905_355_706_220_7),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.619_031_156_075_193_8, 0.276_688_149_818_316),
            Complex::new(-0.339_130_674_850_027_2, -3.141_533_199_081_17E-2),
            Complex::new(1.1469169235729075, 0.934_244_027_581_504_9),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(0.589_980_152_449_654_2, -9.833_080_429_684_937E-2),
            Complex::new(-9.108_838_886_948_28E-2, -0.36462661872837543),
            Complex::new(-1.1191619149239813, -0.203_329_135_991_579_3),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.4114865153211158, 0.38524537384662705),
            Complex::new(-0.661_768_738_345_098_4, 1.661_556_640_056_547),
            Complex::new(1.1286101466529936, -0.18935841879185145),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1E-5
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        'c',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.206_587_418_125_671_6, 0.33384611099939526),
            Complex::new(0.564_157_728_136_112_4, -3.586_414_574_423_77E-2),
            Complex::new(0.556_396_693_716_659_3, 0.959_152_124_359_483_4),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(0.36928125955106716, 1.4771250382042687),
            Complex::new(-1.3224202310964879, 0.887_061_043_857_780_8),
            Complex::new(-0.876_974_457_031_113_3, 0.34538926500849226),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(1.3655580312964728, 0.47749750643288325),
            Complex::new(0.461_048_841_911_694_5, 1.844_195_367_646_778),
            Complex::new(-0.472_880_220_333_041_9, 3.071_017_300_651_561_5E-2),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.639_520_795_004_036_7, -0.349_527_148_201_999_8),
            Complex::new(0.620_315_963_623_690_2, -0.16585541403550869),
            Complex::new(0.47833016477305745, 1.9133206590922298),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.10038099205145037, -0.18624235722792018),
            Complex::new(0.132_312_955_627_360_9, -0.334_374_671_139_533_4),
            Complex::new(0.11867863234141812, -1.505_597_629_659_602),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.38168423312950805, 0.707_125_665_563_798_6),
            Complex::new(-1.4437390741996847, -0.18775508138812175),
            Complex::new(0.807_605_425_321_079_2, 0.421_381_138_842_694_7),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-0.726_401_199_805_562_8, 1.4751914913261448),
            Complex::new(1.0200550955487424, 1.4756360886047346),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.17651376987269174, -0.833_410_448_333_776_5),
            Complex::new(0.820_140_575_145_791_5, 0.45161507195853645),
            Complex::new(-4.809_642_160_192_332E-2, 0.826_009_022_816_525_6),
            Complex::new(0.24849869396138569, 1.1802423586533526),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.895_169_104_563_729_3, -0.751_716_219_659_391_2),
            Complex::new(1.2955602277309608, 1.566_568_311_812_105_4E-2),
            Complex::new(0.156_224_171_287_178_7, 1.5297637278223477),
            Complex::new(-0.40632720262437055, -0.25897882906927494),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.131_038_643_882_254_4, 0.337_571_158_074_902_8),
            Complex::new(-0.722_145_733_170_929_1, -1.1941277724081236),
            Complex::new(-6.570_197_272_460_604E-2, -0.381_874_315_977_905_9),
            Complex::new(0.657_462_828_205_687_6, 2.0429314033020063),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.298_404_467_827_148_2, 2.606_035_807_818_707_4E-2),
            Complex::new(0.374_846_826_448_820_9, 0.24136575091516732),
            Complex::new(1.2110243796907718, 0.807_788_918_400_127_9),
            Complex::new(-9.087_595_054_649_289E-3, -1.8563133620805055),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.092_937_441_064_975, -0.473_584_933_185_352_8),
            Complex::new(-1.2017646027949078, 0.573_497_516_016_715_3),
            Complex::new(-1.7354912455895453, -0.649_530_979_596_544_9),
            Complex::new(0.606_776_487_620_899_2, 0.13745881812890565),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.057_956_775_224_783, 4.231_827_100_899_132),
            Complex::new(-1.1232566087643057, 1.6229204428910589),
            Complex::new(-1.2837863590779532, 1.0956462503362694),
            Complex::new(0.47796290633027105, 0.962_074_234_516_534_5),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(2.3150280007745794, 0.636_858_607_916_037_5),
            Complex::new(2.2624427795069453, 6.2208238894031505),
            Complex::new(-0.260_996_224_258_192_5, -0.43956352857782066),
            Complex::new(1.3334031780571216, 1.7106045501024205),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.0180848632672184, -0.971_441_750_271_147_8),
            Complex::new(1.3005417206512548, -1.3335192952681145),
            Complex::new(-0.21050369340669117, 6.285_226_904_686_823E-2),
            Complex::new(0.21906001894265437, -0.40454921133144506),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(9.146_609_030_142_949E-2, 1.4457155942587572),
            Complex::new(-0.15080443493975754, -0.698_413_995_117_289_9),
            Complex::new(-0.728_065_070_982_454, -8.534_489_636_770_187E-2),
            Complex::new(0.213_577_935_301_928_7, 0.267_391_831_686_971),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.7288259843431792, -1.098_984_959_500_548),
            Complex::new(-0.18565033215892085, 9.452_060_919_265_666E-2),
            Complex::new(1.2053632224825974, 0.900_334_914_214_737_4),
            Complex::new(-4.553_051_062_718_794E-2, -0.575_928_154_229_047_1),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.541_476_783_549_771_8, -1.2650404084853966),
            Complex::new(4.854_225_965_893_866E-2, -2.1044146714297556),
            Complex::new(-1.963_849_041_989_299_7E-2, -0.15713434073977314),
            Complex::new(-0.18212487372942077, -0.506_519_684_292_669_2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        't',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-1.950_598_952_386_057, 1.930_913_909_111_932),
            Complex::new(3.3379829105481416, 2.512_597_566_221_801),
            Complex::new(3.352_609_237_197_235E-2, -1.161_239_935_386_631),
            Complex::new(0.34645774818088576, 0.28057501053159395),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(3.3379829105481416, 2.512_597_566_221_801),
            Complex::new(4.232_801_856_709_317, 1.220_296_567_181_304),
            Complex::new(-0.119_898_259_128_526_3, -0.886_969_857_265_430_3),
            Complex::new(0.798_511_116_953_622_9, 0.415_398_008_835_032_7),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.125_907_428_493_489_6, -1.1241088862647408),
            Complex::new(-0.386_940_059_097_815_5, -0.908_470_913_017_165_3),
            Complex::new(-0.11138852965241561, 6.706_341_408_484_115E-2),
            Complex::new(1.283_759_948_501_932_1E-2, -0.19049002371540902),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.559_559_826_238_853_6, 3.733_609_056_763_076_4E-2),
            Complex::new(8.636_784_053_193_675E-2, 1.6945018096253788),
            Complex::new(0.189_089_976_884_744_2, -0.317_371_420_090_933_8),
            Complex::new(0.12676149970562242, 6.404_394_595_064_807E-2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.364_359_420_155_388_3, 1.207_779_783_650_871),
            Complex::new(0.366_145_465_125_023_1, -2.6807521256975955),
            Complex::new(-0.669_460_956_544_617_9, 0.308_606_803_630_267_5),
            Complex::new(-0.116_601_750_956_776_8, -0.209_493_149_584_883_3),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.409_195_245_395_669_2, -1.0517548546196733),
            Complex::new(-1.504_664_531_743_181, -0.24893633540388876),
            Complex::new(4.856_634_512_766_730_4E-2, 0.289_948_379_601_331_4),
            Complex::new(-0.15617033770313232, -0.159_719_297_215_396_1),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.057_956_775_224_783, 4.231_827_100_899_132),
            Complex::new(-1.1950330007958705, 2.3036558641742535),
            Complex::new(6.772_568_863_721_809E-3, -0.415_409_386_734_113_3),
            Complex::new(1.430_450_449_818_816_7E-2, 0.44559027027128345),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(2.1385142309018876, 1.4702690562498142),
            Complex::new(1.8115834639122208, 7.246_333_855_648_883),
            Complex::new(-1.5353200337527573, -0.37851150753656526),
            Complex::new(0.20793002706462263, 0.875_751_456_457_56),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.12291575870348909, -0.21972553061175656),
            Complex::new(1.370_539_524_216_767, -0.871_687_471_953_352_3),
            Complex::new(9.432_097_721_782_46E-2, 0.377_283_908_871_298_4),
            Complex::new(0.15250700123398303, -0.11486020925565452),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-3.957_255_358_082_49E-2, 1.1081444361838544),
            Complex::new(1.2108620932352083, 0.146_186_629_088_834),
            Complex::new(-4.204_713_463_415_764E-2, 0.130_674_005_574_695_3),
            Complex::new(3.444_527_186_929_847E-2, 0.137_781_087_477_193_9),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(2.0272304521703273, -1.125_045_317_578_735),
            Complex::new(-0.660_878_150_659_192_1, -0.333_087_498_950_430_9),
            Complex::new(0.12665179841918656, -0.24182867532492397),
            Complex::new(8.223_571_676_887_953E-2, -0.22521242180814338),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.551_460_657_515_203_2, -0.791_455_475_300_043_8),
            Complex::new(0.868_622_629_324_338_4, -1.9707865218826723),
            Complex::new(0.272_113_680_969_967_4, 0.30464155746865007),
            Complex::new(1.870_406_397_075_905E-2, -0.22259736357888021),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'n',
        4,
        0,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(b, a);

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'n',
        0,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(b, a);

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'x',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'x',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'u',
            'x',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'u',
            'n',
            'x',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            3,
            &mut [],
            4,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn trsm() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'l',
        'u',
        'n',
        'n',
        0,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(b, a);

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'l',
        'u',
        'n',
        'n',
        4,
        0,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(b, a);

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'l',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'l',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.6),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-4.3361652432024105, 5.081_759_126_233_314_4E-2),
            Complex::new(-2.024_963_540_471_475, 1.7462050727369067),
            Complex::new(0.771_580_033_844_792_1, -3.8415480814979444),
            Complex::new(0.21570408905600796, 1.9735891392210492),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-8.213_949_589_439_304, 4.867_725_213_852_041),
            Complex::new(-2.0039016266034926, 1.984_559_347_536_711),
            Complex::new(-6.445_415_220_668_626, -5.277_174_225_574_73),
            Complex::new(1.2223454650802608, 3.817_424_584_280_682),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(1.3857920232502359, 1.165_734_272_585_086),
            Complex::new(0.545_291_052_748_864_9, 0.447_167_836_113_119_4),
            Complex::new(-0.282_288_047_195_770_9, 1.9103995406836893),
            Complex::new(0.637_919_324_760_913_8, -0.562_081_674_917_294_3),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.20000000298023224, 0.600_000_023_841_857_9),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.46993546772940703, 0.782_970_177_995_566_7),
            Complex::new(1.2442533187414169, 0.707_486_917_394_968_2),
            Complex::new(-0.302_354_395_892_263, -0.451_353_629_873_700_5),
            Complex::new(0.288_215_753_913_977, -1.0280578753313314),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(3.064_478_695_314_436, -1.0535611790318242),
            Complex::new(1.002_240_610_044_433, -0.637_711_568_837_873_2),
            Complex::new(0.857_922_953_904_762_1, 2.2260221537764036),
            Complex::new(7.020_681_996_416_641E-3, -0.994_747_606_611_603_9),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1E-5
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let mut b = mat.clone();
    complex::trsm(
        'l',
        'u',
        'n',
        'u',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(3.1357042123101007, -0.485_934_086_124_513_6),
            Complex::new(1.507_680_290_334_58, -0.652_993_237_077_658),
            Complex::new(1.4424603689891793, 0.38898484777779974),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-1.090_324_174_114_432E-2, -5.056_508_814_714_697),
            Complex::new(3.035_802_076_100_236, -3.617_917_806_754_939),
            Complex::new(-0.125_274_897_240_611_7, -2.892_209_042_048_24),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-2.115_982_969_734_27, 0.899_552_893_436_918_8),
            Complex::new(-1.1728210756763398, -0.606_295_269_053_978_3),
            Complex::new(-0.624_397_698_340_258_6, 0.436_068_838_980_655_3),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.602_594_313_730_431_3, 0.19430198654291148),
            Complex::new(-0.963_689_744_916_562_2, -1.367_872_175_164_573E-2),
            Complex::new(-0.246_353_477_130_307_3, 0.34620704036331307),
            Complex::new(0.377_395_659_685_134_9, -0.17262350022792816),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.752_961_061_153_553_8, -0.913_339_515_929_533_3),
            Complex::new(-9.108_691_546_292_846E-3, 5.762_437_668_135_217_4E-2),
            Complex::new(0.859_202_427_449_865_5, -0.539_447_479_544_310_5),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-1.8493189366425806, -0.38904525818272895),
            Complex::new(-1.6372872292772385, 0.679_129_946_854_835),
            Complex::new(-0.538_601_983_667_904_8, 0.664_586_170_987_184),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        'n',
        'n',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.582_067_040_822_753_3, -0.18591136302847366),
            Complex::new(0.288_060_212_708_560_8, -6.148_053_974_330_412),
            Complex::new(7.127_305_352_015_685, -1.0683377591471988),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.628_808_874_421_711_3, 0.13547227203129142),
            Complex::new(1.3408230860318302, -0.19575665942292952),
            Complex::new(-0.651_756_022_354_603, -3.904_975_070_980_08),
            Complex::new(4.336_982_712_532_332, -1.637_332_513_329_91),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.24188009916959066, 0.848_828_030_454_601_4),
            Complex::new(0.335_233_390_682_461_1, -0.762_164_145_123_173_2),
            Complex::new(-3.9585769323813955, -2.9313047246339132),
            Complex::new(0.15295088136724475, -5.313_919_271_835_162),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.192_212_909_481_588_7, -0.19445162886640396),
            Complex::new(0.12525595232395595, -1.2672383707009358),
            Complex::new(-0.12450969245726197, -2.7096060848420587),
            Complex::new(2.681_214_815_523_084, 6.916_195_711_469_306),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.11002148798912938, 0.197_608_050_553_353),
            Complex::new(-0.279_474_953_420_597_4, 0.447_402_731_159_042_3),
            Complex::new(-3.9928312766723866, 2.0068294154442317),
            Complex::new(-4.3769158322166435, -8.330_845_120_068_528),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.663_560_960_900_015_6, -0.607_100_006_357_926_2),
            Complex::new(0.31367418621923127, -0.488_148_165_113_478_8),
            Complex::new(3.2173115764366944, -4.626_387_763_296_591),
            Complex::new(5.533_634_218_850_874, 6.422_672_770_651_083),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        'n',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(5.163_986_980_915_069_6E-2, -0.377_873_227_000_236_5),
            Complex::new(0.48686117026629383, 1.342_114_007_208_785),
            Complex::new(0.749_140_636_442_017, 2.195_918_969_671_747),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.237_891_539_931_297_3, -0.690_675_511_956_214_9),
            Complex::new(0.48770744682920997, -0.890_880_788_636_406_5),
            Complex::new(1.0835713226638233, 1.1906803067326432),
            Complex::new(2.0046754793261115, 5.042_031_042_642_139),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.989_852_070_808_410_6, -0.157_804_965_972_900_4),
            Complex::new(-0.28620991205186996, -0.735_030_807_549_549_1),
            Complex::new(1.6940324753771179, 1.0809248721181137),
            Complex::new(3.0475979083799656, 2.075_647_997_907_891),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.24528039246797562, 0.19040291756391525),
            Complex::new(-0.745_601_790_641_230_7, -0.326_231_643_180_627_6),
            Complex::new(-0.135_380_341_924_780_7, -1.2316202153710734),
            Complex::new(2.458_506_671_716_3, -0.639_225_481_851_245_4),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.207_917_829_975_485_8, 0.15081105567514896),
            Complex::new(0.12472167807203721, 0.20617742099636954),
            Complex::new(1.2366470065183444, 0.27616290202981536),
            Complex::new(-0.179_882_832_476_089_5, -0.436_757_720_682_997_9),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.594_695_933_163_166, -0.830_402_486_026_287_1),
            Complex::new(9.626_368_375_258_099E-2, -0.10394887225038407),
            Complex::new(-2.0381596972484126, 0.38710425384444547),
            Complex::new(-1.9873804651826856, 0.674_718_818_503_325_6),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1E-5
    );
    let mut b = mat.clone();
    complex::trsm(
        'l',
        'u',
        't',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.383_989_201_925_613_4, 0.19807783889713979),
            Complex::new(2.162_351_836_664_104, -2.8514495652032292),
            Complex::new(1.3835248630505073, -2.8932506519951993),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.382_140_573_226_501_4, -0.246_668_301_195_21),
            Complex::new(1.0213420938507443, 0.39242684666128896),
            Complex::new(-0.607_973_408_458_885_5, 0.14612637589888017),
            Complex::new(5.682_520_116_869_478, 6.295_187_893_888_837),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.545_354_064_812_096, 0.30347396564250545),
            Complex::new(0.49397370175638877, -0.636_130_680_052_432_3),
            Complex::new(1.8719258117215858, -0.720_134_201_433_102_9),
            Complex::new(4.173_506_726_998_538, -5.472_812_198_120_743),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.19333226917399632, -1.119_359_692_407_636E-3),
            Complex::new(0.648_104_802_113_337_9, -0.44805523663770835),
            Complex::new(-7.924_790_268_451_602E-2, -0.245_877_838_769_299_1),
            Complex::new(2.1687405694259594, -0.622_403_706_470_124_4),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-4.379_328_128_211_181E-2, 0.153_814_769_271_241_2),
            Complex::new(-0.449_955_443_895_802, 1.731_376_998_131_828E-2),
            Complex::new(-1.4727853010824283, -1.939_112_951_397_837),
            Complex::new(-5.305_433_820_692_167, -2.0641789602449854),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-2.823_047_727_104_473_2E-2, -0.635_330_483_628_970_8),
            Complex::new(0.811_108_599_344_163_4, 5.539_272_198_694_474E-2),
            Complex::new(0.276_315_898_483_861_9, 2.2432587748416113),
            Complex::new(4.5434806476144285, 2.5580388858223335),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(5.163_986_980_915_069_6E-2, -0.377_873_227_000_236_5),
            Complex::new(-2.520_608_828_913_673E-2, 1.1629327100576257),
            Complex::new(0.20968760493191496, 0.287_051_109_734_724_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.237_891_539_931_297_3, -0.690_675_511_956_214_9),
            Complex::new(-0.26496362306923205, -1.0970069132074767),
            Complex::new(0.555_980_414_150_565_1, -1.8340719617223418),
            Complex::new(3.005_960_109_467_992, -0.507_956_854_853_265_7),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.989_852_070_808_410_6, -0.157_804_965_972_900_4),
            Complex::new(-1.0216620259901958, 4.326_152_490_837_742_4E-2),
            Complex::new(-1.573_283_085_747_525, -0.776_472_765_353_649_2),
            Complex::new(-0.742_757_306_513_018_2, -1.6198648887095417),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.24528039246797562, 0.19040291756391525),
            Complex::new(-0.429_869_209_545_263_2, -0.427_955_721_680_398_2),
            Complex::new(-0.519_899_243_517_987_4, 0.593_434_647_352_705),
            Complex::new(-0.729_820_114_916_472_9, -0.819_505_257_040_731_2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.207_917_829_975_485_8, 0.15081105567514896),
            Complex::new(0.13254591571963054, 0.48046129330801096),
            Complex::new(0.796_698_606_425_008_6, 0.18158566971985768),
            Complex::new(-7.844_456_780_919_27E-2, 0.703_336_487_152_064_9),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.594_695_933_163_166, -0.830_402_486_026_287_1),
            Complex::new(-0.278_192_596_978_023, -1.1288267484212382),
            Complex::new(0.695_438_691_863_195, -0.814_161_884_418_630_2),
            Complex::new(-6.464_253_903_011_574E-2, -1.1821286829537094),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-4.330_736_306_009_641, -2.794_634_541_191_048),
            Complex::new(0.11353332791702542, -3.0358071189164932),
            Complex::new(0.552_082_361_833_827_3, 1.196_104_875_318_058),
            Complex::new(0.775_887_817_144_393_9, 0.496_541_529_893_875_1),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-7.0311438643010415, 1.1171425552589795),
            Complex::new(-4.306_233_694_698_217, -5.832_125_141_798_423),
            Complex::new(1.5466374403877694, -0.964_274_636_170_998_2),
            Complex::new(1.7351219654083252, 0.669_531_345_367_431_6),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(4.162_276_539_809_118E-2, 0.695_219_047_729_879),
            Complex::new(-0.612_539_003_154_415_5, 1.2181547686081091),
            Complex::new(-0.438_299_286_297_573, -0.17216192477108372),
            Complex::new(-1.740_404_963_493_347E-2, -0.39410677552223206),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.565_492_844_120_515_5, -0.27538989181529694),
            Complex::new(-1.1394971980570936, -0.717_756_984_602_539_6),
            Complex::new(-0.269_517_046_580_196_6, 0.13552381773097144),
            Complex::new(0.275_009_579_956_531_5, 0.10238607972860336),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.502_870_918_380_294_6, 1.6264350851089353),
            Complex::new(0.540_622_409_161_350_3, 0.656_141_640_172_799_7),
            Complex::new(0.742_915_518_909_305_7, 1.488_719_097_766_289E-2),
            Complex::new(-0.287_564_262_747_764_6, -0.403_389_587_998_390_2),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(2.5860416002659656, -0.44334652705500277),
            Complex::new(-7.565_571_628_501_688E-4, 1.691_837_780_592_77),
            Complex::new(-0.597_958_944_625_102_1, -7.802_176_116_766_835E-2),
            Complex::new(-0.357_379_909_604_787_8, -0.292_091_730_982_065_2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(3.2114827761694884, -1.2846095423412685),
            Complex::new(1.5503648408551474, 4.408_059_033_237_275),
            Complex::new(-2.960_097_678_057_768, 0.681_647_140_719_452_9),
            Complex::new(2.197_871_676_371_508, 0.310_383_082_212_789_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-3.7806964953253734, -11.234685472902157),
            Complex::new(-4.062_404_893_128_853, 2.764_760_095_193_604),
            Complex::new(-0.371_320_493_621_041_8, 8.295_000_447_125_695),
            Complex::new(4.473_208_151_889_627, -0.27199439215993904),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-2.4119174862654607, 1.722_588_654_334_008),
            Complex::new(0.514_990_449_254_409_2, 0.961_232_979_373_762_2),
            Complex::new(1.789_330_239_840_485, -0.917_859_555_653_42),
            Complex::new(-0.433_152_655_853_949, -0.846_152_942_516_944_2),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.784_230_060_774_637, 1.067_016_204_063_416),
            Complex::new(-0.754_906_104_868_268_4, 3.3772776763820724),
            Complex::new(0.429_569_050_168_455_2, -8.201_207_090_518_887E-2),
            Complex::new(0.705_244_351_535_948, -5.128_747_046_443_521E-2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.9108710108976654, -0.959_940_658_447_139_3),
            Complex::new(3.3809090757975113, -4.0033212630382105),
            Complex::new(-1.0378465905588075, 0.19755007267142216),
            Complex::new(-1.034_452_743_518_24, -0.595_710_970_230_704_2),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.220_051_860_875_598_5, 2.9083748042948385),
            Complex::new(0.298_618_455_762_968_6, 0.26813155878356687),
            Complex::new(1.3335283313160229, -1.8440141707310576),
            Complex::new(-1.0758836637869365, -0.281_849_895_120_313_4),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        't',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-7.807_633_783_615_728, 4.099_320_675_368_019),
            Complex::new(-1.829_547_951_806_213, -0.24446324023732294),
            Complex::new(4.459_795_026_643_142, -4.404_487_237_094_364),
            Complex::new(1.2024986277707916, 1.8657370162296123),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-4.669_714_359_315_95, 4.069_219_559_398_201),
            Complex::new(4.858_233_271_204_267, -4.555_859_286_119_495),
            Complex::new(1.9409323685427113, -4.666_080_446_999_515),
            Complex::new(3.1310576644680514, 3.206_251_708_970_17),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.30582815236225375, 0.586_381_907_766_185_2),
            Complex::new(-1.391_000_158_244_759, -0.622_267_721_854_875_1),
            Complex::new(-0.771_902_594_911_180_1, 0.131_101_993_451_934_3),
            Complex::new(0.356_878_467_443_238_5, -0.881_041_307_135_356_9),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-2.2249105593392784, -0.424_110_144_485_764),
            Complex::new(-0.17300353837081367, -2.421_979_221_888_575),
            Complex::new(1.7345530403869818, -0.432_682_369_268_255_2),
            Complex::new(0.5, 0.5),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(4.052_616_446_265_329, 3.8090707449523515),
            Complex::new(-0.17682746073495273, 4.251_385_393_867_152),
            Complex::new(-3.3623697809536544, -1.3367942438768332),
            Complex::new(-0.22581318407280718, -1.1721657069393052),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(1.6810227004728377, -2.2963693741212503),
            Complex::new(-0.871_683_636_278_097_2, -0.352_497_055_507_330_2),
            Complex::new(-0.830_902_245_783_313_3, 1.5601685284262006),
            Complex::new(-0.490_353_110_479_909_4, -0.998_257_906_768_391_9),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[6] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.0000000000000000, 0.0000000000000000),
            Complex::new(-0.324_940_723_896_398_3, -8.481_683_799_189_943E-2),
            Complex::new(1.1274062950571064, 9.480_650_752_627_551E-2),
            Complex::new(0.515_563_832_739_756_4, -0.626_205_030_579_942_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.834_753_773_047_727_7, -0.820_327_571_620_824_9),
            Complex::new(1.0000000000000000, 0.0000000000000000),
            Complex::new(1.2479358164593708, 0.43510358886114614),
            Complex::new(0.22834580111255753, 2.9709409537969433),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.877_968_578_147_477_2, -0.621_527_450_976_367_2),
            Complex::new(1.1146758180687049, 0.41318613334001636),
            Complex::new(-2.7473118247562103, -1.9306755011161216),
            Complex::new(0.756_402_731_227_859_4, 2.7196786275350715),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(1.3630350271734757, -1.5508708531377995),
            Complex::new(2.0066569270578576, -0.611_980_947_926_144_7),
            Complex::new(-4.057_762_713_186_61, 3.789_543_673_652_328),
            Complex::new(2.814_641_968_867_289, 11.595788905412597),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.0215582491333848, 1.1481598504011052),
            Complex::new(-7.776_986_828_867_771E-2, -0.356_381_240_946_326_2),
            Complex::new(-1.210_288_708_142_689, 0.677_980_515_941_314),
            Complex::new(0.613_364_941_612_182_9, -3.7104175813872953),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.46341499618686954, -2.458_852_063_982_195),
            Complex::new(1.4497081868206336, -1.060_825_056_760_335),
            Complex::new(-1.4813720986519567, 3.594_591_357_532_341),
            Complex::new(6.281_720_641_928_58, 10.059758391332867),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1E-5
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        'n',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.13539692759513855, 1.1275573074817657),
            Complex::new(5.163_986_980_915_069_6E-2, -0.377_873_227_000_236_5),
            Complex::new(4.574_757_814_407_348_6E-2, 1.2840517163276672),
            Complex::new(0.775_887_817_144_393_9, 0.496_541_529_893_875_1),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.237_891_539_931_297_3, -0.690_675_511_956_214_9),
            Complex::new(0.26866142451763153, -0.563_381_865_620_613_1),
            Complex::new(0.580_401_685_787_364_8, -0.586_168_858_455_494),
            Complex::new(1.7351219654083252, 0.669_531_345_367_431_6),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.191_867_855_326_224_3, 0.769_583_892_126_507_7),
            Complex::new(-8.036_989_054_535_315E-2, -0.837_033_765_022_114_9),
            Complex::new(1.1394747963304193, 1.3813165626456412),
            Complex::new(1.6362424742181005, 0.11842399616672594),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.17606616332521496, -1.034_683_803_530_041),
            Complex::new(-1.0895629141983747, -1.2286733396003198),
            Complex::new(1.169_529_080_952_062, -1.6252183324559464),
            Complex::new(2.664_648_356_778_602, -0.661_862_138_870_788_6),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.35900195330351203, -0.837_802_647_889_065_7),
            Complex::new(0.259_736_528_805_249_1, 0.35093876065416163),
            Complex::new(-0.34958126066018347, -0.984_347_715_035_677_3),
            Complex::new(-0.916_516_623_993_876_5, 0.29048335462677405),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.796_199_655_377_801_9, -0.44151694564207233),
            Complex::new(-1.1767017099032087, -1.8377205595222044),
            Complex::new(-0.33383555601404047, -0.34955041709655676),
            Complex::new(3.402_332_122_917_833, -0.49334048025955746),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1E-5
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[22] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        'n',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-5.059_157_482_704_734, -4.969_882_079_513_688),
            Complex::new(2.9311310560265698, 0.841_835_696_223_974_4),
            Complex::new(-0.48324654918678833, 5.012_735_339_147_411),
            Complex::new(2.2077061131604707, -0.698_546_050_956_286_2),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(7.416_166_322_421_568, -7.160_416_678_859_136),
            Complex::new(-4.004_187_872_021_556, 0.845_371_717_991_259_2),
            Complex::new(-2.022_073_306_628_283, 4.257_200_387_952_415),
            Complex::new(1.6417092873163666, -4.754_476_231_656_336),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(4.491_833_938_211_17, 1.1490814311823123),
            Complex::new(-2.416_450_385_943_482, 0.985_476_914_173_232_2),
            Complex::new(0.673_862_152_118_869, -2.354_830_801_029_955),
            Complex::new(-2.137_049_347_583_498, 0.362_643_065_546_562_8),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.885_298_701_213_101_3, 3.7394932406460706),
            Complex::new(3.120_714_595_418_805_4E-2, -2.6296541405864176),
            Complex::new(-0.18872533273522937, -0.536_498_241_171_624_9),
            Complex::new(1.9029010959059771, 0.345_605_342_923_251_4),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.19393416590299054, -0.20559819740708857),
            Complex::new(-0.27444364722333936, -9.115_725_176_248_556E-2),
            Complex::new(-0.619_599_232_337_117, 0.27973439611890816),
            Complex::new(0.283_497_607_851_160_6, 6.187_668_376_561_027E-2),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.33833521252830906, -0.796_475_191_172_578_9),
            Complex::new(-0.39207809681367967, 1.078_482_538_135_729E-2),
            Complex::new(-0.29892032609917235, -1.347_774_021_852_271_6E-2),
            Complex::new(-0.349_456_784_273_459_5, -0.175_502_240_145_071),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        'n',
        'u',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-6.695_827_200_290_543, -9.840_801_791_390_515),
            Complex::new(1.0820954135679002, 7.445_015_650_772_103),
            Complex::new(2.2676559308021567, 8.962_994_813_513_308),
            Complex::new(0.12503837766758608, 3.1427388339321043),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-11.578342149986291, 0.429_853_760_041_267_1),
            Complex::new(5.953_718_529_163_981, -4.560_757_326_077_98E-2),
            Complex::new(3.995_058_774_878_167, -1.724_116_522_228_814),
            Complex::new(0.834_426_190_108_869_2, 2.023_890_756_330_198),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(1.7515003499232142, 1.4475852329073575),
            Complex::new(-1.212_959_873_022_456, -2.6430256456877874),
            Complex::new(-3.275_376_260_135_281, -2.614_909_024_056_806),
            Complex::new(-5.592_710_174_845_972E-2, 0.606_920_741_227_09),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(2.4260109525592837, 0.793_329_516_652_530_5),
            Complex::new(-1.2633618939958353, -0.730_146_160_274_399_5),
            Complex::new(-0.189_702_076_640_699_6, -0.129_064_751_110_639_1),
            Complex::new(0.817_194_851_956_506, -1.0458092960671421),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.391_342_413_452_831, 0.482_421_367_969_949_4),
            Complex::new(0.617_629_252_814_160_7, 0.10337749901712778),
            Complex::new(1.1661976616820193, -0.847_281_255_036_886_7),
            Complex::new(-0.644_789_586_433_011_7, 3.846_726_862_846_153E-2),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[30] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        't',
        'n',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(7.854_894_845_168_93, -1.451_732_949_413_893),
            Complex::new(0.176_546_718_581_407_8, -9.438_763_479_386_818),
            Complex::new(-1.6866026558673723, -5.681_740_638_808_875),
            Complex::new(1.477_250_363_436_449, 0.864_324_019_364_512_1),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(3.060_194_273_887_43, -0.526_401_429_850_264_3),
            Complex::new(-0.10377240436541091, -4.559_616_528_681_22),
            Complex::new(-1.9464271308776548, -2.8867679752665496),
            Complex::new(-1.0092313646782454, 2.8010376913028976),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(3.145_190_494_016_653, 4.534_175_523_034_57),
            Complex::new(6.174_622_438_848_134, -1.5523978802792286),
            Complex::new(2.826_858_703_818_135, -2.645_734_151_765_817),
            Complex::new(0.859_164_386_432_659_6, 1.3806202192454864),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.661_578_521_499_696, -2.9363489396777793),
            Complex::new(-4.619_030_817_343_067, 1.666_528_045_873_439E-2),
            Complex::new(-3.2210325377066784, 2.619_523_229_655_525),
            Complex::new(0.46205850474058635, 0.25996805243186816),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.560_868_371_399_464_9, -0.572_271_300_687_353_8),
            Complex::new(-0.33320568373813664, 0.442_219_142_989_145_1),
            Complex::new(-0.32953615350602994, 1.0981416447601218),
            Complex::new(0.25166817252864804, 2.108_744_137_045_397E-2),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.458_139_978_644_269_8, -1.134_810_403_700_888),
            Complex::new(-0.381_293_271_432_322_4, 0.402_862_922_195_037),
            Complex::new(-0.31239806631769507, 0.28544258588064964),
            Complex::new(-0.524_959_024_418_530_5, 0.17395454412838854),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        'c',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-3.094_825_294_270_548, -1.9275733244214712),
            Complex::new(-2.277_105_720_145_619, 6.712_596_084_025_231),
            Complex::new(1.1694157169980317, 4.629_493_706_039_566),
            Complex::new(-0.993_728_257_118_117_9, -0.702_024_480_693_597_1),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-3.312_458_773_588_336, -2.2114675151228083),
            Complex::new(-2.084_478_979_304_002, 2.832_785_604_446_447),
            Complex::new(-0.667_651_130_590_004_4, 2.558_015_070_035_972),
            Complex::new(-0.422_120_071_379_433_1, -3.0184137084415688),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.844_284_118_952_386_6, -4.654_029_932_882_786E-2),
            Complex::new(4.570_170_723_164_054, 2.878_819_741_097_299),
            Complex::new(2.8557874451127794, -1.1026660085131712),
            Complex::new(0.44752797709352565, 1.5446757675856397),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(2.1148935369493174, -1.6827616463576003),
            Complex::new(-3.329_721_899_125_268, -0.762_553_504_656_976_7),
            Complex::new(-2.5363952950995974, 0.633_476_451_325_514_8),
            Complex::new(0.31328580158181496, -0.18523871996536231),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.574_565_901_079_763, -8.880_916_257_843_613E-2),
            Complex::new(-0.164_971_851_137_556_7, -0.37989437108374974),
            Complex::new(-0.611_229_858_710_445_6, -0.519_177_230_273_904_1),
            Complex::new(-6.067_335_522_077_61E-3, 0.13978852736700292),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.645_119_783_678_103_5, -0.576_770_240_994_704_2),
            Complex::new(-0.35939234778477547, -0.15709451554172907),
            Complex::new(-0.26476595202960435, -0.13940588754600997),
            Complex::new(-0.24154617714782373, -0.30753296518577905),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1E-5
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.466_309_921_422_342, -0.540_474_880_859_559),
            Complex::new(-1.0204397181828506, -3.561_319_769_975_394),
            Complex::new(-1.7781817782592808, -1.5049934545330819),
            Complex::new(2.592_210_592_274_201, -0.633_773_114_180_651_5),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(1.2094864316776728, -1.1285628157472671),
            Complex::new(-1.381_707_238_168_926, -2.0415375192838203),
            Complex::new(-0.679_016_430_507_229, -0.710_604_990_575_037_3),
            Complex::new(1.6230565715427296, 8.710_744_265_843_928E-2),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.768_993_206_036_095, -0.33665447309721686),
            Complex::new(-0.422_065_232_215_676_8, -1.7558900195297258),
            Complex::new(-1.6341374336066268, -1.304_746_436_595_056),
            Complex::new(-0.10506998091690464, -0.413_868_351_712_977_2),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.343_123_772_434_362_2, 0.291_268_133_948_573_3),
            Complex::new(-0.591_071_512_401_936_1, -0.440_498_308_087_732_3),
            Complex::new(0.251_298_886_522_319_7, 6.048_504_112_049_568_6E-2),
            Complex::new(2.367_437_316_219_160_6E-2, -0.24485534476133647),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.624_206_019_858_479_6, 0.765_698_897_511_247_3),
            Complex::new(0.589_267_790_842_091_2, 0.301_874_543_389_416),
            Complex::new(1.262_701_607_960_628, 0.133_217_716_282_702_3),
            Complex::new(-2.224_272_868_199_153_6E-2, -0.19795781806420257),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.594_695_933_163_166, -0.830_402_486_026_287_1),
            Complex::new(-0.454_414_710_402_488_7, -8.847_357_332_706_451E-2),
            Complex::new(-0.340_861_491_858_959_2, -9.244_883_805_513_382E-2),
            Complex::new(-0.357_379_909_604_787_8, -0.292_091_730_982_065_2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.13539692759513855, 1.1275573074817657),
            Complex::new(5.163_986_980_915_069_6E-2, -0.377_873_227_000_236_5),
            Complex::new(4.574_757_814_407_348_6E-2, 1.2840517163276672),
            Complex::new(0.775_887_817_144_393_9, 0.496_541_529_893_875_1),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.29058008527797075, -0.380_983_459_780_961_4),
            Complex::new(0.12320657268015323, -0.708_836_717_458_091_4),
            Complex::new(1.1468431009319726, -0.18691754019113382),
            Complex::new(2.2015135429981934, 0.49826577653114423),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-3.008_929_945_990_374, -1.8307466678253201),
            Complex::new(-0.458_012_610_917_966_4, 0.160_229_137_453_053_9),
            Complex::new(-2.144_996_340_354_403, -3.0063718905692967),
            Complex::new(-1.0700898658711426, -2.658_969_524_160_44),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-2.644_594_954_531_656, -0.295_562_954_573_996_2),
            Complex::new(-2.094_822_703_375_761, 1.784_382_425_288_59),
            Complex::new(-5.092_906_399_805_507, -2.651_378_785_220_186),
            Complex::new(-6.7784699393746495, -4.981_326_920_004_563),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.8599051788280123, -1.2056064376526816),
            Complex::new(3.669_581_804_697_379, 4.1045003937456315),
            Complex::new(0.232_317_378_552_859_4, 5.171_076_110_351_147),
            Complex::new(-5.796_775_921_687_322, 10.728507916547569),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-1.3376217103528405, 5.860_155_503_705_7),
            Complex::new(3.247_733_271_222_419, 1.3511749795408745),
            Complex::new(-4.680_453_570_512_038, 10.494_488_399_442_38),
            Complex::new(-4.499_003_136_170_643, 12.997031650006122),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[1] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-0.36741276127057476, 0.604_158_805_990_222_9),
            Complex::new(0.17063020818508723, -0.165_153_011_118_003_9),
            Complex::new(-0.471_501_646_327_937_6, 0.646_299_320_370_914),
            Complex::new(0.188_902_552_182_094_5, 0.541_558_149_006_695_6),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.647_572_902_516_884_8, 0.515_291_111_038_436),
            Complex::new(-0.703_245_552_239_331_9, -7.379_494_058_265_168E-2),
            Complex::new(-0.845_496_868_917_905_1, -0.39807601305655405),
            Complex::new(5.865_724_215_507_884E-2, -2.1061517765487783),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(2.3082564821560467, 0.14524375748609208),
            Complex::new(-1.379_200_829_888_208, -2.0902032907923536),
            Complex::new(2.516_109_203_662_754, -0.647_751_184_846_820_8),
            Complex::new(7.931_152_378_941_494, -3.842_887_531_014_128),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(6.909_752_276_787_321, -8.021_562_062_460_67),
            Complex::new(-1.3869903805179185, 1.3101362478412506),
            Complex::new(6.197_477_018_966_718, -2.4369489382605147),
            Complex::new(-1.0468654795781644, -6.831_119_753_907_772E-2),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(7.724_155_106_356_362, 11.769974991681147),
            Complex::new(-4.595_898_416_936_779, -4.348_595_924_487_088),
            Complex::new(0.581_815_406_925_568_1, 5.467_709_801_301_938),
            Complex::new(6.906_683_785_643_944, -14.215_521_507_415_6),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-14.436677303579794, -5.923_871_036_742_208),
            Complex::new(0.859_681_535_571_062_7, -1.629_248_117_385_485),
            Complex::new(-6.0115478281876165, -9.349_134_531_229_646),
            Complex::new(9.564_947_074_034_254, -3.9291421855988817),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1E-5
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        't',
        'n',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.0000000000000000, 0.0000000000000000),
            Complex::new(-0.324_940_723_896_398_3, -8.481_683_799_189_943E-2),
            Complex::new(1.1274062950571064, 9.480_650_752_627_551E-2),
            Complex::new(0.515_563_832_739_756_4, -0.626_205_030_579_942_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.834_753_773_047_727_7, -0.820_327_571_620_824_9),
            Complex::new(1.0000000000000000, 0.0000000000000000),
            Complex::new(1.2479358164593708, 0.43510358886114614),
            Complex::new(0.22834580111255753, 2.9709409537969433),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(3.7621707201759254, 1.465_310_466_929_783),
            Complex::new(2.3328393080681247, -2.7857917253735196),
            Complex::new(4.406_092_862_521_098, 3.2428830175566885),
            Complex::new(10.126242761498597, 8.668_869_287_268_382),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-7.252_252_168_273_948, 10.214425752174813),
            Complex::new(-3.6877018325740307, 1.1359533616370237),
            Complex::new(-14.088127853858264, 4.394_294_280_329_966),
            Complex::new(-7.644_460_015_846_844, -0.18616402987895375),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(19.852_281_413_416_61, 8.043_809_827_301_49),
            Complex::new(9.322_152_995_282_474, 2.793_736_384_982_333),
            Complex::new(16.862486159632002, 24.203_264_055_511_88),
            Complex::new(9.058_373_634_919_016, 30.496_466_499_458_05),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-6.389_327_645_535_486, -17.559_573_741_599_26),
            Complex::new(3.052_328_234_270_127, -8.782_011_808_401_5),
            Complex::new(8.482_650_462_664_338, -20.549_739_325_639_94),
            Complex::new(16.285707335606293, -0.532_198_568_828_803_8),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1E-5
    );
    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'x',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'x',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'u',
            'x',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'u',
            'n',
            'x',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            3,
            &mut [],
            4,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut [],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn hemm() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        0,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.7, -0.3),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        0,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.7, -0.3),
        &mut c,
        6,
    );
    capproximately!(c, b);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.4146414344564082, 1.7579030898107073),
            Complex::new(-1.5399500419037095, 0.5607460908880562),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.7635934611404596, -1.563782051071005),
            Complex::new(-0.7990092489893682, 1.1565369971501793),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.2522234481561323, 2.4413646288945894),
            Complex::new(-0.8919211272845686, -0.7953391172553718),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.1333363608148414, -2.2239002740099374),
            Complex::new(0.8041895097449078, -1.263614384970583),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(-1.2845993538721883, -0.8149687088699175),
            Complex::new(0.04672617218835198, 0.24226348085968588),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.726750747385451, 0.01915639166027384),
            Complex::new(1.1519117540872, 0.2573383771555333)
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(-0.1, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.622_375_607_490_539_6, 0.532_261_133_193_969_7),
            Complex::new(0.24737988460992777, -0.120_165_368_274_579_8),
            Complex::new(-0.752_132_000_520_526_3, 0.541_069_231_572_294),
            Complex::new(1.243_020_702_536_501_4E-2, 0.664_149_302_660_444_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.31924869258488275, -0.41900512806656365),
            Complex::new(0.44549368961858815, -6.415_589_029_782_52E-2),
            Complex::new(0.583_861_989_396_836_1, 0.11377346982854686),
            Complex::new(0.29232997535965843, 1.3088857189798215),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.301_257_847_029_481_8, -0.657_033_230_114_053_3),
            Complex::new(0.14261050267437336, -0.12199792232017415),
            Complex::new(-0.10314716950175895, -0.176_221_290_627_326_6),
            Complex::new(0.22950244607256476, -0.168_085_139_428_522_1),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-1.612_959_420_037_762_8E-2, 0.22332940258812528),
            Complex::new(-1.316_813_770_624_314_4E-3, -0.643_783_361_092_420_4),
            Complex::new(-0.286_694_849_693_376, -0.17395827117300522),
            Complex::new(4.857_218_358_308_723_6E-2, 0.20596018012258932),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.17365376531018797, -6.442_627_624_977_959E-2),
            Complex::new(-4.483_806_044_400_929E-2, 0.252_908_542_023_666_9),
            Complex::new(0.36174763279293565, 0.636_949_624_032_749_5),
            Complex::new(0.12700804872952975, -0.33389439267542165),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(0.736_119_865_232_268_8, 2.465_656_761_094_692_2E-2),
            Complex::new(-0.128_681_739_355_790_2, -0.308_038_256_117_613_8),
            Complex::new(-8.087_529_326_482_068E-2, -0.24149643070759275),
            Complex::new(3.230_307_571_511_215E-2, -0.33126463825298574),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(-0.4, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-2.935_065_734_005_036_5E-2, 0.744_429_724_723_212_1),
            Complex::new(-0.457_248_412_545_102_8, 2.472_008_501_472_792),
            Complex::new(-2.6679770806555987, 0.591_390_472_252_365_3),
            Complex::new(-9.381_593_335_206_839E-2, -0.661_869_673_646_718),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(1.5935559894779265, -0.621_283_819_170_214_7),
            Complex::new(2.1737031164892846, 2.1413157835605925),
            Complex::new(3.635_152_091_064_619, 0.304_199_262_683_018),
            Complex::new(0.138_402_148_487_706_7, 1.8006383908576788),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.328_365_684_090_536_1, 0.322_034_057_554_601_1),
            Complex::new(-0.16239848402013413, -1.4478841158354525),
            Complex::new(0.298_885_865_479_970_3, -2.3536534270582283),
            Complex::new(0.828_478_398_066_720_7, 0.20658982019875485),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.39135653961213285, -1.2753244343960868),
            Complex::new(0.606_916_714_738_540_5, -0.46120495921820964),
            Complex::new(-0.703_411_972_326_833_6, -0.34856996829018666),
            Complex::new(0.355_605_985_535_360_4, -1.6447638016528807),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.3449207395328406, 1.3215570006272412),
            Complex::new(-0.46409757273693786, 0.10578712406097923),
            Complex::new(-0.23249122621298632, 0.747_941_252_340_751_5),
            Complex::new(-0.38751770034385613, 1.013_323_247_499_361),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-1.0967932443017383, -0.349_553_548_589_020_3),
            Complex::new(1.146_526_868_987_373, -1.8341626752337215),
            Complex::new(0.817_290_972_433_909_2, 0.39141011200385634),
            Complex::new(-0.19520613456232078, -1.0893009966163467),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.971_911_234_161_818_8, 0.509_816_765_053_147_5),
            Complex::new(-0.802_498_305_770_733_1, 2.4633199387844824),
            Complex::new(-1.5169052858488845, 0.421_812_487_670_800_2),
            Complex::new(0.27548266942224975, -1.4098228637310937),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.995_737_177_175_771_9, -0.338_113_884_735_228_3),
            Complex::new(1.639_793_293_222_299, 1.955_858_683_097_421),
            Complex::new(3.049_559_949_841_563, -0.15954537563336316),
            Complex::new(0.567_468_177_110_413_3, 0.17207548110202797),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.28532641495519784, 1.2286814228388478),
            Complex::new(-0.391_847_462_858_229_7, -1.3940848009033966),
            Complex::new(0.31226850119727223, -2.0975909267832287),
            Complex::new(0.47552270260740953, 0.26166414017709494),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.244_521_950_454_531_8, -1.5151170797007516),
            Complex::new(0.23697198590189406, 0.257_620_799_776_258_4),
            Complex::new(-0.48399748916268936, 1.086_128_876_845_332_5E-2),
            Complex::new(0.42025250154490373, -1.9025110326155357),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.5014424722976405, 1.4936019441758543),
            Complex::new(-0.26817711353436224, -0.150_435_061_497_372_5),
            Complex::new(-0.26850802968163445, -0.17120312143764616),
            Complex::new(-0.721_811_907_386_036_7, 1.3124700420818154),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-1.9036250764466338, -0.801_739_648_327_489_6),
            Complex::new(1.1123421207973976, -1.416_342_076_357_596),
            Complex::new(0.768_173_164_787_453_9, 0.707_430_339_963_087_9),
            Complex::new(-0.422_350_705_356_853_3, -0.738_449_904_484_683_3),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'l',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.6, 0.4),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.740_318_411_107_299, -4.156_781_252_222_068),
            Complex::new(1.5701776230823246, -1.7028121207367017),
            Complex::new(2.921_729_279_490_821, 2.664_588_523_522_81),
            Complex::new(0.37030167414141746, -0.670_107_596_739_563_5),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-2.2630835590522227, -2.1229320066196156),
            Complex::new(2.484_211_982_395_98, -7.238_020_487_516_929),
            Complex::new(0.24931288619950953, 1.1393326242309958),
            Complex::new(-0.15626431993015122, 1.8841563199065459),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.465_575_987_743_413_5, 1.6616017947432198),
            Complex::new(-1.2238551365692814, -0.469_643_736_316_859_3),
            Complex::new(-0.814_099_542_110_006, 1.9643136086659696),
            Complex::new(0.285_872_855_571_255_1, 1.488_279_170_389_84),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.894_361_106_064_759_7, -1.271_865_303_880_453),
            Complex::new(-1.1453435725176404, -0.905_583_606_203_683_8),
            Complex::new(1.3523464275293064, -6.984_561_271_006_14E-2),
            Complex::new(1.1498371510409668, 1.7082210529850559),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-2.1478995758838577, 0.37940110303243435),
            Complex::new(0.35644753206828794, 0.566_598_292_354_879_4),
            Complex::new(0.831_331_356_769_700_7, 0.27374976655088035),
            Complex::new(-0.460_411_592_443_186_2, -0.509_053_453_992_651_6),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.956_655_870_812_207_7, -0.11330529120488797),
            Complex::new(-1.3978267600056178, 1.7207265051741496),
            Complex::new(-1.4299226926401771, -2.2074907397804298),
            Complex::new(-0.895_860_749_554_656, 1.0081050580370876),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'l',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.3794099978183687, -5.257_259_205_367_546),
            Complex::new(1.594_112_403_891_133, -1.3146109075897425),
            Complex::new(2.6191713337571962, 1.3896862853742649),
            Complex::new(-0.504_894_480_983_864_9, -1.0114715641286953),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-1.8870568972897215, -1.479_834_786_319_758),
            Complex::new(2.3282269330697893, -6.620_906_315_398_661),
            Complex::new(-0.21385503471255873, 1.8415818476915469),
            Complex::new(-2.025_292_618_094_78, 1.5616493786935888),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.555_837_108_581_240_5, 1.6214363335574582),
            Complex::new(-1.141_109_656_446_014, -0.21746188326819893),
            Complex::new(-0.528_115_523_885_541_4, 1.9243172304508096),
            Complex::new(0.382_098_267_876_494_4, 1.8789051474191738),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.611_000_119_369_406_2, -1.413_212_144_239_267),
            Complex::new(-0.30276393832627546, -0.560_653_015_592_147_5),
            Complex::new(1.7342044784438015, -0.35108443832156466),
            Complex::new(0.854_350_345_111_984_6, 1.6608368911139704),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.9701439535436795, 0.18700647314980803),
            Complex::new(4.986_453_566_723_171E-2, 0.371_782_381_244_084_4),
            Complex::new(-0.196_389_984_385_630_5, 0.403_831_507_626_558_2),
            Complex::new(-9.216_939_631_249_277E-2, -0.16317671166391745),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-1.3852713096446827, 0.836_036_416_835_946_9),
            Complex::new(-0.925_717_319_813_071_4, 1.718_317_130_931_866),
            Complex::new(-1.070_571_421_358_613, -2.183_214_203_436_976),
            Complex::new(-0.480_062_477_879_696_7, 1.2287208094127564),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'r',
        'u',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.1, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.0492507380581135, -4.685_068_067_535_674),
            Complex::new(-0.25775830863319293, 0.19202397956818207),
            Complex::new(1.3794382927760527, -0.440_542_415_407_023_1),
            Complex::new(1.7237475261652158, 0.762_275_710_445_671_2),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.813_691_064_079_568_4, 0.346_684_570_655_879_3),
            Complex::new(1.541_408_727_578_795, -2.157_999_642_161_214),
            Complex::new(-1.4436299452257024, -1.1949543586973261),
            Complex::new(0.529_411_320_566_792, 2.9833438731343485),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.432_394_869_462_199, 1.7003452332800477),
            Complex::new(1.8862347506739041, -1.4426502124799074),
            Complex::new(-0.204_214_214_911_470_3, -0.146_242_591_073_273_3),
            Complex::new(-3.515_448_911_150_143E-2, 1.902_313_252_606_601),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.806_017_184_771_976_6, -1.1614707583064985),
            Complex::new(0.279_768_306_834_649_7, -0.610_665_134_251_753_7),
            Complex::new(1.7846243759415663, 0.12124436054600474),
            Complex::new(1.161_783_402_094_387, 1.0987454093262699),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.879_044_132_004_614_7E-2, 1.5761153832527943),
            Complex::new(-0.25422556413653397, 0.737_099_767_074_401_5),
            Complex::new(1.2693742279114388, 2.396_955_413_187_155),
            Complex::new(0.23838117192449293, -0.772_126_506_848_333_7),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-2.2885058185422174, -2.260_500_504_947_451),
            Complex::new(0.783_831_080_460_510_3, -0.523_100_229_897_161_7),
            Complex::new(-1.7265234423765672, -2.5859374695898527),
            Complex::new(-0.753_086_593_070_884_3, 1.9179323367452152),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'r',
        'l',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.7620838935196597, 0.525_725_505_602_455_8),
            Complex::new(-0.38722128429009905, 1.112_249_334_153_601),
            Complex::new(3.5326335051329956, -1.6429894187198397),
            Complex::new(-2.9614312869456008, -2.0975914928727786),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(2.6066196946963776, -2.5408032465493644),
            Complex::new(0.18710810744380824, 1.9314235066316638),
            Complex::new(-0.648_364_861_087_890_9, 0.785_875_591_076_398_4),
            Complex::new(0.447_823_602_059_578_5, 0.947_209_720_563_412_3),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.109_475_654_249_987_4, -1.478_551_065_331_099),
            Complex::new(1.3309259797098396, -1.0493629461557186),
            Complex::new(3.4759585804621675, -6.128_015_457_281_654),
            Complex::new(0.362_003_065_043_894_3, -2.644_696_805_906_779),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-1.804_938_012_002_399, 0.651_586_678_913_506_2),
            Complex::new(-2.4740051538807633, -0.354_074_745_608_641_7),
            Complex::new(-2.010_323_807_539_338, -0.954_707_190_605_303_1),
            Complex::new(3.5191883793917236, -6.157_448_930_704_373),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.745_051_257_450_133_1, -3.7206741947987183),
            Complex::new(-2.6813185514918385, 0.965_478_085_989_462_8),
            Complex::new(-0.533_710_505_201_752_6, -2.039_395_241_689_56),
            Complex::new(2.6098071711445425, -2.5701179676264876),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-2.9630782063318857, -0.251_201_084_004_402),
            Complex::new(0.21875545102578733, 1.7054655666082565),
            Complex::new(-2.4531243858344594, 3.0252959544891533),
            Complex::new(-2.2812439006104843, 3.586_245_477_007_61),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'x',
            'u',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.7, -0.3),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'l',
            'x',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.7, -0.3),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'l',
            'u',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            3,
            &b,
            6,
            Complex::new(0.7, -0.3),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'l',
            'u',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            3,
            Complex::new(0.7, -0.3),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'l',
            'u',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.7, -0.3),
            &mut [],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn her2k() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.3,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.6058251087158846, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.688_117_820_655_678_1, -0.10513209829930731),
            Complex::new(1.3043790631628438, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.945_106_150_583_169_5, 4.404_978_986_275_326_4E-2),
            Complex::new(0.452_473_005_774_526_2, 0.24615098347899378),
            Complex::new(2.9377338070895544, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.11876585523864702, -0.21516651831640768),
            Complex::new(-0.528_416_485_217_178_1, -1.2143434542327047),
            Complex::new(0.758_027_132_513_903_4, 8.580_040_611_120_882E-2),
            Complex::new(4.119_351_903_566_965, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(1.4913513120355024, -0.36110486844967427),
            Complex::new(-0.724_514_014_031_528_9, -0.831_046_748_410_776_2),
            Complex::new(1.4374079607512258, -0.306_453_194_232_197_8),
            Complex::new(1.1771392414997601, 0.751_460_767_542_723_4),
            Complex::new(7.662_993_033_983_644, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.3078002746096349, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.10361333547409496, 0.24149736125040472),
            Complex::new(1.1198417497625819, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.772_679_533_448_472_1, -2.8878492069004986),
            Complex::new(0.18597724644402142, 0.139_141_658_333_992_6),
            Complex::new(2.102_225_234_234_849, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.991_112_218_965_036_4, -1.860_233_521_169_216),
            Complex::new(-0.169_071_590_328_963_9, -1.2348811617422517),
            Complex::new(0.962_757_256_253_553_1, -0.356_735_715_282_001_1),
            Complex::new(3.6393697204873954, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.22504670092250856, -1.3057917981450853),
            Complex::new(-0.465_409_571_161_300_9, -1.1081177222021112),
            Complex::new(1.4870086981201611, -0.937_082_483_064_291_9),
            Complex::new(1.179_929_583_013_768, 0.927_979_116_100_277_6),
            Complex::new(6.911_211_641_305_772, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.3078002746096349, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.246_433_986_596_439_6, -1.099_564_542_548_209),
            Complex::new(1.1198417497625819, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(1.1639551912088129, 1.7650659902905894),
            Complex::new(0.18597724644402142, 0.139_141_658_333_992_6),
            Complex::new(2.102_225_234_234_849, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-1.593_296_716_941_552, 0.267_548_453_256_770_7),
            Complex::new(-0.169_071_590_328_963_9, -1.2348811617422517),
            Complex::new(0.962_757_256_253_553_1, -0.356_735_715_282_001_1),
            Complex::new(3.6393697204873954, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(2.6689699106340283, 2.322_680_206_556_908),
            Complex::new(-0.465_409_571_161_300_9, -1.1081177222021112),
            Complex::new(1.4870086981201611, -0.937_082_483_064_291_9),
            Complex::new(1.179_929_583_013_768, 0.927_979_116_100_277_6),
            Complex::new(6.911_211_641_305_772, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let a = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.3078002746096349, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(9.622_241_241_365_442E-2, -0.47278950590771907),
            Complex::new(1.1198417497625819, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.38670296267975646, -0.512_482_151_084_912_2),
            Complex::new(0.18597724644402142, 0.139_141_658_333_992_6),
            Complex::new(2.102_225_234_234_849, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.567_064_995_791_506, -1.1193936509445461),
            Complex::new(-0.169_071_590_328_963_9, -1.2348811617422517),
            Complex::new(0.962_757_256_253_553_1, -0.356_735_715_282_001_1),
            Complex::new(3.6393697204873954, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.768_402_604_268_010_5, 0.870_196_280_650_478_3),
            Complex::new(-0.465_409_571_161_300_9, -1.1081177222021112),
            Complex::new(1.4870086981201611, -0.937_082_483_064_291_9),
            Complex::new(1.179_929_583_013_768, 0.927_979_116_100_277_6),
            Complex::new(6.911_211_641_305_772, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        1.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.570_754_509_686_539, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.832_344_639_473_857_8, -0.925_573_477_932_636_7),
            Complex::new(0.825_121_308_659_600_4, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.760_954_074_101_554_6, 0.319_564_953_750_598_1),
            Complex::new(-0.10348433645507227, -8.818_702_957_227_27E-2),
            Complex::new(1.8030101260786449, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.13138168575961512, -1.1742711258486065),
            Complex::new(-1.406_610_047_245_773, -0.984_739_839_129_489_1),
            Complex::new(0.738_489_371_164_632_6, 0.26150756179090506),
            Complex::new(4.016_765_380_172_53, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.711_295_829_967_673_7, 1.2289251663011131),
            Complex::new(3.819_841_719_624_284E-2, -1.1191632004864702),
            Complex::new(2.5727781130218945, -1.8777316348663549),
            Complex::new(0.48897573226761326, 0.812_153_790_849_652_1),
            Complex::new(5.626_612_337_106_553, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        1.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.570_754_509_686_539, 0.0000000000000000),
            Complex::new(-0.23001094477743128, 4.327_640_909_833_186E-2),
            Complex::new(1.7165022571514967, 1.7507862892685062),
            Complex::new(0.705_364_351_246_762_7, 0.840_047_363_694_027_5),
            Complex::new(1.1830440441827141, 0.887_706_818_409_58),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(0.825_121_308_659_600_4, 0.0000000000000000),
            Complex::new(0.18021007377589254, -1.3057122025768517),
            Complex::new(2.2355817204467927, 0.16929054170135827),
            Complex::new(0.29818386412617515, -0.45566437370700763),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.8030101260786449, 0.0000000000000000),
            Complex::new(0.551_246_431_096_387_7, -1.996_701_060_529_764E-2),
            Complex::new(1.7392321599865397, 3.3784470098129495),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(4.016_765_380_172_53, 0.0000000000000000),
            Complex::new(1.3132659482366984, -3.1518794342460295),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(5.626_612_337_106_553, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ],
        1e-5
    );
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        1.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.602_528_772_787_36, 0.0000000000000000),
            Complex::new(-0.565_276_420_727_084_8, -4.423_542_141_930_181E-2),
            Complex::new(2.8797310564492693, 1.8486052037085914),
            Complex::new(1.2373098448532591, 0.193_945_129_717_380_7),
            Complex::new(2.0901620453582117, 1.6112109712987144),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(0.825_121_308_659_600_4, 0.0000000000000000),
            Complex::new(0.18021007377589254, -1.3057122025768517),
            Complex::new(2.2355817204467927, 0.16929054170135827),
            Complex::new(0.29818386412617515, -0.45566437370700763),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.8030101260786449, 0.0000000000000000),
            Complex::new(0.551_246_431_096_387_7, -1.996_701_060_529_764E-2),
            Complex::new(1.7392321599865397, 3.3784470098129495),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(4.016_765_380_172_53, 0.0000000000000000),
            Complex::new(1.3132659482366984, -3.1518794342460295),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(5.626_612_337_106_553, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.5,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.9710516552489077, 0.0000000000000000),
            Complex::new(-0.402_159_742_131_541_9, 0.170_521_126_985_391_8),
            Complex::new(2.214_831_409_213_399, 1.2294531346167945),
            Complex::new(0.601_095_171_334_124_8, 0.333_618_273_342_640_1),
            Complex::new(1.882_841_325_400_86, 0.732_259_421_768_685_1),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(0.972_481_529_211_091_2, 0.0000000000000000),
            Complex::new(0.18309366010995715, -0.722_426_930_455_422_2),
            Complex::new(1.0332550650589145, 0.702_085_851_721_804_9),
            Complex::new(-8.361_285_351_756_242E-2, 0.326_226_674_247_551_9),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.952_617_680_156_747, 0.0000000000000000),
            Complex::new(0.757_001_843_674_970_5, 0.16838435233835175),
            Complex::new(1.6131204290533503, 2.1577647464386205),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(3.828_067_550_329_963, 0.0000000000000000),
            Complex::new(1.246_597_765_625_233, -2.0399292751731535),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(6.268_911_989_206_162, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.3395745377104555, 0.0000000000000000),
            Complex::new(-0.23904306353599897, 0.385_277_675_390_085_4),
            Complex::new(1.5499317619775281, 0.610_301_065_524_997_4),
            Complex::new(-3.511_950_218_500_978E-2, 0.473_291_416_967_899_5),
            Complex::new(1.6755206054435083, -0.14669212776134405),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(1.1198417497625819, 0.0000000000000000),
            Complex::new(0.18597724644402175, -0.13914165833399272),
            Complex::new(-0.16907159032896413, 1.234_881_161_742_252),
            Complex::new(-0.465_409_571_161_300_2, 1.1081177222021112),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(2.102_225_234_234_849, 0.0000000000000000),
            Complex::new(0.962_757_256_253_553_5, 0.356_735_715_282_001_1),
            Complex::new(1.487_008_698_120_161, 0.937_082_483_064_292_3),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(3.6393697204873954, 0.0000000000000000),
            Complex::new(1.1799295830137675, -0.927_979_116_100_277_7),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(6.911_211_641_305_772, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'c',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.1476878135503865, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.294_692_417_068_299_4, -0.693_610_004_278_759_9),
            Complex::new(4.050_066_972_255_238, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.36742658827363606, 0.907_791_563_174_816_9),
            Complex::new(2.660_964_625_046_88E-2, -1.2644121466149967),
            Complex::new(1.0465961268435413, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.715_144_473_174_665_3, -5.163_787_425_801_702_5E-2),
            Complex::new(5.936_265_917_680_661E-2, -0.453_327_893_309_758_3),
            Complex::new(-4.118_112_097_729_165E-2, -0.22614482992219803),
            Complex::new(0.956_660_329_546_114_9, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.17741805067471494, -0.882_462_172_935_176_9),
            Complex::new(-0.278_257_117_915_511, 0.128_230_373_592_076_4),
            Complex::new(-1.059_987_238_405_701_9E-2, -0.18665144771536654),
            Complex::new(-0.694_554_339_564_351_6, -0.23297790106179717),
            Complex::new(1.176_095_771_345_81, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'c',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.5,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.7791649310888387, 0.0000000000000000),
            Complex::new(0.131_575_738_472_756_5, 0.478_853_455_874_066_3),
            Complex::new(0.297_473_058_962_234_3, -0.28863949408302003),
            Complex::new(1.351_359_146_693_8, -8.803_526_936_724_237E-2),
            Complex::new(2.990_266_928_263_674E-2, 1.7614137224652062),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(3.9027067517037475, 0.0000000000000000),
            Complex::new(2.372_605_991_640_419_6E-2, 0.681_126_874_493_567_2),
            Complex::new(1.261_689_314_564_685, -7.946_741_671_068_847E-2),
            Complex::new(0.103_539_599_728_226_8, -0.910_121_421_546_635_6),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.896_988_572_765_439_2, 0.0000000000000000),
            Complex::new(-0.24693653355587442, 3.779_346_697_854_874E-2),
            Complex::new(0.11551185854913237, 1.4073337110896953),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(1.1453581593886824, 0.0000000000000000),
            Complex::new(-0.627_886_156_952_886_2, -0.878_972_258_011_078_8),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(0.533_796_119_246_200_6, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        1.0,
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        0.8,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.0103634031171111, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.742_853_652_579_391_6, -0.36222718301753964),
            Complex::new(-0.235_776_356_395_726_7, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.918_125_643_106_186_8, 0.665_637_693_787_182_6),
            Complex::new(-0.23156926976992587, -0.18186295303498135),
            Complex::new(-0.23937209009188543, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.348_546_653_219_262_5, -4.390_198_057_743_877E-2),
            Complex::new(-0.990_030_780_286_055_3, 0.200_113_061_072_126_9),
            Complex::new(-0.179_414_310_744_618, 0.494_594_629_028_359_4),
            Complex::new(0.30191653224701476, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-4.568_542_012_103_527E-2, 0.286_983_112_796_889_4),
            Complex::new(0.402_886_396_689_510_2, -8.836_382_759_159_545E-3),
            Complex::new(0.868_615_544_864_766_8, -0.752_519_332_655_062_1),
            Complex::new(-0.552_763_088_833_735_6, -9.266_026_158_124_596E-2),
            Complex::new(-1.027_679_458_672_992, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        0.8,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.0103634031171111, 0.0000000000000000),
            Complex::new(-0.260_986_689_641_873_3, -0.343_610_482_567_704_9),
            Complex::new(1.0638394514298355, 0.990_643_325_308_610_7),
            Complex::new(1.017_943_492_799_155, -0.22347703313048228),
            Complex::new(0.33171315687467384, 1.4063225002038848),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.235_776_356_395_726_7, 0.0000000000000000),
            Complex::new(-4.613_738_203_253_42E-3, -0.933_256_449_300_891_7),
            Complex::new(1.9237226772863067, -0.852_472_508_735_544_9),
            Complex::new(0.610_874_757_332_723_6, -1.2510256953690302),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.23937209009188543, 0.0000000000000000),
            Complex::new(-0.32920866503132373, -0.301_362_185_200_485_3),
            Complex::new(0.201_778_772_499_841, 1.9530916505022589),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(0.30191653224701476, 0.0000000000000000),
            Complex::new(0.10666909376783806, -1.7791202810275593),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.027_679_458_672_992, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'x',
            'c',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            0.0,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'l',
            'x',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            0.0,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'l',
            'n',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            4,
            &b,
            6,
            0.0,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'l',
            'n',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            4,
            0.0,
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'l',
            'n',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            0.0,
            &mut [],
            4,
        );
    });
    assert!(result.is_err());
}

#[test]
fn herk() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.0, &a, 6, 1.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(1.2629542350769043, 0.992_160_379_886_627_2),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.29472044110298157, -0.832_043_290_138_244_6),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.299_215_108_156_204_2, 0.26613736152648926),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(0.377_395_659_685_134_9, -0.17262350022792816),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.0, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'n', 4, 6, 0.0, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'n', 4, 6, 0.0, &a, 6, 0.5, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(0.631_477_117_538_452_1, 0.0000000000000000),
            Complex::new(-0.163_116_678_595_542_9, -0.214_756_548_404_693_6),
            Complex::new(0.664_899_647_235_870_4, 0.619_152_069_091_796_9),
            Complex::new(0.636_214_673_519_134_5, -0.139_673_143_625_259_4),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.14736022055149078, 0.0000000000000000),
            Complex::new(-2.883_586_334_064_603E-3, -0.583_285_272_121_429_4),
            Complex::new(1.2023266553878784, -0.532_795_310_020_446_8),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.149_607_554_078_102_1, 0.0000000000000000),
            Complex::new(-0.20575541257858276, -0.188_351_362_943_649_3),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(0.18869782984256744, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.2, &a, 6, 0.5, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(1.7290593975566546, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.501_424_634_978_950_6, -0.254_796_351_918_388_9),
            Complex::new(0.549_037_378_952_049_3, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.510_741_280_390_191_2, 0.362_150_833_884_460_6),
            Complex::new(0.12492495059790593, 4.351_045_232_728_862E-2),
            Complex::new(1.3641416174735665, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-5.410_066_326_963_807_6E-2, -0.449_841_492_035_853_2),
            Complex::new(-0.697_346_695_153_168_3, -0.519_622_265_692_844_1),
            Complex::new(0.30051980781257026, 0.259_285_346_346_104_9),
            Complex::new(2.1917644304238264, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.2, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(1.0975822800182025, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-3.714_110_903_519_448_5E-2, -2.840_436_590_593_009_6E-2),
            Complex::new(0.696_397_599_503_540_1, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(6.308_723_800_046_437E-2, -5.387_271_853_329_450_6E-2),
            Complex::new(0.26965574204745274, 0.15717479628042125),
            Complex::new(1.5137491715516687, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.271_942_318_285_583_5, -0.42240275458382304),
            Complex::new(-7.857_746_669_476_375E-2, -0.644_692_926_999_225_4),
            Complex::new(0.412_653_750_357_030_6, -4.983_629_219_034_845E-2),
            Complex::new(2.003_066_600_581_259, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.2, &a, 6, 1.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.3605365150951068, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.965_708_160_922_706_5, -0.481_188_337_930_847_7),
            Complex::new(0.40167715840055845, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.084_569_798_780_847, 0.778_174_386_302_215_7),
            Complex::new(-1.980_584_085_164_083_2E-2, -7.015_389_162_584_396E-2),
            Complex::new(1.2145340633954644, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.16374099174630735, -0.477_280_229_487_883_4),
            Complex::new(-1.3161159236115731, -0.394_551_604_386_462_9),
            Complex::new(0.188_385_865_268_11, 0.568_406_984_882_558_1),
            Complex::new(2.380_462_260_266_394, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'n', 4, 6, 0.2, &a, 6, 1.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.3605365150951068, 0.0000000000000000),
            Complex::new(-0.36337446622628033, -0.401_108_730_903_457_1),
            Complex::new(1.3928865324722048, 1.2921768567168883),
            Complex::new(1.0004870287526855, 0.143_056_467_333_304_3),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(0.40167715840055845, 0.0000000000000000),
            Complex::new(0.26388856937932353, -1.3237453405232802),
            Complex::new(2.326_075_844_080_993, -0.420_897_693_041_668_2),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.2145340633954644, 0.0000000000000000),
            Complex::new(1.142_925_199_865_078_8E-3, -0.32686643369695023),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(2.380_462_260_266_394, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'c', 4, 6, 0.2, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.2475633992730493, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.361_060_218_999_67, -1.0814334285577285),
            Complex::new(3.025_930_129_624_856, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(1.005_828_592_149_671, 0.474_762_375_236_318_4),
            Complex::new(-0.753_165_564_913_838_6, 0.15292505454474753),
            Complex::new(2.0136910810504953, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.901_806_534_693_863_6, 0.14218481502237462),
            Complex::new(0.324_789_036_865_186_4, -0.508_680_350_751_484_4),
            Complex::new(-1.0421890586849125, 6.296_863_091_555_976E-2),
            Complex::new(1.9197208584549985, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'c', 4, 6, 0.2, &a, 6, 0.2, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.500_154_250_052_327, 0.0000000000000000),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.175_346_805_854_822_1, -1.1719902243121134),
            Complex::new(2.9669860405259243, 0.0000000000000000),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.776_297_181_373_124_3, 0.641_171_798_683_114),
            Complex::new(-0.811_057_882_356_32, 0.107_459_316_286_002_2),
            Complex::new(1.953_848_058_527_524, 0.0000000000000000),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.814_669_871_389_048, 0.13120931987801493),
            Complex::new(7.728_134_179_367_258E-2, -0.458_652_085_483_452_7),
            Complex::new(-1.087_042_636_371_067, 0.186_617_288_172_649_6),
            Complex::new(1.9951999915167522, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'c', 4, 6, 0.2, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.2475633992730493, 0.0000000000000000),
            Complex::new(0.361_060_218_999_67, 1.0814334285577285),
            Complex::new(1.005_828_592_149_671, -0.474_762_375_236_318_4),
            Complex::new(-0.901_806_534_693_863_6, -0.14218481502237462),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(3.025_930_129_624_856, 0.0000000000000000),
            Complex::new(-0.753_165_564_913_838_6, -0.15292505454474753),
            Complex::new(0.324_789_036_865_186_4, 0.508_680_350_751_484_4),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(2.0136910810504953, 0.0000000000000000),
            Complex::new(-1.0421890586849125, -6.296_863_091_555_976E-2),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(1.9197208584549985, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'c', 4, 6, 0.2, &a, 6, 0.2, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.500_154_250_052_327, 0.0000000000000000),
            Complex::new(0.29581354658920167, 0.995_530_807_915_802_3),
            Complex::new(1.271_788_455_007_13, -0.22710154390916576),
            Complex::new(-0.647_320_661_494_074_9, -0.198_054_073_304_995_2),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(2.9669860405259243, 0.0000000000000000),
            Complex::new(-0.754_318_999_464_652, -0.38623916686997045),
            Complex::new(0.805_719_706_186_763_1, 0.295_562_223_567_598_2),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.953_848_058_527_524, 0.0000000000000000),
            Complex::new(-1.1244912249427435, -0.138_309_177_215_681_1),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(1.9951999915167522, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::herk('x', 'n', 4, 6, 0.1, &a, 6, 0.3, &mut [], 6);
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::herk('u', 'x', 4, 6, 0.1, &a, 6, 0.3, &mut [], 6);
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::herk('u', 'n', 4, 6, 0.1, &a, 3, 0.3, &mut [], 6);
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::herk('u', 'n', 5, 6, 0.1, &a, 6, 0.3, &mut [], 4);
    });
    assert!(result.is_err());
}

#[test]
fn symm() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.4146414344564082, 1.7579030898107073),
            Complex::new(-1.5399500419037095, 0.5607460908880562),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.7635934611404596, -1.563782051071005),
            Complex::new(-0.7990092489893682, 1.1565369971501793),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.2522234481561323, 2.4413646288945894),
            Complex::new(-0.8919211272845686, -0.7953391172553718),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.1333363608148414, -2.2239002740099374),
            Complex::new(0.8041895097449078, -1.263614384970583),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(-1.2845993538721883, -0.8149687088699175),
            Complex::new(0.04672617218835198, 0.24226348085968588),
            Complex::new(-0.23570655643950122, -1.4250983947324998),
            Complex::new(-0.5428882550102544, 0.36594112304921983),
            Complex::new(-0.4333103174567822, 0.2484126488725964),
            Complex::new(-0.6494716467962331, 0.06528818167162072),
            Complex::new(0.726750747385451, 0.01915639166027384),
            Complex::new(1.1519117540872, 0.2573383771555333)
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.496_080_189_943_313_6, 0.631_477_117_538_452_1),
            Complex::new(0.214_756_548_404_693_6, -0.163_116_678_595_542_9),
            Complex::new(-0.619_152_069_091_796_9, 0.664_899_647_235_870_4),
            Complex::new(0.139_673_143_625_259_4, 0.636_214_673_519_134_5),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.226_391_986_012_458_8, -0.464_283_525_943_756_1),
            Complex::new(0.416_021_645_069_122_3, -0.14736022055149078),
            Complex::new(0.583_285_272_121_429_4, -2.883_586_334_064_603E-3),
            Complex::new(0.532_795_310_020_446_8, 1.2023266553878784),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.416_023_552_417_755_1, -0.573_828_518_390_655_5),
            Complex::new(0.11366434395313263, -0.14473079144954681),
            Complex::new(-0.13306868076324463, -0.149_607_554_078_102_1),
            Complex::new(0.188_351_362_943_649_3, -0.20575541257858276),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(2.743_873_745_203_018_2E-2, 0.21784165501594543),
            Complex::new(-0.12507066130638123, -0.618_769_228_458_404_5),
            Complex::new(-0.30912163853645325, -0.112_133_942_544_460_3),
            Complex::new(8.631_175_011_396_408E-2, 0.18869782984256744),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-0.17936444282531738, -2.855_338_715_016_842E-2),
            Complex::new(5.522_739_142_179_489E-3, 0.251_803_994_178_772),
            Complex::new(0.470_324_575_901_031_5, 0.542_884_707_450_866_7),
            Complex::new(5.791_266_262_531_280_5E-2, -0.345_476_925_373_077_4),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-2.2968014924921123, -0.529_363_482_362_097_4),
            Complex::new(0.35489687384414803, -2.292_737_853_453_044),
            Complex::new(-1.3783587245064326, -2.305_954_496_854_963),
            Complex::new(-0.728_988_744_423_390_3, 0.593_684_364_992_190_3),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.10739761644651513, 0.942_047_950_644_734_3),
            Complex::new(-3.4566256523152337, -1.6187282448880311),
            Complex::new(-1.3483694069194099, 1.841_829_011_323_998),
            Complex::new(0.11753648309305997, 1.321_712_156_903_747),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-8.413_857_387_925_525E-2, -1.838_010_731_960_906),
            Complex::new(9.055_243_654_345_776E-2, 1.753_163_528_353_39),
            Complex::new(1.886_081_218_057_146, 0.379_165_777_986_824_7),
            Complex::new(-0.32629307536500785, -0.221_905_355_706_220_7),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.593_826_206_531_752_8, 1.3518102090396353),
            Complex::new(-0.806_755_412_024_143_5, 0.137_979_209_613_290_8),
            Complex::new(-0.552_342_548_986_529, 4.066_039_005_822_824_6E-2),
            Complex::new(1.1469169235729075, 0.934_244_027_581_504_9),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-2.0535297393515086, -0.907_387_995_115_526_3),
            Complex::new(0.664_400_119_693_257, 0.18560436104215738),
            Complex::new(0.275_186_351_885_011_6, -0.263_613_361_713_216_8),
            Complex::new(-1.1191619149239813, -0.203_329_135_991_579_3),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(-0.45, 0.2),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-3.0635629621553253, -0.723_244_790_704_328_5),
            Complex::new(0.587_604_501_333_058_2, -2.1647036374194832),
            Complex::new(-2.224_429_222_493_426, -2.5972314814183854),
            Complex::new(-1.2457126771394509, 0.973_876_064_124_645_3),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.615_809_574_480_898_7, 0.960_087_319_513_493_8),
            Complex::new(-3.1575927968249022, -1.3032528633434817),
            Complex::new(-1.1124600669622788, 2.3656323077758663),
            Complex::new(-0.751_439_350_906_443_1, 2.282_158_592_540_896),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.26589765554440115, -2.441_963_329_994_658),
            Complex::new(0.266_275_883_656_144_3, 1.7975691177587587),
            Complex::new(1.9675005400620669, 0.199_560_945_949_537_8),
            Complex::new(-6.577_266_264_975_334E-2, -0.134_691_299_805_413_7),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.408_744_217_355_511_4, 1.4636417353970876),
            Complex::new(-0.29989138643221913, -0.22209207765204922),
            Complex::new(-0.575_070_660_627_086_1, -0.28240265494069994),
            Complex::new(1.0116135817735474, 1.0874037336879938),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-2.099_577_469_796_345, -1.080_237_344_412_189),
            Complex::new(0.439_985_626_625_627, 0.291_296_425_310_824_1),
            Complex::new(-2.528_003_871_362_277_7E-2, 0.376_832_631_600_491_5),
            Complex::new(-0.785_067_624_929_711_9, -0.28939851321797716),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'l',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-3.8333497901901694, 2.920_672_129_707_339),
            Complex::new(4.033_713_493_348_151, 2.3506737863282625),
            Complex::new(-2.5892107980300336, -0.546_607_769_340_734_6),
            Complex::new(1.0875583705347331, 0.572_369_876_839_538_2),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(4.387_788_550_778_572, 1.6351682799134268),
            Complex::new(3.817_256_474_396_153, 1.416_367_879_731_84),
            Complex::new(0.674_169_151_260_090_1, -2.4820886098673176),
            Complex::new(1.3474196179958526, -2.561_181_525_291_386),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.510_641_990_148_050_9, -2.9616433883062907),
            Complex::new(-0.41777799829000256, -0.278_749_152_753_436_9),
            Complex::new(-0.694_826_307_941_782_7, -2.1840826741234074),
            Complex::new(-1.2911708889627647, -1.5158614406578568),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.728_988_744_423_390_3, 0.593_684_364_992_190_3),
            Complex::new(0.18860989731474426, 1.528_092_023_700_151),
            Complex::new(-1.1486684282513933, 0.821_398_508_653_914),
            Complex::new(-1.4892507275872222, -1.1002656652229008),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-3.836_782_102_361_397E-2, 0.944_627_733_094_087_9),
            Complex::new(0.474_688_221_567_216_7, -2.5610852567248483),
            Complex::new(-0.631_763_159_285_107_6, -0.15637152773359697),
            Complex::new(5.869_624_484_297_969_5E-2, 0.10846525402097236),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'l',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.2, -0.3),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-3.283_110_813_617_43, 2.7402179230628736),
            Complex::new(3.839_612_886_774_672, 2.3626411767326667),
            Complex::new(-1.951_759_678_955_761, -0.697_886_742_207_547_1),
            Complex::new(1.258_240_354_229_299, 0.134_771_799_276_897_1),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(4.066_239_940_628_643, 1.8231816107946774),
            Complex::new(3.5086993883370194, 1.3383753550687447),
            Complex::new(0.323_044_539_529_814_5, -2.7136725703233515),
            Complex::new(1.5086730886023312, -3.4956956743737004),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.490_559_259_555_170_1, -2.4509368401439637),
            Complex::new(-0.543_868_924_814_332_7, -0.237_376_412_691_803_2),
            Complex::new(-0.674_828_118_834_202_7, -2.041_090_665_011_175),
            Complex::new(-1.4864838774774316, -1.4677487345052371),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.658_315_324_243_983_3, 0.452_003_871_644_513_6),
            Complex::new(1.614_460_200_897_610_6E-2, 1.9493818407958337),
            Complex::new(-1.0080490154456416, 1.0123275341111615),
            Complex::new(-1.4655586466516795, -1.2480090681873917),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(5.782_949_391_769_920_4E-2, 1.0335055442641772),
            Complex::new(0.572_096_177_122_614_2, -2.7143767549253766),
            Complex::new(-0.696_804_029_822_946_5, -0.670_232_198_311_262_6),
            Complex::new(-0.11424212632138736, 0.29258635208631906),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'r',
        'u',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.687_891_459_403_029_9, 1.8329511695677019),
            Complex::new(-0.358_091_682_451_883_6, -1.063_608_374_469_630_6E-2),
            Complex::new(-3.259_376_489_933_859, 1.0372370209678747),
            Complex::new(-0.412_380_072_758_763_2, 0.265_002_810_304_024_9),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-4.016_625_021_463_466E-3, -0.726_141_590_159_532_1),
            Complex::new(-0.17916625616086776, 1.1137145475848402),
            Complex::new(2.0080915542539346, -1.2131710860970963),
            Complex::new(0.506_244_364_687_768_1, -3.223_082_965_851_596),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.694_952_378_092_299_4, -1.3354370915785085),
            Complex::new(0.916_144_404_703_842_1, 0.990_168_371_016_784_5),
            Complex::new(1.3961115316961736, -2.7623140474023393),
            Complex::new(-2.108_402_328_242_626, -1.8357926337335364),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.803_028_372_107_331_7, 1.3683664988160076),
            Complex::new(-0.764_972_928_589_196_9, 5.481_996_348_633_916E-2),
            Complex::new(-1.9658998675312542, 0.501_467_315_578_234_2),
            Complex::new(-1.5244983117274997, -0.697_052_303_102_994),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.6489611913313786, -0.697_674_810_205_733_5),
            Complex::new(0.669_855_960_563_057_4, -0.409_638_849_075_303_9),
            Complex::new(-0.758_337_993_821_317_7, -1.9739152075580129),
            Complex::new(-0.352_178_715_012_702_5, 0.885_408_101_504_247_4),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'r',
        'u',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.1, 0.9),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-1.4545403522564087, 3.068_825_990_492_837),
            Complex::new(-4.153_241_769_059_485E-3, -0.347_197_407_759_627_4),
            Complex::new(-4.240_870_253_346_892, 2.357_886_769_951_132),
            Complex::new(-3.372_548_429_353_642E-2, 1.3822545631600767),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(0.31063223243332727, -1.607_130_312_596_722),
            Complex::new(0.540_200_640_576_628_5, 0.765_261_827_365_174_1),
            Complex::new(3.0574282989838917, -1.3350185975235238),
            Complex::new(1.7057412319797005, -1.165_454_107_076_76),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.5585604579949832, -2.2851236855960146),
            Complex::new(1.0917940596783018, 0.706_920_084_179_529_6),
            Complex::new(1.1266664014060568, -3.0049939010598545),
            Complex::new(-1.8105209670542655, -2.2438226397138634),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.895_986_429_865_012_9, 1.754_993_719_885_03),
            Complex::new(-1.1138539605126059, -1.0339504855995572),
            Complex::new(-2.544_745_590_999_879, 0.36145055297371376),
            Complex::new(-1.3313975991071523, -0.374_658_568_664_208_3),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.9775278573793162, -0.713_198_016_614_893_9),
            Complex::new(0.730_157_690_341_824_5, 4.250_378_059_464_055E-2),
            Complex::new(0.19682316348181128, -1.0907876766150957),
            Complex::new(-0.31703131115284733, 0.251_967_119_608_675_9),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'r',
        'l',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.1, 0.9),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-3.2329928277905804, 0.19275090419455865),
            Complex::new(-0.30416433267163456, -1.5550639420612633),
            Complex::new(-5.232_582_537_547_227, 3.4164800029642555),
            Complex::new(2.4597600096686323, 1.3707797248053202),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.11913555484672778, 1.263_103_817_099_508),
            Complex::new(-1.725_574_308_437_214, -2.5329001340582855),
            Complex::new(1.608_763_517_511_254, -1.180_619_737_504_738),
            Complex::new(1.8770284039924505, -0.281_515_483_547_242_6),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-3.651_058_207_301_709, -1.1369642620765816),
            Complex::new(-0.581_135_461_421_785_5, -6.541_161_293_530_123E-2),
            Complex::new(-4.224_705_944_054_593, 2.266_209_598_069_417),
            Complex::new(3.1795104002170413, -0.36973704442330557),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.510_456_709_061_943_2, 1.3021703259561368),
            Complex::new(1.3578335576483098, -3.6219231345450065),
            Complex::new(2.3247922324626504, -1.6484619774679632),
            Complex::new(4.696_546_598_479_278, 4.278_060_006_510_047),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-1.0641815567849253, -3.7897173043656944),
            Complex::new(-0.636_887_029_636_449_5, 4.072_098_590_167_905E-2),
            Complex::new(-1.8124927384357186, -2.671_280_239_744_273),
            Complex::new(3.4904477306612107, 0.597_130_147_681_985_2),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'l',
            'x',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.3, -0.7),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'x',
            'u',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.3, -0.7),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'l',
            'u',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            3,
            &b,
            6,
            Complex::new(0.3, 0.7),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'l',
            'u',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            3,
            Complex::new(0.3, -0.7),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'l',
            'u',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.3, -0.7),
            &mut [],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn syr2k() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.5, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.13539692759513855, 1.1275573074817657),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.237_891_539_931_297_3, -0.690_675_511_956_214_9),
            Complex::new(0.26866142451763153, -0.563_381_865_620_613_1),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-0.989_852_070_808_410_6, -0.157_804_965_972_900_4),
            Complex::new(-3.106_644_749_641_418_5E-2, -0.25839513540267944),
            Complex::new(-0.28267623484134674, -1.653_887_331_485_748_3E-2),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.24528039246797562, 0.19040291756391525),
            Complex::new(-0.743_839_889_764_785_8, -0.493_698_567_152_023_3),
            Complex::new(-0.42125558108091354, 0.19698769599199295),
            Complex::new(0.275_009_579_956_531_5, 0.10238607972860336),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'l',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let b = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        'n',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.835_861_512_332_255_9, 0.563_948_881_061_022_3),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(2.573_043_130_593_426, 0.16767797999470757),
            Complex::new(0.34240360482570337, -1.5283522018086906),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(2.285_112_823_935_93, 0.405_829_685_985_098_8),
            Complex::new(-2.6511185560568755, -0.990_181_190_693_835_5),
            Complex::new(0.327_215_935_728_022_3, 1.4677243405786666),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(9.730_982_399_020_038E-2, 1.9625297367448562),
            Complex::new(-3.3629068550787586, 2.2674848482313434),
            Complex::new(-1.0090793322692606, -0.913_085_065_942_361_5),
            Complex::new(-3.812_972_516_751_709, -10.883702715857607),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        'n',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(-0.4, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-1.3410432138908113, 0.16708472319263468),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(2.944_469_956_883_122, 0.348_791_571_503_477_4),
            Complex::new(0.460_291_783_023_566_5, -1.1955348807940278),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(2.7441756454890234, 7.301_083_909_150_752E-2),
            Complex::new(-2.5353339211719126, -0.899_249_714_176_344_8),
            Complex::new(0.446_901_980_773_965_1, 1.3612693943817686),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-7.696_350_261_943_086E-2, 1.9844807270335758),
            Complex::new(-2.867_891_464_935_731, 2.167_428_317_695_28),
            Complex::new(-0.919_372_176_896_951_6, -1.1603823804565412),
            Complex::new(-3.9639307828752157, -10.814_653_314_737_52),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'l',
        'n',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.427_092_722_744_648_4, 1.5561092609476495),
            Complex::new(2.2468097734023402, -0.261_835_116_814_679_5),
            Complex::new(3.6149121184076707, 1.6441338241686925),
            Complex::new(1.3697391710284696, 1.6831834494943383),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(4.768_316_372_272_174_4E-2, -2.3603954919469348),
            Complex::new(-2.656_885_728_725_005, -2.1567517349366945),
            Complex::new(-0.958_253_544_303_002_7, 1.2018942281904494),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(2.800_082_757_181_811_3E-2, 1.7338617021051559),
            Complex::new(-1.4205901574264264, -1.2897877918296592),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(-3.4355768570665752, -11.056326216085536),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        't',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.446_863_147_116_786, 3.339_174_865_086_147_5E-2),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-2.6337058928758674, -10.991585420020956),
            Complex::new(-9.309_074_551_599_85, -4.138_100_115_646_019),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(0.906_541_095_471_122_8, 5.271_667_718_437_611),
            Complex::new(3.5716115479891912, -6.679_689_257_165_41),
            Complex::new(-0.784_812_241_343_140_4, 6.445_895_297_126_432),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(4.179_765_415_660_384, -3.0256672163596514),
            Complex::new(-4.678_482_926_689_192_5E-2, 1.274_396_681_522_113),
            Complex::new(2.038_251_230_959_246, -3.832_146_678_202_064),
            Complex::new(-6.216_559_420_978_683, 3.8498345412180353),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'l',
        't',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(0.5, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.5822600747119244, 1.160_949_056_132_627),
            Complex::new(-2.5820660230667167, -11.369458647021192),
            Complex::new(0.952_288_673_615_196_3, 6.555_719_434_765_278),
            Complex::new(4.955_653_232_804_778, -2.5291256864657763),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-9.040_413_127_082_218, -4.701_481_981_266_632),
            Complex::new(4.152_013_233_776_556, -7.265_858_115_620_904),
            Complex::new(1.6883371361414334, 1.9439280268895445),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-1.0674884761844872, 6.429_356_423_811_575),
            Complex::new(2.0208471813243127, -4.226_253_453_724_296),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(-5.941_549_841_022_152, 3.9522206209466386),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'x',
            'n',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            Complex::new(1.0, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'u',
            'x',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            Complex::new(1.0, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            3,
            &b,
            6,
            Complex::new(1.0, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            3,
            Complex::new(1.0, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            Complex::new(1.0, 0.0),
            &mut [],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn syrk() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'u',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'u',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        Complex::new(0.2, -0.3),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.550_238_976_572_739_3, -0.180_454_206_644_465_2),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.32154861014992875, 0.188_013_330_881_250_6),
            Complex::new(-0.308_557_086_059_134, -7.799_252_466_309_525E-2),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(2.008_273_059_288_079_3E-2, 0.510_706_548_162_327),
            Complex::new(-0.12609092652433018, 4.137_274_006_163_372E-2),
            Complex::new(1.999_818_910_758E-2, 0.142_992_009_112_232_3),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(7.067_342_017_940_703E-2, -0.14168049334767674),
            Complex::new(-0.17246529530576815, 0.421_289_817_095_682_5),
            Complex::new(0.14061941280575163, 0.19092902545724755),
            Complex::new(2.369_208_093_554_276E-2, -0.14774340296449107),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        Complex::new(0.2, -0.3),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.550_238_976_572_739_3, -0.180_454_206_644_465_2),
            Complex::new(-0.194_100_606_573_479_6, 1.196_739_040_440_419_9E-2),
            Complex::new(0.637_451_119_074_272_7, -0.15127897286681247),
            Complex::new(0.170_681_983_694_565_9, -0.43759807756264113),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(-0.308_557_086_059_134, -7.799_252_466_309_525E-2),
            Complex::new(-0.351_124_611_730_275_6, -0.231_583_960_456_034_1),
            Complex::new(0.16125347060647854, -0.934_514_149_082_314_6),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.999_818_910_758E-2, 0.142_992_009_112_232_3),
            Complex::new(-0.19531298851466694, 4.811_270_615_261_964_4E-2),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(2.369_208_093_554_276E-2, -0.14774340296449107),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'u',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(0.2, -0.3),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.812_580_698_610_967_2, -0.783_177_605_117_800_9),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-1.7954095980537197, 0.996_355_508_542_885_2),
            Complex::new(3.804_418_701_683_099E-2, 0.882_442_429_135_667_5),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.3787696856957568, 1.0872896859381984),
            Complex::new(1.6785876585678317, -0.341_919_077_663_520_8),
            Complex::new(-0.673_674_074_079_395_5, -0.549_730_790_385_926_5),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-0.669_732_366_538_207_4, -1.1870133923122208),
            Complex::new(0.883_513_772_564_814_2, -2.002_844_186_657_849),
            Complex::new(1.0151927979751547, 0.339_948_048_616_549_1),
            Complex::new(5.9301227490237896, 4.5037526499313945),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.262_341_722_038_227_8, -0.602_723_398_473_335_7),
            Complex::new(-1.473_860_987_903_791, 0.808_342_177_661_634_7),
            Complex::new(-1.3988524162886375, 0.576_583_137_775_871_4),
            Complex::new(-0.740_405_786_717_614_7, -1.0453328989645438),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(0.34660127307596467, 0.960_434_953_798_762_8),
            Complex::new(1.8046785850921616, -0.383_291_817_725_154_6),
            Complex::new(1.0559790678705823, -2.424_134_003_753_531),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.693_672_263_186_975_5, -0.692_722_799_498_158_8),
            Complex::new(0.874_573_385_169_403_3, 0.149_019_023_159_302),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(5.906_430_668_088_246, 4.651_496_052_895_885),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.5252959571151317, 0.38943698141329164),
            Complex::new(-1.8000943450948768, 0.378_829_080_852_247_4),
            Complex::new(-6.905_312_181_689_699E-2, 1.8148872759594652),
            Complex::new(0.532_023_560_320_654_3, -1.3246791862150626),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(5.188_083_197_298_343E-2, 0.128_391_663_660_518_2),
            Complex::new(1.7989114124240324, -1.5498623619680132),
            Complex::new(3.460_632_378_646_338, -3.4897246237944244),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.992_887_371_343_179_7, -0.42658543797166953),
            Complex::new(0.463_062_560_012_237_8, -0.22768370272799654),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(6.283_826_327_773_381, 4.478_872_552_667_957),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'u',
        't',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(-0.3, 0.7),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-2.980_860_348_830_327, 1.774_456_422_671_3),
            Complex::new(-0.326_233_357_191_085_8, -0.429_513_096_809_387_2),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.272_429_347_038_269, -0.279_346_287_250_518_8),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(5.891_111_883_205_202, 4.609_413_115_192_598),
            Complex::new(7.239_172_333_382_896, -0.938_912_266_860_991_3),
            Complex::new(-5.767_172_668_129_206E-3, -1.1665705442428589),
            Complex::new(2.404_653_310_775_757, -1.0655906200408936),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-2.581_817_071_089_125, -3.6351018749077326),
            Complex::new(0.619_473_400_724_289, 4.789_468_530_465_57),
            Complex::new(-1.9209481658981211, -4.109_218_409_873_559),
            Complex::new(-0.411_510_825_157_165_5, -0.376_702_725_887_298_6),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(-1.3321782148965793, 3.4484763403003704),
            Complex::new(-0.22414453871646978, -1.6586121570342662),
            Complex::new(-0.14527678397845112, 2.4786080350511233),
            Complex::new(2.079_283_323_490_767, -3.977_240_674_209_848),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        't',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-1.9074618091585025, 1.1880365989665163),
            Complex::new(5.295_592_981_549_73, 5.1235748434393935),
            Complex::new(-2.3436812323385734, -2.5821278214725254),
            Complex::new(-1.239_887_448_471_914, 3.127_034_785_346_388),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.560_746_073_722_839_4),
            Complex::new(-0.928_567_051_887_512_2, -0.452_783_972_024_917_6),
            Complex::new(6.568_325_904_360_618, -0.982_220_958_562_448),
            Complex::new(0.37350484357949343, 4.923_893_025_962_436),
            Complex::new(-0.42030716769710375, -0.717_292_852_179_362_3),
            Complex::new(0.763_593_435_287_475_6, -1.5637820959091187),
            Complex::new(-0.799_009_263_515_472_4, 1.1565370559692383),
            Complex::new(-1.147_657_036_781_311, 0.832_047_104_835_510_3),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-1.8244165520159665, -3.819_926_626_100_587),
            Complex::new(0.22021313440239154, 2.8210685424317923),
            Complex::new(0.252_223_461_866_378_8, 2.4413645267486572),
            Complex::new(-0.891_921_103_000_640_9, -0.795_339_107_513_427_7),
            Complex::new(0.43568331003189087, -5.487_747_490_406_036_4E-2),
            Complex::new(-1.237_538_456_916_809, 0.25014132261276245),
            Complex::new(-0.224_267_885_088_920_6, 0.618_243_277_072_906_5),
            Complex::new(2.071_665_577_793_497, -4.293_204_683_616_747),
            Complex::new(0.133_336_365_222_930_9, -2.223_900_318_145_752),
            Complex::new(0.804_189_503_192_901_6, -1.2636144161224365),
            Complex::new(-5.710_677_430_033_684E-2, 0.35872888565063477),
            Complex::new(0.503_607_988_357_544, -1.104_547_828_435_897_8E-2),
            Complex::new(1.0857694149017334, -0.940_649_151_802_063),
            Complex::new(-0.690_953_850_746_154_8, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.814_968_705_177_307_1),
            Complex::new(4.672_617_092_728_615E-2, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.542_888_283_729_553_2, 0.365_941_137_075_424_2),
            Complex::new(-0.433_310_329_914_093, 0.24841265380382538),
            Complex::new(-0.649_471_640_586_853, 6.528_817_862_272_263E-2),
            Complex::new(0.726_750_731_468_200_7, 1.915_639_080_107_212E-2),
            Complex::new(1.151_911_735_534_668, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::syrk(
            'x',
            'n',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            Complex::new(1.0, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syrk(
            'u',
            'x',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            Complex::new(1.0, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syrk(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            3,
            Complex::new(1.0, 0.0),
            &mut [],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syrk(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            Complex::new(1.0, 0.0),
            &mut [],
            3,
        );
    });
    assert!(result.is_err());
}
